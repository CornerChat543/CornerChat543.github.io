<?xml version="1.0" encoding="UTF-8"?><rss version="2.0"
	xmlns:content="http://purl.org/rss/1.0/modules/content/"
	xmlns:wfw="http://wellformedweb.org/CommentAPI/"
	xmlns:dc="http://purl.org/dc/elements/1.1/"
	xmlns:atom="http://www.w3.org/2005/Atom"
	xmlns:sy="http://purl.org/rss/1.0/modules/syndication/"
	xmlns:slash="http://purl.org/rss/1.0/modules/slash/"
	>

<channel>
	<title>FreeSpire.PDF &#8211; CornerChat543</title>
	<atom:link href="https://cornerchat543.github.io/tag/freespire-pdf/feed/" rel="self" type="application/rss+xml" />
	<link>https://cornerchat543.github.io</link>
	<description></description>
	<lastBuildDate>Sat, 01 Jun 2024 14:00:21 +0000</lastBuildDate>
	<language>zh-TW</language>
	<sy:updatePeriod>
	hourly	</sy:updatePeriod>
	<sy:updateFrequency>
	1	</sy:updateFrequency>
	<generator>https://wordpress.org/?v=6.5.3</generator>

<image>
	<url>https://cornerchat543.github.io/wp-content/uploads/2024/05/Logo_v2.jpg</url>
	<title>FreeSpire.PDF &#8211; CornerChat543</title>
	<link>https://cornerchat543.github.io</link>
	<width>32</width>
	<height>32</height>
</image> 
	<item>
		<title>使用WPF元件和FreeSpire.PDF生成PDF</title>
		<link>https://cornerchat543.github.io/2024/06/wpf-freespirepdf-flowdocument-to-pdf/</link>
		
		<dc:creator><![CDATA[cornerchat543]]></dc:creator>
		<pubDate>Sat, 01 Jun 2024 13:59:08 +0000</pubDate>
				<category><![CDATA[C#]]></category>
		<category><![CDATA[.NET]]></category>
		<category><![CDATA[FreeSpire.PDF]]></category>
		<category><![CDATA[MVVM]]></category>
		<category><![CDATA[Nuget]]></category>
		<category><![CDATA[PDF]]></category>
		<category><![CDATA[WPF]]></category>
		<guid isPermaLink="false">https://cornerchat543.github.io/?p=195</guid>

					<description><![CDATA[當需要在 C# WPF 中產生 PDF 時，通常會使用各種功能強大的套件來實現。那代表著需要學習並掌握套件內的 [&#8230;]]]></description>
										<content:encoded><![CDATA[
<figure class="wp-block-image size-large"><img decoding="async" src="https://i.imgur.com/YZ9md0s.png" alt=""/></figure>



<p>當需要在 C# WPF 中產生 PDF 時，通常會使用各種功能強大的套件來實現。那代表著需要學習並掌握套件內的類別與方法，才能實現需要的排版。並且過程中還要確保將顯示的資料正確的放入到 PDF 中。</p>



<p>總想著，為什麼製作 PDF 不能像編寫 WPF XAML 一樣簡單呢? 這樣就不用學習其他套件了，而且還能透過 Data Binding 直接將資料綁訂到 UI 上。這樣一來，整個過程應該會很方便吧?</p>



<p>於是經過 Study 後，可以使用 WPF 元件。然後，將其轉成 XPS 格式後，再使用 FreeSpire.PDF 套件中的方法，將 XPS 存成 PDF。這樣就能簡單的通過撰寫 XAML 來產生 PDF檔。</p>



<p>本次將放上簡單的範例來記錄這項功能的使用。</p>



<p>本次的開發環境，如下</p>



<ul>
<li>IDE : Visual Studio 2022</li>



<li>.NET版本 : . NET 6.0</li>



<li>Nuget套件: CommunityToolkit.Mvvm 8.2.2、FreeSpire.PDF 8.6.0</li>
</ul>



<hr class="wp-block-separator has-alpha-channel-opacity is-style-wide"/>



<h2 class="wp-block-heading article_h2">本文</h2>



<p>首先來看 View 的部分，完整的 XAML 如下，</p>



<p>分為兩大部分，分別用途為：</p>



<ul>
<li>用於生成 PDF 檔案：假設要產生一個簡單的學生成績單，整體 UI 隱藏在下層。</li>



<li>使用者輸入區域：用於輸入簡單的資料，透過 Binding 讓 PDF 能有對應的內容。</li>
</ul>



<div class="wp-block-group is-vertical is-content-justification-stretch is-layout-flex wp-container-core-group-is-layout-1 wp-block-group-is-layout-flex">
<p>XAML</p>



<div class="wp-block-kevinbatdorf-code-block-pro cbp-has-line-numbers" data-code-block-pro-font-family="Code-Pro-JetBrains-Mono" style="font-size:.875rem;font-family:Code-Pro-JetBrains-Mono,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;--cbp-line-number-color:#babed8;--cbp-line-number-width:calc(3 * 0.6 * .875rem);line-height:1.25rem;--cbp-tab-width:2;tab-size:var(--cbp-tab-width, 2)"><span style="display:flex;align-items:center;padding:10px 0px 10px 16px;margin-bottom:-2px;width:100%;text-align:left;background-color:#181c2a;color:#aaafcf">XML</span><span role="button" tabindex="0" data-code="&lt;Window.Resources&gt;

    &lt;Thickness x:Key=&quot;Margin.Top&quot;&gt;0,10,0,0&lt;/Thickness&gt;

    &lt;!--TitleTextBlockStyle--&gt;
    &lt;Style x:Key=&quot;TitleTextBlockStyle&quot; TargetType=&quot;TextBlock&quot;&gt;
        &lt;Setter Property=&quot;Margin&quot; Value=&quot;0,20,0,5&quot;/&gt;
        &lt;Setter Property=&quot;HorizontalAlignment&quot; Value=&quot;Center&quot;/&gt;
        &lt;Setter Property=&quot;VerticalAlignment&quot; Value=&quot;Center&quot;/&gt;
        &lt;Setter Property=&quot;FontSize&quot; Value=&quot;18&quot;/&gt;
        &lt;Setter Property=&quot;FontWeight&quot; Value=&quot;Bold&quot;/&gt;
    &lt;/Style&gt;

    &lt;!--TableTitleTextBlockStyle--&gt;
    &lt;Style x:Key=&quot;TableTitleTextBlockStyle&quot; TargetType=&quot;TextBlock&quot;&gt;
        &lt;Setter Property=&quot;Margin&quot; Value=&quot;0,0,5,0&quot;/&gt;
        &lt;Setter Property=&quot;HorizontalAlignment&quot; Value=&quot;Right&quot;/&gt;
        &lt;Setter Property=&quot;VerticalAlignment&quot; Value=&quot;Center&quot;/&gt;
        &lt;Setter Property=&quot;FontWeight&quot; Value=&quot;Bold&quot;/&gt;
        &lt;Setter Property=&quot;FontSize&quot; Value=&quot;12&quot;/&gt;
    &lt;/Style&gt;

    &lt;!--TableContentTextBlockSytle--&gt;
    &lt;Style x:Key=&quot;TableContentTextBlockSytle&quot; TargetType=&quot;TextBlock&quot;&gt;
        &lt;Setter Property=&quot;Margin&quot; Value=&quot;5,0,0,0&quot;/&gt;
        &lt;Setter Property=&quot;VerticalAlignment&quot; Value=&quot;Center&quot;/&gt;
        &lt;Setter Property=&quot;FontSize&quot; Value=&quot;12&quot;/&gt;
    &lt;/Style&gt;

    &lt;!--DataGridColumnHeaderStyle--&gt;
    &lt;Style x:Key=&quot;DataGridColumnHeaderStyle&quot; TargetType=&quot;DataGridColumnHeader&quot;&gt;
        &lt;Setter Property=&quot;Height&quot; Value=&quot;30&quot;/&gt;
        &lt;Setter Property=&quot;FontWeight&quot; Value=&quot;Bold&quot;/&gt;

        &lt;Setter Property=&quot;Template&quot;&gt;
            &lt;Setter.Value&gt;
                &lt;ControlTemplate TargetType=&quot;DataGridColumnHeader&quot;&gt;
                    &lt;Border Width=&quot;Auto&quot;
                            BorderThickness=&quot;0,1&quot;
                            BorderBrush=&quot;Black&quot;
                            Background=&quot;White&quot;&gt;
                        &lt;Grid&gt;
                            &lt;ContentPresenter Margin=&quot;5,0,0,0&quot;
                                              HorizontalAlignment=&quot;Left&quot;
                                              VerticalAlignment=&quot;Center&quot;/&gt;
                            &lt;Rectangle Width=&quot;1&quot;
                                       Fill=&quot;Black&quot;
                                       HorizontalAlignment=&quot;Right&quot;/&gt;
                        &lt;/Grid&gt;
                    &lt;/Border&gt;
                &lt;/ControlTemplate&gt;
            &lt;/Setter.Value&gt;
        &lt;/Setter&gt;
    &lt;/Style&gt;

&lt;/Window.Resources&gt;

&lt;Window.DataContext&gt;
    &lt;local:MainWindowViewModel/&gt;
&lt;/Window.DataContext&gt;

 &lt;Grid&gt;

     &lt;!--用於生成PDF檔案--&gt;
     &lt;FlowDocumentScrollViewer VerticalScrollBarVisibility=&quot;Disabled&quot;
                               HorizontalScrollBarVisibility=&quot;Disabled&quot;
                               Visibility=&quot;Visible&quot;&gt;

         &lt;FlowDocument x:Name=&quot;flowDocument&quot;
                       Background=&quot;White&quot;
                       PageWidth=&quot;595&quot; 
                       ColumnWidth=&quot;595&quot;
                       PageHeight=&quot;842&quot;
                       PagePadding=&quot;40&quot;
                       IsOptimalParagraphEnabled=&quot;False&quot;
                       IsHyphenationEnabled=&quot;False&quot;&gt;

             &lt;Paragraph TextAlignment=&quot;Center&quot;
                        FontSize=&quot;22pt&quot;&gt;
                 &lt;Run Text=&quot;Student Report Card&quot;/&gt;
             &lt;/Paragraph&gt;

             &lt;BlockUIContainer&gt;

                 &lt;StackPanel&gt;

                     &lt;!--Student Information--&gt;
                     &lt;TextBlock Style=&quot;{StaticResource TitleTextBlockStyle}&quot;
                                Text=&quot;Student Information&quot;/&gt;

                     &lt;Grid Margin=&quot;50,0&quot;
                           Height=&quot;90&quot;&gt;

                         &lt;Grid.RowDefinitions&gt;
                             &lt;RowDefinition Height=&quot;30&quot;/&gt;
                             &lt;RowDefinition Height=&quot;30&quot;/&gt;
                             &lt;RowDefinition Height=&quot;30&quot;/&gt;
                         &lt;/Grid.RowDefinitions&gt;

                         &lt;Grid.ColumnDefinitions&gt;
                             &lt;ColumnDefinition Width=&quot;*&quot;/&gt;
                             &lt;ColumnDefinition Width=&quot;3*&quot;/&gt;
                         &lt;/Grid.ColumnDefinitions&gt;

                         &lt;!--Name--&gt;
                         &lt;Border Grid.Row=&quot;0&quot;
                                 Grid.Column=&quot;0&quot;
                                 BorderBrush=&quot;Black&quot;
                                 BorderThickness=&quot;1,1,0,0&quot;&gt;
                             &lt;TextBlock Style=&quot;{StaticResource TableTitleTextBlockStyle}&quot;
                                        Text=&quot;Name&quot;/&gt;
                         &lt;/Border&gt;

                         &lt;Border Grid.Row=&quot;0&quot;
                                 Grid.Column=&quot;1&quot;
                                 BorderBrush=&quot;Black&quot;
                                 BorderThickness=&quot;1,1,1,0&quot;&gt;
                             &lt;TextBlock Style=&quot;{StaticResource TableContentTextBlockSytle}&quot;
                                        Text=&quot;{Binding Path=Name}&quot;/&gt;
                         &lt;/Border&gt;

                         &lt;!--ID--&gt;
                         &lt;Border Grid.Row=&quot;1&quot;
                                 Grid.Column=&quot;0&quot;
                                 BorderBrush=&quot;Black&quot;
                                 BorderThickness=&quot;1,1,0,0&quot;&gt;
                             &lt;TextBlock Style=&quot;{StaticResource TableTitleTextBlockStyle}&quot;
                                        Text=&quot;ID&quot;/&gt;
                         &lt;/Border&gt;

                         &lt;Border Grid.Row=&quot;1&quot;
                                 Grid.Column=&quot;1&quot;
                                 BorderBrush=&quot;Black&quot;
                                 BorderThickness=&quot;1,1,1,0&quot;&gt;
                             &lt;TextBlock Style=&quot;{StaticResource TableContentTextBlockSytle}&quot;
                                        Text=&quot;{Binding Path=Id}&quot;/&gt;
                         &lt;/Border&gt;

                         &lt;!--Email--&gt;
                         &lt;Border Grid.Row=&quot;2&quot;
                                 Grid.Column=&quot;0&quot;
                                 BorderBrush=&quot;Black&quot;
                                 BorderThickness=&quot;1,1,0,1&quot;&gt;
                             &lt;TextBlock Style=&quot;{StaticResource TableTitleTextBlockStyle}&quot;
                                        Text=&quot;Email&quot;/&gt;
                         &lt;/Border&gt;

                         &lt;Border Grid.Row=&quot;2&quot;
                                 Grid.Column=&quot;1&quot;
                                 BorderBrush=&quot;Black&quot;
                                 BorderThickness=&quot;1&quot;&gt;
                             &lt;TextBlock Style=&quot;{StaticResource TableContentTextBlockSytle}&quot;
                                        Text=&quot;{Binding Path=Email}&quot;/&gt;
                         &lt;/Border&gt;

                     &lt;/Grid&gt;

                     &lt;!--Grades--&gt;
                     &lt;TextBlock Style=&quot;{StaticResource TitleTextBlockStyle}&quot;
                                Text=&quot;Grades&quot;/&gt;

                     &lt;DataGrid Margin=&quot;50,0&quot;
                               FontSize=&quot;12&quot;
                               RowHeaderWidth=&quot;0&quot;
                               AutoGenerateColumns=&quot;False&quot;
                               CanUserAddRows=&quot;False&quot;
                               ColumnHeaderStyle=&quot;{StaticResource DataGridColumnHeaderStyle}&quot;
                               ItemsSource=&quot;{Binding Path=GradeCollection}&quot;&gt;

                         &lt;DataGrid.Columns&gt;
                             &lt;DataGridTextColumn Header=&quot;Subject&quot;
                                                 Width=&quot;140&quot;
                                                 Binding=&quot;{Binding Path=Subject}&quot;/&gt;
                             &lt;DataGridTextColumn Header=&quot;Grade&quot;
                                                 Width=&quot;*&quot;
                                                 Binding=&quot;{Binding Path=Grade}&quot;/&gt;
                         &lt;/DataGrid.Columns&gt;
                     &lt;/DataGrid&gt;

                 &lt;/StackPanel&gt;

             &lt;/BlockUIContainer&gt;

         &lt;/FlowDocument&gt;

     &lt;/FlowDocumentScrollViewer&gt;

     &lt;!--使用者輸入區域--&gt;
     &lt;Grid Background=&quot;White&quot;
           Visibility=&quot;Visible&quot;&gt;

         &lt;StackPanel Margin=&quot;30&quot;&gt;

             &lt;!--Name--&gt;
             &lt;TextBlock Text=&quot;Name:&quot;/&gt;
             &lt;TextBox Text=&quot;{Binding Path=Name,
                                     UpdateSourceTrigger=PropertyChanged}&quot;/&gt;

             &lt;!--Id--&gt;
             &lt;TextBlock Margin=&quot;{StaticResource Margin.Top}&quot;
                        Text=&quot;ID:&quot;/&gt;
             &lt;TextBox Text=&quot;{Binding Path=Id,
                                     UpdateSourceTrigger=PropertyChanged}&quot;/&gt;

             &lt;!--Email--&gt;
             &lt;TextBlock Margin=&quot;{StaticResource Margin.Top}&quot;
                        Text=&quot;Email:&quot;/&gt;
             &lt;TextBox Text=&quot;{Binding Path=Email,
                                     UpdateSourceTrigger=PropertyChanged}&quot;/&gt;
             
             &lt;Button Margin=&quot;{StaticResource Margin.Top}&quot;
                     HorizontalAlignment=&quot;Left&quot;
                     Width=&quot;120&quot; Height=&quot;30&quot;
                     Content=&quot;Create&quot;
                     Command=&quot;{Binding Path=CreatePdfCommand}&quot;
                     CommandParameter=&quot;{Binding ElementName=flowDocument}&quot;/&gt;

         &lt;/StackPanel&gt;

     &lt;/Grid&gt;

 &lt;/Grid&gt;" style="color:#babed8;display:none" aria-label="Copy" class="code-block-pro-copy-button"><svg xmlns="http://www.w3.org/2000/svg" style="width:24px;height:24px" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M4.5 12.75l6 6 9-13.5"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M16.5 8.25V6a2.25 2.25 0 00-2.25-2.25H6A2.25 2.25 0 003.75 6v8.25A2.25 2.25 0 006 16.5h2.25m8.25-8.25H18a2.25 2.25 0 012.25 2.25V18A2.25 2.25 0 0118 20.25h-7.5A2.25 2.25 0 018.25 18v-1.5m8.25-8.25h-6a2.25 2.25 0 00-2.25 2.25v6"></path></svg></span><pre class="shiki material-theme-ocean" style="background-color: #0F111A" tabindex="0"><code><span class="line"><span style="color: #89DDFF">&lt;</span><span style="color: #F07178">Window.Resources</span><span style="color: #89DDFF">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #89DDFF">&lt;</span><span style="color: #F07178">Thickness</span><span style="color: #89DDFF"> </span><span style="color: #C792EA">x</span><span style="color: #89DDFF">:</span><span style="color: #C792EA">Key</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">Margin.Top</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">&gt;</span><span style="color: #BABED8">0,10,0,0</span><span style="color: #89DDFF">&lt;/</span><span style="color: #F07178">Thickness</span><span style="color: #89DDFF">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #464B5D; font-style: italic">&lt;!--TitleTextBlockStyle--&gt;</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #89DDFF">&lt;</span><span style="color: #F07178">Style</span><span style="color: #89DDFF"> </span><span style="color: #C792EA">x</span><span style="color: #89DDFF">:</span><span style="color: #C792EA">Key</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">TitleTextBlockStyle</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF"> </span><span style="color: #C792EA">TargetType</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">TextBlock</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">&gt;</span></span>
<span class="line"><span style="color: #BABED8">        </span><span style="color: #89DDFF">&lt;</span><span style="color: #F07178">Setter</span><span style="color: #89DDFF"> </span><span style="color: #C792EA">Property</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">Margin</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF"> </span><span style="color: #C792EA">Value</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">0,20,0,5</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">/&gt;</span></span>
<span class="line"><span style="color: #BABED8">        </span><span style="color: #89DDFF">&lt;</span><span style="color: #F07178">Setter</span><span style="color: #89DDFF"> </span><span style="color: #C792EA">Property</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">HorizontalAlignment</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF"> </span><span style="color: #C792EA">Value</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">Center</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">/&gt;</span></span>
<span class="line"><span style="color: #BABED8">        </span><span style="color: #89DDFF">&lt;</span><span style="color: #F07178">Setter</span><span style="color: #89DDFF"> </span><span style="color: #C792EA">Property</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">VerticalAlignment</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF"> </span><span style="color: #C792EA">Value</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">Center</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">/&gt;</span></span>
<span class="line"><span style="color: #BABED8">        </span><span style="color: #89DDFF">&lt;</span><span style="color: #F07178">Setter</span><span style="color: #89DDFF"> </span><span style="color: #C792EA">Property</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">FontSize</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF"> </span><span style="color: #C792EA">Value</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">18</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">/&gt;</span></span>
<span class="line"><span style="color: #BABED8">        </span><span style="color: #89DDFF">&lt;</span><span style="color: #F07178">Setter</span><span style="color: #89DDFF"> </span><span style="color: #C792EA">Property</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">FontWeight</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF"> </span><span style="color: #C792EA">Value</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">Bold</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">/&gt;</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #89DDFF">&lt;/</span><span style="color: #F07178">Style</span><span style="color: #89DDFF">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #464B5D; font-style: italic">&lt;!--TableTitleTextBlockStyle--&gt;</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #89DDFF">&lt;</span><span style="color: #F07178">Style</span><span style="color: #89DDFF"> </span><span style="color: #C792EA">x</span><span style="color: #89DDFF">:</span><span style="color: #C792EA">Key</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">TableTitleTextBlockStyle</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF"> </span><span style="color: #C792EA">TargetType</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">TextBlock</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">&gt;</span></span>
<span class="line"><span style="color: #BABED8">        </span><span style="color: #89DDFF">&lt;</span><span style="color: #F07178">Setter</span><span style="color: #89DDFF"> </span><span style="color: #C792EA">Property</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">Margin</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF"> </span><span style="color: #C792EA">Value</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">0,0,5,0</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">/&gt;</span></span>
<span class="line"><span style="color: #BABED8">        </span><span style="color: #89DDFF">&lt;</span><span style="color: #F07178">Setter</span><span style="color: #89DDFF"> </span><span style="color: #C792EA">Property</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">HorizontalAlignment</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF"> </span><span style="color: #C792EA">Value</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">Right</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">/&gt;</span></span>
<span class="line"><span style="color: #BABED8">        </span><span style="color: #89DDFF">&lt;</span><span style="color: #F07178">Setter</span><span style="color: #89DDFF"> </span><span style="color: #C792EA">Property</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">VerticalAlignment</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF"> </span><span style="color: #C792EA">Value</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">Center</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">/&gt;</span></span>
<span class="line"><span style="color: #BABED8">        </span><span style="color: #89DDFF">&lt;</span><span style="color: #F07178">Setter</span><span style="color: #89DDFF"> </span><span style="color: #C792EA">Property</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">FontWeight</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF"> </span><span style="color: #C792EA">Value</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">Bold</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">/&gt;</span></span>
<span class="line"><span style="color: #BABED8">        </span><span style="color: #89DDFF">&lt;</span><span style="color: #F07178">Setter</span><span style="color: #89DDFF"> </span><span style="color: #C792EA">Property</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">FontSize</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF"> </span><span style="color: #C792EA">Value</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">12</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">/&gt;</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #89DDFF">&lt;/</span><span style="color: #F07178">Style</span><span style="color: #89DDFF">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #464B5D; font-style: italic">&lt;!--TableContentTextBlockSytle--&gt;</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #89DDFF">&lt;</span><span style="color: #F07178">Style</span><span style="color: #89DDFF"> </span><span style="color: #C792EA">x</span><span style="color: #89DDFF">:</span><span style="color: #C792EA">Key</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">TableContentTextBlockSytle</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF"> </span><span style="color: #C792EA">TargetType</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">TextBlock</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">&gt;</span></span>
<span class="line"><span style="color: #BABED8">        </span><span style="color: #89DDFF">&lt;</span><span style="color: #F07178">Setter</span><span style="color: #89DDFF"> </span><span style="color: #C792EA">Property</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">Margin</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF"> </span><span style="color: #C792EA">Value</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">5,0,0,0</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">/&gt;</span></span>
<span class="line"><span style="color: #BABED8">        </span><span style="color: #89DDFF">&lt;</span><span style="color: #F07178">Setter</span><span style="color: #89DDFF"> </span><span style="color: #C792EA">Property</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">VerticalAlignment</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF"> </span><span style="color: #C792EA">Value</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">Center</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">/&gt;</span></span>
<span class="line"><span style="color: #BABED8">        </span><span style="color: #89DDFF">&lt;</span><span style="color: #F07178">Setter</span><span style="color: #89DDFF"> </span><span style="color: #C792EA">Property</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">FontSize</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF"> </span><span style="color: #C792EA">Value</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">12</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">/&gt;</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #89DDFF">&lt;/</span><span style="color: #F07178">Style</span><span style="color: #89DDFF">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #464B5D; font-style: italic">&lt;!--DataGridColumnHeaderStyle--&gt;</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #89DDFF">&lt;</span><span style="color: #F07178">Style</span><span style="color: #89DDFF"> </span><span style="color: #C792EA">x</span><span style="color: #89DDFF">:</span><span style="color: #C792EA">Key</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">DataGridColumnHeaderStyle</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF"> </span><span style="color: #C792EA">TargetType</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">DataGridColumnHeader</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">&gt;</span></span>
<span class="line"><span style="color: #BABED8">        </span><span style="color: #89DDFF">&lt;</span><span style="color: #F07178">Setter</span><span style="color: #89DDFF"> </span><span style="color: #C792EA">Property</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">Height</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF"> </span><span style="color: #C792EA">Value</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">30</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">/&gt;</span></span>
<span class="line"><span style="color: #BABED8">        </span><span style="color: #89DDFF">&lt;</span><span style="color: #F07178">Setter</span><span style="color: #89DDFF"> </span><span style="color: #C792EA">Property</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">FontWeight</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF"> </span><span style="color: #C792EA">Value</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">Bold</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">/&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #BABED8">        </span><span style="color: #89DDFF">&lt;</span><span style="color: #F07178">Setter</span><span style="color: #89DDFF"> </span><span style="color: #C792EA">Property</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">Template</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">&gt;</span></span>
<span class="line"><span style="color: #BABED8">            </span><span style="color: #89DDFF">&lt;</span><span style="color: #F07178">Setter.Value</span><span style="color: #89DDFF">&gt;</span></span>
<span class="line"><span style="color: #BABED8">                </span><span style="color: #89DDFF">&lt;</span><span style="color: #F07178">ControlTemplate</span><span style="color: #89DDFF"> </span><span style="color: #C792EA">TargetType</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">DataGridColumnHeader</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">&gt;</span></span>
<span class="line"><span style="color: #BABED8">                    </span><span style="color: #89DDFF">&lt;</span><span style="color: #F07178">Border</span><span style="color: #89DDFF"> </span><span style="color: #C792EA">Width</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">Auto</span><span style="color: #89DDFF">&quot;</span></span>
<span class="line"><span style="color: #89DDFF">                            </span><span style="color: #C792EA">BorderThickness</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">0,1</span><span style="color: #89DDFF">&quot;</span></span>
<span class="line"><span style="color: #89DDFF">                            </span><span style="color: #C792EA">BorderBrush</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">Black</span><span style="color: #89DDFF">&quot;</span></span>
<span class="line"><span style="color: #89DDFF">                            </span><span style="color: #C792EA">Background</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">White</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">&gt;</span></span>
<span class="line"><span style="color: #BABED8">                        </span><span style="color: #89DDFF">&lt;</span><span style="color: #F07178">Grid</span><span style="color: #89DDFF">&gt;</span></span>
<span class="line"><span style="color: #BABED8">                            </span><span style="color: #89DDFF">&lt;</span><span style="color: #F07178">ContentPresenter</span><span style="color: #89DDFF"> </span><span style="color: #C792EA">Margin</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">5,0,0,0</span><span style="color: #89DDFF">&quot;</span></span>
<span class="line"><span style="color: #89DDFF">                                              </span><span style="color: #C792EA">HorizontalAlignment</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">Left</span><span style="color: #89DDFF">&quot;</span></span>
<span class="line"><span style="color: #89DDFF">                                              </span><span style="color: #C792EA">VerticalAlignment</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">Center</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">/&gt;</span></span>
<span class="line"><span style="color: #BABED8">                            </span><span style="color: #89DDFF">&lt;</span><span style="color: #F07178">Rectangle</span><span style="color: #89DDFF"> </span><span style="color: #C792EA">Width</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">1</span><span style="color: #89DDFF">&quot;</span></span>
<span class="line"><span style="color: #89DDFF">                                       </span><span style="color: #C792EA">Fill</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">Black</span><span style="color: #89DDFF">&quot;</span></span>
<span class="line"><span style="color: #89DDFF">                                       </span><span style="color: #C792EA">HorizontalAlignment</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">Right</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">/&gt;</span></span>
<span class="line"><span style="color: #BABED8">                        </span><span style="color: #89DDFF">&lt;/</span><span style="color: #F07178">Grid</span><span style="color: #89DDFF">&gt;</span></span>
<span class="line"><span style="color: #BABED8">                    </span><span style="color: #89DDFF">&lt;/</span><span style="color: #F07178">Border</span><span style="color: #89DDFF">&gt;</span></span>
<span class="line"><span style="color: #BABED8">                </span><span style="color: #89DDFF">&lt;/</span><span style="color: #F07178">ControlTemplate</span><span style="color: #89DDFF">&gt;</span></span>
<span class="line"><span style="color: #BABED8">            </span><span style="color: #89DDFF">&lt;/</span><span style="color: #F07178">Setter.Value</span><span style="color: #89DDFF">&gt;</span></span>
<span class="line"><span style="color: #BABED8">        </span><span style="color: #89DDFF">&lt;/</span><span style="color: #F07178">Setter</span><span style="color: #89DDFF">&gt;</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #89DDFF">&lt;/</span><span style="color: #F07178">Style</span><span style="color: #89DDFF">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #89DDFF">&lt;/</span><span style="color: #F07178">Window.Resources</span><span style="color: #89DDFF">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #89DDFF">&lt;</span><span style="color: #F07178">Window.DataContext</span><span style="color: #89DDFF">&gt;</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #89DDFF">&lt;</span><span style="color: #F07178">local</span><span style="color: #89DDFF">:</span><span style="color: #F07178">MainWindowViewModel</span><span style="color: #89DDFF">/&gt;</span></span>
<span class="line"><span style="color: #89DDFF">&lt;/</span><span style="color: #F07178">Window.DataContext</span><span style="color: #89DDFF">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #BABED8"> </span><span style="color: #89DDFF">&lt;</span><span style="color: #F07178">Grid</span><span style="color: #89DDFF">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #BABED8">     </span><span style="color: #464B5D; font-style: italic">&lt;!--用於生成PDF檔案--&gt;</span></span>
<span class="line"><span style="color: #BABED8">     </span><span style="color: #89DDFF">&lt;</span><span style="color: #F07178">FlowDocumentScrollViewer</span><span style="color: #89DDFF"> </span><span style="color: #C792EA">VerticalScrollBarVisibility</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">Disabled</span><span style="color: #89DDFF">&quot;</span></span>
<span class="line"><span style="color: #89DDFF">                               </span><span style="color: #C792EA">HorizontalScrollBarVisibility</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">Disabled</span><span style="color: #89DDFF">&quot;</span></span>
<span class="line"><span style="color: #89DDFF">                               </span><span style="color: #C792EA">Visibility</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">Visible</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #BABED8">         </span><span style="color: #89DDFF">&lt;</span><span style="color: #F07178">FlowDocument</span><span style="color: #89DDFF"> </span><span style="color: #C792EA">x</span><span style="color: #89DDFF">:</span><span style="color: #C792EA">Name</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">flowDocument</span><span style="color: #89DDFF">&quot;</span></span>
<span class="line"><span style="color: #89DDFF">                       </span><span style="color: #C792EA">Background</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">White</span><span style="color: #89DDFF">&quot;</span></span>
<span class="line"><span style="color: #89DDFF">                       </span><span style="color: #C792EA">PageWidth</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">595</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF"> </span></span>
<span class="line"><span style="color: #89DDFF">                       </span><span style="color: #C792EA">ColumnWidth</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">595</span><span style="color: #89DDFF">&quot;</span></span>
<span class="line"><span style="color: #89DDFF">                       </span><span style="color: #C792EA">PageHeight</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">842</span><span style="color: #89DDFF">&quot;</span></span>
<span class="line"><span style="color: #89DDFF">                       </span><span style="color: #C792EA">PagePadding</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">40</span><span style="color: #89DDFF">&quot;</span></span>
<span class="line"><span style="color: #89DDFF">                       </span><span style="color: #C792EA">IsOptimalParagraphEnabled</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">False</span><span style="color: #89DDFF">&quot;</span></span>
<span class="line"><span style="color: #89DDFF">                       </span><span style="color: #C792EA">IsHyphenationEnabled</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">False</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #BABED8">             </span><span style="color: #89DDFF">&lt;</span><span style="color: #F07178">Paragraph</span><span style="color: #89DDFF"> </span><span style="color: #C792EA">TextAlignment</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">Center</span><span style="color: #89DDFF">&quot;</span></span>
<span class="line"><span style="color: #89DDFF">                        </span><span style="color: #C792EA">FontSize</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">22pt</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">&gt;</span></span>
<span class="line"><span style="color: #BABED8">                 </span><span style="color: #89DDFF">&lt;</span><span style="color: #F07178">Run</span><span style="color: #89DDFF"> </span><span style="color: #C792EA">Text</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">Student Report Card</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">/&gt;</span></span>
<span class="line"><span style="color: #BABED8">             </span><span style="color: #89DDFF">&lt;/</span><span style="color: #F07178">Paragraph</span><span style="color: #89DDFF">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #BABED8">             </span><span style="color: #89DDFF">&lt;</span><span style="color: #F07178">BlockUIContainer</span><span style="color: #89DDFF">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #BABED8">                 </span><span style="color: #89DDFF">&lt;</span><span style="color: #F07178">StackPanel</span><span style="color: #89DDFF">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #BABED8">                     </span><span style="color: #464B5D; font-style: italic">&lt;!--Student Information--&gt;</span></span>
<span class="line"><span style="color: #BABED8">                     </span><span style="color: #89DDFF">&lt;</span><span style="color: #F07178">TextBlock</span><span style="color: #89DDFF"> </span><span style="color: #C792EA">Style</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">{StaticResource TitleTextBlockStyle}</span><span style="color: #89DDFF">&quot;</span></span>
<span class="line"><span style="color: #89DDFF">                                </span><span style="color: #C792EA">Text</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">Student Information</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">/&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #BABED8">                     </span><span style="color: #89DDFF">&lt;</span><span style="color: #F07178">Grid</span><span style="color: #89DDFF"> </span><span style="color: #C792EA">Margin</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">50,0</span><span style="color: #89DDFF">&quot;</span></span>
<span class="line"><span style="color: #89DDFF">                           </span><span style="color: #C792EA">Height</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">90</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #BABED8">                         </span><span style="color: #89DDFF">&lt;</span><span style="color: #F07178">Grid.RowDefinitions</span><span style="color: #89DDFF">&gt;</span></span>
<span class="line"><span style="color: #BABED8">                             </span><span style="color: #89DDFF">&lt;</span><span style="color: #F07178">RowDefinition</span><span style="color: #89DDFF"> </span><span style="color: #C792EA">Height</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">30</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">/&gt;</span></span>
<span class="line"><span style="color: #BABED8">                             </span><span style="color: #89DDFF">&lt;</span><span style="color: #F07178">RowDefinition</span><span style="color: #89DDFF"> </span><span style="color: #C792EA">Height</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">30</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">/&gt;</span></span>
<span class="line"><span style="color: #BABED8">                             </span><span style="color: #89DDFF">&lt;</span><span style="color: #F07178">RowDefinition</span><span style="color: #89DDFF"> </span><span style="color: #C792EA">Height</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">30</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">/&gt;</span></span>
<span class="line"><span style="color: #BABED8">                         </span><span style="color: #89DDFF">&lt;/</span><span style="color: #F07178">Grid.RowDefinitions</span><span style="color: #89DDFF">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #BABED8">                         </span><span style="color: #89DDFF">&lt;</span><span style="color: #F07178">Grid.ColumnDefinitions</span><span style="color: #89DDFF">&gt;</span></span>
<span class="line"><span style="color: #BABED8">                             </span><span style="color: #89DDFF">&lt;</span><span style="color: #F07178">ColumnDefinition</span><span style="color: #89DDFF"> </span><span style="color: #C792EA">Width</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">*</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">/&gt;</span></span>
<span class="line"><span style="color: #BABED8">                             </span><span style="color: #89DDFF">&lt;</span><span style="color: #F07178">ColumnDefinition</span><span style="color: #89DDFF"> </span><span style="color: #C792EA">Width</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">3*</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">/&gt;</span></span>
<span class="line"><span style="color: #BABED8">                         </span><span style="color: #89DDFF">&lt;/</span><span style="color: #F07178">Grid.ColumnDefinitions</span><span style="color: #89DDFF">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #BABED8">                         </span><span style="color: #464B5D; font-style: italic">&lt;!--Name--&gt;</span></span>
<span class="line"><span style="color: #BABED8">                         </span><span style="color: #89DDFF">&lt;</span><span style="color: #F07178">Border</span><span style="color: #89DDFF"> </span><span style="color: #C792EA">Grid.Row</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">0</span><span style="color: #89DDFF">&quot;</span></span>
<span class="line"><span style="color: #89DDFF">                                 </span><span style="color: #C792EA">Grid.Column</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">0</span><span style="color: #89DDFF">&quot;</span></span>
<span class="line"><span style="color: #89DDFF">                                 </span><span style="color: #C792EA">BorderBrush</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">Black</span><span style="color: #89DDFF">&quot;</span></span>
<span class="line"><span style="color: #89DDFF">                                 </span><span style="color: #C792EA">BorderThickness</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">1,1,0,0</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">&gt;</span></span>
<span class="line"><span style="color: #BABED8">                             </span><span style="color: #89DDFF">&lt;</span><span style="color: #F07178">TextBlock</span><span style="color: #89DDFF"> </span><span style="color: #C792EA">Style</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">{StaticResource TableTitleTextBlockStyle}</span><span style="color: #89DDFF">&quot;</span></span>
<span class="line"><span style="color: #89DDFF">                                        </span><span style="color: #C792EA">Text</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">Name</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">/&gt;</span></span>
<span class="line"><span style="color: #BABED8">                         </span><span style="color: #89DDFF">&lt;/</span><span style="color: #F07178">Border</span><span style="color: #89DDFF">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #BABED8">                         </span><span style="color: #89DDFF">&lt;</span><span style="color: #F07178">Border</span><span style="color: #89DDFF"> </span><span style="color: #C792EA">Grid.Row</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">0</span><span style="color: #89DDFF">&quot;</span></span>
<span class="line"><span style="color: #89DDFF">                                 </span><span style="color: #C792EA">Grid.Column</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">1</span><span style="color: #89DDFF">&quot;</span></span>
<span class="line"><span style="color: #89DDFF">                                 </span><span style="color: #C792EA">BorderBrush</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">Black</span><span style="color: #89DDFF">&quot;</span></span>
<span class="line"><span style="color: #89DDFF">                                 </span><span style="color: #C792EA">BorderThickness</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">1,1,1,0</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">&gt;</span></span>
<span class="line"><span style="color: #BABED8">                             </span><span style="color: #89DDFF">&lt;</span><span style="color: #F07178">TextBlock</span><span style="color: #89DDFF"> </span><span style="color: #C792EA">Style</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">{StaticResource TableContentTextBlockSytle}</span><span style="color: #89DDFF">&quot;</span></span>
<span class="line"><span style="color: #89DDFF">                                        </span><span style="color: #C792EA">Text</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">{Binding Path=Name}</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">/&gt;</span></span>
<span class="line"><span style="color: #BABED8">                         </span><span style="color: #89DDFF">&lt;/</span><span style="color: #F07178">Border</span><span style="color: #89DDFF">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #BABED8">                         </span><span style="color: #464B5D; font-style: italic">&lt;!--ID--&gt;</span></span>
<span class="line"><span style="color: #BABED8">                         </span><span style="color: #89DDFF">&lt;</span><span style="color: #F07178">Border</span><span style="color: #89DDFF"> </span><span style="color: #C792EA">Grid.Row</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">1</span><span style="color: #89DDFF">&quot;</span></span>
<span class="line"><span style="color: #89DDFF">                                 </span><span style="color: #C792EA">Grid.Column</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">0</span><span style="color: #89DDFF">&quot;</span></span>
<span class="line"><span style="color: #89DDFF">                                 </span><span style="color: #C792EA">BorderBrush</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">Black</span><span style="color: #89DDFF">&quot;</span></span>
<span class="line"><span style="color: #89DDFF">                                 </span><span style="color: #C792EA">BorderThickness</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">1,1,0,0</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">&gt;</span></span>
<span class="line"><span style="color: #BABED8">                             </span><span style="color: #89DDFF">&lt;</span><span style="color: #F07178">TextBlock</span><span style="color: #89DDFF"> </span><span style="color: #C792EA">Style</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">{StaticResource TableTitleTextBlockStyle}</span><span style="color: #89DDFF">&quot;</span></span>
<span class="line"><span style="color: #89DDFF">                                        </span><span style="color: #C792EA">Text</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">ID</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">/&gt;</span></span>
<span class="line"><span style="color: #BABED8">                         </span><span style="color: #89DDFF">&lt;/</span><span style="color: #F07178">Border</span><span style="color: #89DDFF">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #BABED8">                         </span><span style="color: #89DDFF">&lt;</span><span style="color: #F07178">Border</span><span style="color: #89DDFF"> </span><span style="color: #C792EA">Grid.Row</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">1</span><span style="color: #89DDFF">&quot;</span></span>
<span class="line"><span style="color: #89DDFF">                                 </span><span style="color: #C792EA">Grid.Column</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">1</span><span style="color: #89DDFF">&quot;</span></span>
<span class="line"><span style="color: #89DDFF">                                 </span><span style="color: #C792EA">BorderBrush</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">Black</span><span style="color: #89DDFF">&quot;</span></span>
<span class="line"><span style="color: #89DDFF">                                 </span><span style="color: #C792EA">BorderThickness</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">1,1,1,0</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">&gt;</span></span>
<span class="line"><span style="color: #BABED8">                             </span><span style="color: #89DDFF">&lt;</span><span style="color: #F07178">TextBlock</span><span style="color: #89DDFF"> </span><span style="color: #C792EA">Style</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">{StaticResource TableContentTextBlockSytle}</span><span style="color: #89DDFF">&quot;</span></span>
<span class="line"><span style="color: #89DDFF">                                        </span><span style="color: #C792EA">Text</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">{Binding Path=Id}</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">/&gt;</span></span>
<span class="line"><span style="color: #BABED8">                         </span><span style="color: #89DDFF">&lt;/</span><span style="color: #F07178">Border</span><span style="color: #89DDFF">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #BABED8">                         </span><span style="color: #464B5D; font-style: italic">&lt;!--Email--&gt;</span></span>
<span class="line"><span style="color: #BABED8">                         </span><span style="color: #89DDFF">&lt;</span><span style="color: #F07178">Border</span><span style="color: #89DDFF"> </span><span style="color: #C792EA">Grid.Row</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">2</span><span style="color: #89DDFF">&quot;</span></span>
<span class="line"><span style="color: #89DDFF">                                 </span><span style="color: #C792EA">Grid.Column</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">0</span><span style="color: #89DDFF">&quot;</span></span>
<span class="line"><span style="color: #89DDFF">                                 </span><span style="color: #C792EA">BorderBrush</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">Black</span><span style="color: #89DDFF">&quot;</span></span>
<span class="line"><span style="color: #89DDFF">                                 </span><span style="color: #C792EA">BorderThickness</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">1,1,0,1</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">&gt;</span></span>
<span class="line"><span style="color: #BABED8">                             </span><span style="color: #89DDFF">&lt;</span><span style="color: #F07178">TextBlock</span><span style="color: #89DDFF"> </span><span style="color: #C792EA">Style</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">{StaticResource TableTitleTextBlockStyle}</span><span style="color: #89DDFF">&quot;</span></span>
<span class="line"><span style="color: #89DDFF">                                        </span><span style="color: #C792EA">Text</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">Email</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">/&gt;</span></span>
<span class="line"><span style="color: #BABED8">                         </span><span style="color: #89DDFF">&lt;/</span><span style="color: #F07178">Border</span><span style="color: #89DDFF">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #BABED8">                         </span><span style="color: #89DDFF">&lt;</span><span style="color: #F07178">Border</span><span style="color: #89DDFF"> </span><span style="color: #C792EA">Grid.Row</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">2</span><span style="color: #89DDFF">&quot;</span></span>
<span class="line"><span style="color: #89DDFF">                                 </span><span style="color: #C792EA">Grid.Column</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">1</span><span style="color: #89DDFF">&quot;</span></span>
<span class="line"><span style="color: #89DDFF">                                 </span><span style="color: #C792EA">BorderBrush</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">Black</span><span style="color: #89DDFF">&quot;</span></span>
<span class="line"><span style="color: #89DDFF">                                 </span><span style="color: #C792EA">BorderThickness</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">1</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">&gt;</span></span>
<span class="line"><span style="color: #BABED8">                             </span><span style="color: #89DDFF">&lt;</span><span style="color: #F07178">TextBlock</span><span style="color: #89DDFF"> </span><span style="color: #C792EA">Style</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">{StaticResource TableContentTextBlockSytle}</span><span style="color: #89DDFF">&quot;</span></span>
<span class="line"><span style="color: #89DDFF">                                        </span><span style="color: #C792EA">Text</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">{Binding Path=Email}</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">/&gt;</span></span>
<span class="line"><span style="color: #BABED8">                         </span><span style="color: #89DDFF">&lt;/</span><span style="color: #F07178">Border</span><span style="color: #89DDFF">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #BABED8">                     </span><span style="color: #89DDFF">&lt;/</span><span style="color: #F07178">Grid</span><span style="color: #89DDFF">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #BABED8">                     </span><span style="color: #464B5D; font-style: italic">&lt;!--Grades--&gt;</span></span>
<span class="line"><span style="color: #BABED8">                     </span><span style="color: #89DDFF">&lt;</span><span style="color: #F07178">TextBlock</span><span style="color: #89DDFF"> </span><span style="color: #C792EA">Style</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">{StaticResource TitleTextBlockStyle}</span><span style="color: #89DDFF">&quot;</span></span>
<span class="line"><span style="color: #89DDFF">                                </span><span style="color: #C792EA">Text</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">Grades</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">/&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #BABED8">                     </span><span style="color: #89DDFF">&lt;</span><span style="color: #F07178">DataGrid</span><span style="color: #89DDFF"> </span><span style="color: #C792EA">Margin</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">50,0</span><span style="color: #89DDFF">&quot;</span></span>
<span class="line"><span style="color: #89DDFF">                               </span><span style="color: #C792EA">FontSize</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">12</span><span style="color: #89DDFF">&quot;</span></span>
<span class="line"><span style="color: #89DDFF">                               </span><span style="color: #C792EA">RowHeaderWidth</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">0</span><span style="color: #89DDFF">&quot;</span></span>
<span class="line"><span style="color: #89DDFF">                               </span><span style="color: #C792EA">AutoGenerateColumns</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">False</span><span style="color: #89DDFF">&quot;</span></span>
<span class="line"><span style="color: #89DDFF">                               </span><span style="color: #C792EA">CanUserAddRows</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">False</span><span style="color: #89DDFF">&quot;</span></span>
<span class="line"><span style="color: #89DDFF">                               </span><span style="color: #C792EA">ColumnHeaderStyle</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">{StaticResource DataGridColumnHeaderStyle}</span><span style="color: #89DDFF">&quot;</span></span>
<span class="line"><span style="color: #89DDFF">                               </span><span style="color: #C792EA">ItemsSource</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">{Binding Path=GradeCollection}</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #BABED8">                         </span><span style="color: #89DDFF">&lt;</span><span style="color: #F07178">DataGrid.Columns</span><span style="color: #89DDFF">&gt;</span></span>
<span class="line"><span style="color: #BABED8">                             </span><span style="color: #89DDFF">&lt;</span><span style="color: #F07178">DataGridTextColumn</span><span style="color: #89DDFF"> </span><span style="color: #C792EA">Header</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">Subject</span><span style="color: #89DDFF">&quot;</span></span>
<span class="line"><span style="color: #89DDFF">                                                 </span><span style="color: #C792EA">Width</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">140</span><span style="color: #89DDFF">&quot;</span></span>
<span class="line"><span style="color: #89DDFF">                                                 </span><span style="color: #C792EA">Binding</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">{Binding Path=Subject}</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">/&gt;</span></span>
<span class="line"><span style="color: #BABED8">                             </span><span style="color: #89DDFF">&lt;</span><span style="color: #F07178">DataGridTextColumn</span><span style="color: #89DDFF"> </span><span style="color: #C792EA">Header</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">Grade</span><span style="color: #89DDFF">&quot;</span></span>
<span class="line"><span style="color: #89DDFF">                                                 </span><span style="color: #C792EA">Width</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">*</span><span style="color: #89DDFF">&quot;</span></span>
<span class="line"><span style="color: #89DDFF">                                                 </span><span style="color: #C792EA">Binding</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">{Binding Path=Grade}</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">/&gt;</span></span>
<span class="line"><span style="color: #BABED8">                         </span><span style="color: #89DDFF">&lt;/</span><span style="color: #F07178">DataGrid.Columns</span><span style="color: #89DDFF">&gt;</span></span>
<span class="line"><span style="color: #BABED8">                     </span><span style="color: #89DDFF">&lt;/</span><span style="color: #F07178">DataGrid</span><span style="color: #89DDFF">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #BABED8">                 </span><span style="color: #89DDFF">&lt;/</span><span style="color: #F07178">StackPanel</span><span style="color: #89DDFF">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #BABED8">             </span><span style="color: #89DDFF">&lt;/</span><span style="color: #F07178">BlockUIContainer</span><span style="color: #89DDFF">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #BABED8">         </span><span style="color: #89DDFF">&lt;/</span><span style="color: #F07178">FlowDocument</span><span style="color: #89DDFF">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #BABED8">     </span><span style="color: #89DDFF">&lt;/</span><span style="color: #F07178">FlowDocumentScrollViewer</span><span style="color: #89DDFF">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #BABED8">     </span><span style="color: #464B5D; font-style: italic">&lt;!--使用者輸入區域--&gt;</span></span>
<span class="line"><span style="color: #BABED8">     </span><span style="color: #89DDFF">&lt;</span><span style="color: #F07178">Grid</span><span style="color: #89DDFF"> </span><span style="color: #C792EA">Background</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">White</span><span style="color: #89DDFF">&quot;</span></span>
<span class="line"><span style="color: #89DDFF">           </span><span style="color: #C792EA">Visibility</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">Visible</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #BABED8">         </span><span style="color: #89DDFF">&lt;</span><span style="color: #F07178">StackPanel</span><span style="color: #89DDFF"> </span><span style="color: #C792EA">Margin</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">30</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #BABED8">             </span><span style="color: #464B5D; font-style: italic">&lt;!--Name--&gt;</span></span>
<span class="line"><span style="color: #BABED8">             </span><span style="color: #89DDFF">&lt;</span><span style="color: #F07178">TextBlock</span><span style="color: #89DDFF"> </span><span style="color: #C792EA">Text</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">Name:</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">/&gt;</span></span>
<span class="line"><span style="color: #BABED8">             </span><span style="color: #89DDFF">&lt;</span><span style="color: #F07178">TextBox</span><span style="color: #89DDFF"> </span><span style="color: #C792EA">Text</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">{Binding Path=Name,</span></span>
<span class="line"><span style="color: #C3E88D">                                     UpdateSourceTrigger=PropertyChanged}</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">/&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #BABED8">             </span><span style="color: #464B5D; font-style: italic">&lt;!--Id--&gt;</span></span>
<span class="line"><span style="color: #BABED8">             </span><span style="color: #89DDFF">&lt;</span><span style="color: #F07178">TextBlock</span><span style="color: #89DDFF"> </span><span style="color: #C792EA">Margin</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">{StaticResource Margin.Top}</span><span style="color: #89DDFF">&quot;</span></span>
<span class="line"><span style="color: #89DDFF">                        </span><span style="color: #C792EA">Text</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">ID:</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">/&gt;</span></span>
<span class="line"><span style="color: #BABED8">             </span><span style="color: #89DDFF">&lt;</span><span style="color: #F07178">TextBox</span><span style="color: #89DDFF"> </span><span style="color: #C792EA">Text</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">{Binding Path=Id,</span></span>
<span class="line"><span style="color: #C3E88D">                                     UpdateSourceTrigger=PropertyChanged}</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">/&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #BABED8">             </span><span style="color: #464B5D; font-style: italic">&lt;!--Email--&gt;</span></span>
<span class="line"><span style="color: #BABED8">             </span><span style="color: #89DDFF">&lt;</span><span style="color: #F07178">TextBlock</span><span style="color: #89DDFF"> </span><span style="color: #C792EA">Margin</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">{StaticResource Margin.Top}</span><span style="color: #89DDFF">&quot;</span></span>
<span class="line"><span style="color: #89DDFF">                        </span><span style="color: #C792EA">Text</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">Email:</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">/&gt;</span></span>
<span class="line"><span style="color: #BABED8">             </span><span style="color: #89DDFF">&lt;</span><span style="color: #F07178">TextBox</span><span style="color: #89DDFF"> </span><span style="color: #C792EA">Text</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">{Binding Path=Email,</span></span>
<span class="line"><span style="color: #C3E88D">                                     UpdateSourceTrigger=PropertyChanged}</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">/&gt;</span></span>
<span class="line"><span style="color: #BABED8">             </span></span>
<span class="line"><span style="color: #BABED8">             </span><span style="color: #89DDFF">&lt;</span><span style="color: #F07178">Button</span><span style="color: #89DDFF"> </span><span style="color: #C792EA">Margin</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">{StaticResource Margin.Top}</span><span style="color: #89DDFF">&quot;</span></span>
<span class="line"><span style="color: #89DDFF">                     </span><span style="color: #C792EA">HorizontalAlignment</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">Left</span><span style="color: #89DDFF">&quot;</span></span>
<span class="line"><span style="color: #89DDFF">                     </span><span style="color: #C792EA">Width</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">120</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF"> </span><span style="color: #C792EA">Height</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">30</span><span style="color: #89DDFF">&quot;</span></span>
<span class="line"><span style="color: #89DDFF">                     </span><span style="color: #C792EA">Content</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">Create</span><span style="color: #89DDFF">&quot;</span></span>
<span class="line"><span style="color: #89DDFF">                     </span><span style="color: #C792EA">Command</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">{Binding Path=CreatePdfCommand}</span><span style="color: #89DDFF">&quot;</span></span>
<span class="line"><span style="color: #89DDFF">                     </span><span style="color: #C792EA">CommandParameter</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">{Binding ElementName=flowDocument}</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">/&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #BABED8">         </span><span style="color: #89DDFF">&lt;/</span><span style="color: #F07178">StackPanel</span><span style="color: #89DDFF">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #BABED8">     </span><span style="color: #89DDFF">&lt;/</span><span style="color: #F07178">Grid</span><span style="color: #89DDFF">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #BABED8"> </span><span style="color: #89DDFF">&lt;/</span><span style="color: #F07178">Grid</span><span style="color: #89DDFF">&gt;</span></span></code></pre></div>
</div>



<p>在生成 PDF 的部分，整體效果如下圖所示。整體的架構大致分為：</p>



<ul>
<li>最外層使用了 FlowDocument 來定義整個頁面。</li>



<li>使用 Paragraph 元素來顯示 PDF 文檔的標題「Student Report Card」，也可以用其他 UI 元件。</li>



<li>使用 <mark style="background-color:rgba(0, 0, 0, 0)" class="has-inline-color has-palette-color-8-color">BlockUIContainer</mark> 包含了主要的 UI 元素，來 Binding 與 顯示內容。</li>



<li>主要顯示的內容，放在 StackPanel 中：
<ol>
<li>使用 TextBlock 來顯示學生的基本信息（姓名、學號、Email），這三個元素的內容使用Binding 而來，並搭配 Border 做出表格邊線。</li>



<li>使用 DataGrid 來顯示學生的各科目的成績，顯示的內容也是透過 Binding 到一個集合來顯示，而外觀部分簡單做了 Style 讓元件看起來略像表格。</li>
</ol>
</li>
</ul>



<figure class="wp-block-image size-large"><img decoding="async" src="https://i.imgur.com/9gizEla.png" alt=""/></figure>



<p></p>



<p>使用者輸入區域的部分是一個簡單的表單，如下圖所示。其架構分為：</p>



<ul>
<li>簡單的輸入 UI，可以輸入姓名、學號和 Email。</li>



<li>產生按鈕，按下按鈕後，將執行對應的程式來生成 PDF 檔案。成績的部分則會在生成過程中隨機產生並包含在PDF中。</li>
</ul>



<figure class="wp-block-image size-large"><img decoding="async" src="https://i.imgur.com/ppCgBFG.png" alt=""/></figure>



<p></p>



<p>接下來是 ViewModel 的部分。由於成績的資料會是一個集合，因此需要建立一個類別來放置成績，程式碼如下。</p>



<div class="wp-block-group is-vertical is-content-justification-stretch is-layout-flex wp-container-core-group-is-layout-2 wp-block-group-is-layout-flex">
<p>GradeObservableModel</p>



<div class="wp-block-kevinbatdorf-code-block-pro cbp-has-line-numbers" data-code-block-pro-font-family="Code-Pro-JetBrains-Mono" style="font-size:.875rem;font-family:Code-Pro-JetBrains-Mono,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;--cbp-line-number-color:#babed8;--cbp-line-number-width:calc(1 * 0.6 * .875rem);line-height:1.25rem;--cbp-tab-width:2;tab-size:var(--cbp-tab-width, 2)"><span style="display:flex;align-items:center;padding:10px 0px 10px 16px;margin-bottom:-2px;width:100%;text-align:left;background-color:#181c2a;color:#aaafcf">C#</span><span role="button" tabindex="0" data-code="public partial class GradeObservableModel : ObservableObject
{
    [ObservableProperty]
    private string? _subject;

    [ObservableProperty]
    private int _grade;
}" style="color:#babed8;display:none" aria-label="Copy" class="code-block-pro-copy-button"><svg xmlns="http://www.w3.org/2000/svg" style="width:24px;height:24px" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M4.5 12.75l6 6 9-13.5"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M16.5 8.25V6a2.25 2.25 0 00-2.25-2.25H6A2.25 2.25 0 003.75 6v8.25A2.25 2.25 0 006 16.5h2.25m8.25-8.25H18a2.25 2.25 0 012.25 2.25V18A2.25 2.25 0 0118 20.25h-7.5A2.25 2.25 0 018.25 18v-1.5m8.25-8.25h-6a2.25 2.25 0 00-2.25 2.25v6"></path></svg></span><pre class="shiki material-theme-ocean" style="background-color: #0F111A" tabindex="0"><code><span class="line"><span style="color: #C792EA">public</span><span style="color: #BABED8"> </span><span style="color: #C792EA">partial</span><span style="color: #BABED8"> </span><span style="color: #FFCB6B">class</span><span style="color: #BABED8"> </span><span style="color: #FFCB6B">GradeObservableModel</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">:</span><span style="color: #BABED8"> </span><span style="color: #FFCB6B">ObservableObject</span></span>
<span class="line"><span style="color: #89DDFF">{</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #89DDFF">[</span><span style="color: #FFCB6B">ObservableProperty</span><span style="color: #89DDFF">]</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #C792EA">private</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">string</span><span style="color: #89DDFF">?</span><span style="color: #BABED8"> </span><span style="color: #FFCB6B">_subject</span><span style="color: #89DDFF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #89DDFF">[</span><span style="color: #FFCB6B">ObservableProperty</span><span style="color: #89DDFF">]</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #C792EA">private</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">int</span><span style="color: #BABED8"> </span><span style="color: #FFCB6B">_grade</span><span style="color: #89DDFF">;</span></span>
<span class="line"><span style="color: #89DDFF">}</span></span></code></pre></div>
</div>



<p></p>



<p>最後是 MainWindow 所用的 ViewModel，程式碼如下。</p>



<p>在 Class 方面，ViewModel 的機制藉由繼承了 <mark style="background-color:var(--theme-palette-color-9, rgba(255, 255, 255, 0.2))" class="has-inline-color has-palette-color-8-color">CommunityToolkit.MVVM</mark> 套件中的 <mark style="background-color:var(--theme-palette-color-9, rgba(255, 255, 255, 0.2))" class="has-inline-color has-palette-color-8-color">ObservableObject</mark> 類別來達成。</p>



<p>在 Property 方面，有 Name、Id、Email 以及 GradeCollection 。</p>



<p>在 Command 方面，執行流程為，</p>



<ul>
<li>參數會帶入 FlowDocument。</li>



<li>清空 GradeCollection ，產生新的一組資料。</li>



<li>使用 ConvertToXps 方法將 FlowDocument 轉換成 XPS 格式。</li>



<li>將 XPS 資料帶入 SaveAsPdf 方法，該方法使用 <mark style="background-color:var(--theme-palette-color-9, rgba(255, 255, 255, 0.2))" class="has-inline-color has-palette-color-8-color">FreeSpire.PDF</mark> 套件中的方法讀取 XPS 資料並儲存為 PDF 檔案。</li>
</ul>



<div class="wp-block-group is-vertical is-content-justification-stretch is-layout-flex wp-container-core-group-is-layout-3 wp-block-group-is-layout-flex">
<p>MainWindowViewModel</p>



<div class="wp-block-kevinbatdorf-code-block-pro cbp-has-line-numbers" data-code-block-pro-font-family="Code-Pro-JetBrains-Mono" style="font-size:.875rem;font-family:Code-Pro-JetBrains-Mono,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;--cbp-line-number-color:#babed8;--cbp-line-number-width:calc(2 * 0.6 * .875rem);line-height:1.25rem;--cbp-tab-width:2;tab-size:var(--cbp-tab-width, 2)"><span style="display:flex;align-items:center;padding:10px 0px 10px 16px;margin-bottom:-2px;width:100%;text-align:left;background-color:#181c2a;color:#aaafcf">C#</span><span role="button" tabindex="0" data-code="public partial class MainWindowViewModel : ObservableObject
{
    private Random random;

    [ObservableProperty]
    private string? _name;

    [ObservableProperty]
    private string? _id;

    [ObservableProperty]
    private string? _email;

    public ObservableCollection&lt;GradeObservableModel&gt; GradeCollection
    { get; set; }

    public MainWindowViewModel()
    {
        random = new();

        _name = &quot;Peter&quot;;
        _id = &quot;123456&quot;;
        _email = &quot;peter@email.com&quot;;

        GradeCollection = new();
    }

    [RelayCommand]
    private async Task CreatePdf(FlowDocument fd)
    {
        // Clear GradeCollection and add random data 
        GradeCollection.Clear();
        GradeCollection.Add(new() { Subject = &quot;Math&quot;, Grade = random.Next(60, 101) });
        GradeCollection.Add(new() { Subject = &quot;English&quot;, Grade = random.Next(60, 101) });
        GradeCollection.Add(new() { Subject = &quot;Science&quot;, Grade = random.Next(60, 101) });

        // Wait for UI refresh
        await Task.Delay(1);

        // Convert the FlowDocument to XPS
        var xpsStream = ConvertToXps(fd);

        // Save PDF to the specified path
        SaveAsPdf(xpsStream, &quot;output.pdf&quot;);
        MessageBox.Show(&quot;Finish!&quot;);
    }

    private static MemoryStream ConvertToXps(FlowDocument flowDocument)
    {
        // Convert FlowDocument to XPS stream
        var xpsStream = new MemoryStream();
        using (Package package = Package.Open(xpsStream, FileMode.Create))
        {
            var xpsDoc = new XpsDocument(package);
            XpsDocumentWriter xpsWriter = XpsDocument.CreateXpsDocumentWriter(xpsDoc);
            DocumentPaginator paginator = ((IDocumentPaginatorSource)flowDocument).DocumentPaginator;
            xpsWriter.Write(paginator);
            xpsDoc.Close();
        }

        return xpsStream;
    }

    private static void SaveAsPdf(MemoryStream xpsStream, string outputPdfPath)
    {
        // Load XPS stream into PdfDocument
        var pdfDoc = new PdfDocument();
        pdfDoc.LoadFromXPS(xpsStream);

        // Set PDF page size to A4
        pdfDoc.PageSettings.Size = PdfPageSize.A4;

        // Save PdfDocument to PDF file
        pdfDoc.SaveToFile(outputPdfPath);
        pdfDoc.Close();

        // Dispose the XPS stream
        xpsStream.Dispose();
    }
}" style="color:#babed8;display:none" aria-label="Copy" class="code-block-pro-copy-button"><svg xmlns="http://www.w3.org/2000/svg" style="width:24px;height:24px" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M4.5 12.75l6 6 9-13.5"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M16.5 8.25V6a2.25 2.25 0 00-2.25-2.25H6A2.25 2.25 0 003.75 6v8.25A2.25 2.25 0 006 16.5h2.25m8.25-8.25H18a2.25 2.25 0 012.25 2.25V18A2.25 2.25 0 0118 20.25h-7.5A2.25 2.25 0 018.25 18v-1.5m8.25-8.25h-6a2.25 2.25 0 00-2.25 2.25v6"></path></svg></span><pre class="shiki material-theme-ocean" style="background-color: #0F111A" tabindex="0"><code><span class="line"><span style="color: #C792EA">public</span><span style="color: #BABED8"> </span><span style="color: #C792EA">partial</span><span style="color: #BABED8"> </span><span style="color: #FFCB6B">class</span><span style="color: #BABED8"> </span><span style="color: #FFCB6B">MainWindowViewModel</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">:</span><span style="color: #BABED8"> </span><span style="color: #FFCB6B">ObservableObject</span></span>
<span class="line"><span style="color: #89DDFF">{</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #C792EA">private</span><span style="color: #BABED8"> </span><span style="color: #FFCB6B">Random</span><span style="color: #BABED8"> </span><span style="color: #FFCB6B">random</span><span style="color: #89DDFF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #89DDFF">[</span><span style="color: #FFCB6B">ObservableProperty</span><span style="color: #89DDFF">]</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #C792EA">private</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">string</span><span style="color: #89DDFF">?</span><span style="color: #BABED8"> </span><span style="color: #FFCB6B">_name</span><span style="color: #89DDFF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #89DDFF">[</span><span style="color: #FFCB6B">ObservableProperty</span><span style="color: #89DDFF">]</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #C792EA">private</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">string</span><span style="color: #89DDFF">?</span><span style="color: #BABED8"> </span><span style="color: #FFCB6B">_id</span><span style="color: #89DDFF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #89DDFF">[</span><span style="color: #FFCB6B">ObservableProperty</span><span style="color: #89DDFF">]</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #C792EA">private</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">string</span><span style="color: #89DDFF">?</span><span style="color: #BABED8"> </span><span style="color: #FFCB6B">_email</span><span style="color: #89DDFF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #C792EA">public</span><span style="color: #BABED8"> </span><span style="color: #FFCB6B">ObservableCollection</span><span style="color: #89DDFF">&lt;</span><span style="color: #FFCB6B">GradeObservableModel</span><span style="color: #89DDFF">&gt;</span><span style="color: #BABED8"> </span><span style="color: #FFCB6B">GradeCollection</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #89DDFF">{</span><span style="color: #BABED8"> </span><span style="color: #FFCB6B">get</span><span style="color: #89DDFF">;</span><span style="color: #BABED8"> </span><span style="color: #FFCB6B">set</span><span style="color: #89DDFF">;</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #C792EA">public</span><span style="color: #BABED8"> </span><span style="color: #82AAFF">MainWindowViewModel</span><span style="color: #89DDFF">()</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #89DDFF">{</span></span>
<span class="line"><span style="color: #BABED8">        random </span><span style="color: #89DDFF">=</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">new();</span></span>
<span class="line"></span>
<span class="line"><span style="color: #BABED8">        _name </span><span style="color: #89DDFF">=</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">Peter</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">;</span></span>
<span class="line"><span style="color: #BABED8">        _id </span><span style="color: #89DDFF">=</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">123456</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">;</span></span>
<span class="line"><span style="color: #BABED8">        _email </span><span style="color: #89DDFF">=</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">peter@email.com</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #BABED8">        GradeCollection </span><span style="color: #89DDFF">=</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">new();</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #89DDFF">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #89DDFF">[</span><span style="color: #FFCB6B">RelayCommand</span><span style="color: #89DDFF">]</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #C792EA">private</span><span style="color: #BABED8"> </span><span style="color: #C792EA">async</span><span style="color: #BABED8"> </span><span style="color: #FFCB6B">Task</span><span style="color: #BABED8"> </span><span style="color: #82AAFF">CreatePdf</span><span style="color: #89DDFF">(</span><span style="color: #FFCB6B">FlowDocument</span><span style="color: #BABED8"> </span><span style="color: #FFCB6B">fd</span><span style="color: #89DDFF">)</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #89DDFF">{</span></span>
<span class="line"><span style="color: #89DDFF; font-style: italic">        </span><span style="color: #464B5D; font-style: italic">// Clear GradeCollection and add random data </span></span>
<span class="line"><span style="color: #BABED8">        GradeCollection</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">Clear</span><span style="color: #89DDFF">();</span></span>
<span class="line"><span style="color: #BABED8">        GradeCollection</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">Add</span><span style="color: #89DDFF">(new()</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">{</span><span style="color: #BABED8"> Subject </span><span style="color: #89DDFF">=</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">Math</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">,</span><span style="color: #BABED8"> Grade </span><span style="color: #89DDFF">=</span><span style="color: #BABED8"> random</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">Next</span><span style="color: #89DDFF">(</span><span style="color: #F78C6C">60</span><span style="color: #89DDFF">,</span><span style="color: #BABED8"> </span><span style="color: #F78C6C">101</span><span style="color: #89DDFF">)</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">});</span></span>
<span class="line"><span style="color: #BABED8">        GradeCollection</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">Add</span><span style="color: #89DDFF">(new()</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">{</span><span style="color: #BABED8"> Subject </span><span style="color: #89DDFF">=</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">English</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">,</span><span style="color: #BABED8"> Grade </span><span style="color: #89DDFF">=</span><span style="color: #BABED8"> random</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">Next</span><span style="color: #89DDFF">(</span><span style="color: #F78C6C">60</span><span style="color: #89DDFF">,</span><span style="color: #BABED8"> </span><span style="color: #F78C6C">101</span><span style="color: #89DDFF">)</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">});</span></span>
<span class="line"><span style="color: #BABED8">        GradeCollection</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">Add</span><span style="color: #89DDFF">(new()</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">{</span><span style="color: #BABED8"> Subject </span><span style="color: #89DDFF">=</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">Science</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">,</span><span style="color: #BABED8"> Grade </span><span style="color: #89DDFF">=</span><span style="color: #BABED8"> random</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">Next</span><span style="color: #89DDFF">(</span><span style="color: #F78C6C">60</span><span style="color: #89DDFF">,</span><span style="color: #BABED8"> </span><span style="color: #F78C6C">101</span><span style="color: #89DDFF">)</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">});</span></span>
<span class="line"></span>
<span class="line"><span style="color: #89DDFF; font-style: italic">        </span><span style="color: #464B5D; font-style: italic">// Wait for UI refresh</span></span>
<span class="line"><span style="color: #BABED8">        </span><span style="color: #89DDFF">await</span><span style="color: #BABED8"> Task</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">Delay</span><span style="color: #89DDFF">(</span><span style="color: #F78C6C">1</span><span style="color: #89DDFF">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #89DDFF; font-style: italic">        </span><span style="color: #464B5D; font-style: italic">// Convert the FlowDocument to XPS</span></span>
<span class="line"><span style="color: #BABED8">        </span><span style="color: #FFCB6B">var</span><span style="color: #BABED8"> </span><span style="color: #FFCB6B">xpsStream</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">=</span><span style="color: #BABED8"> </span><span style="color: #82AAFF">ConvertToXps</span><span style="color: #89DDFF">(</span><span style="color: #BABED8">fd</span><span style="color: #89DDFF">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #89DDFF; font-style: italic">        </span><span style="color: #464B5D; font-style: italic">// Save PDF to the specified path</span></span>
<span class="line"><span style="color: #BABED8">        </span><span style="color: #82AAFF">SaveAsPdf</span><span style="color: #89DDFF">(</span><span style="color: #BABED8">xpsStream</span><span style="color: #89DDFF">,</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">output.pdf</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">);</span></span>
<span class="line"><span style="color: #BABED8">        MessageBox</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">Show</span><span style="color: #89DDFF">(</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">Finish!</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">);</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #89DDFF">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #C792EA">private</span><span style="color: #BABED8"> </span><span style="color: #C792EA">static</span><span style="color: #BABED8"> </span><span style="color: #FFCB6B">MemoryStream</span><span style="color: #BABED8"> </span><span style="color: #82AAFF">ConvertToXps</span><span style="color: #89DDFF">(</span><span style="color: #FFCB6B">FlowDocument</span><span style="color: #BABED8"> </span><span style="color: #FFCB6B">flowDocument</span><span style="color: #89DDFF">)</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #89DDFF">{</span></span>
<span class="line"><span style="color: #89DDFF; font-style: italic">        </span><span style="color: #464B5D; font-style: italic">// Convert FlowDocument to XPS stream</span></span>
<span class="line"><span style="color: #BABED8">        </span><span style="color: #FFCB6B">var</span><span style="color: #BABED8"> </span><span style="color: #FFCB6B">xpsStream</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">=</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">new</span><span style="color: #BABED8"> </span><span style="color: #FFCB6B">MemoryStream</span><span style="color: #89DDFF">();</span></span>
<span class="line"><span style="color: #BABED8">        </span><span style="color: #89DDFF; font-style: italic">using</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">(</span><span style="color: #FFCB6B">Package</span><span style="color: #BABED8"> </span><span style="color: #FFCB6B">package</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">=</span><span style="color: #BABED8"> Package</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">Open</span><span style="color: #89DDFF">(</span><span style="color: #BABED8">xpsStream</span><span style="color: #89DDFF">,</span><span style="color: #BABED8"> FileMode</span><span style="color: #89DDFF">.</span><span style="color: #BABED8">Create</span><span style="color: #89DDFF">))</span></span>
<span class="line"><span style="color: #BABED8">        </span><span style="color: #89DDFF">{</span></span>
<span class="line"><span style="color: #BABED8">            </span><span style="color: #FFCB6B">var</span><span style="color: #BABED8"> </span><span style="color: #FFCB6B">xpsDoc</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">=</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">new</span><span style="color: #BABED8"> </span><span style="color: #FFCB6B">XpsDocument</span><span style="color: #89DDFF">(</span><span style="color: #BABED8">package</span><span style="color: #89DDFF">);</span></span>
<span class="line"><span style="color: #BABED8">            </span><span style="color: #FFCB6B">XpsDocumentWriter</span><span style="color: #BABED8"> </span><span style="color: #FFCB6B">xpsWriter</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">=</span><span style="color: #BABED8"> XpsDocument</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">CreateXpsDocumentWriter</span><span style="color: #89DDFF">(</span><span style="color: #BABED8">xpsDoc</span><span style="color: #89DDFF">);</span></span>
<span class="line"><span style="color: #BABED8">            </span><span style="color: #FFCB6B">DocumentPaginator</span><span style="color: #BABED8"> </span><span style="color: #FFCB6B">paginator</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">=</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">((</span><span style="color: #FFCB6B">IDocumentPaginatorSource</span><span style="color: #89DDFF">)</span><span style="color: #BABED8">flowDocument</span><span style="color: #89DDFF">).</span><span style="color: #BABED8">DocumentPaginator</span><span style="color: #89DDFF">;</span></span>
<span class="line"><span style="color: #BABED8">            xpsWriter</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">Write</span><span style="color: #89DDFF">(</span><span style="color: #BABED8">paginator</span><span style="color: #89DDFF">);</span></span>
<span class="line"><span style="color: #BABED8">            xpsDoc</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">Close</span><span style="color: #89DDFF">();</span></span>
<span class="line"><span style="color: #BABED8">        </span><span style="color: #89DDFF">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #BABED8">        </span><span style="color: #89DDFF; font-style: italic">return</span><span style="color: #BABED8"> xpsStream</span><span style="color: #89DDFF">;</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #89DDFF">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #C792EA">private</span><span style="color: #BABED8"> </span><span style="color: #C792EA">static</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">void</span><span style="color: #BABED8"> </span><span style="color: #82AAFF">SaveAsPdf</span><span style="color: #89DDFF">(</span><span style="color: #FFCB6B">MemoryStream</span><span style="color: #BABED8"> </span><span style="color: #FFCB6B">xpsStream</span><span style="color: #89DDFF">,</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">string</span><span style="color: #BABED8"> </span><span style="color: #FFCB6B">outputPdfPath</span><span style="color: #89DDFF">)</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #89DDFF">{</span></span>
<span class="line"><span style="color: #89DDFF; font-style: italic">        </span><span style="color: #464B5D; font-style: italic">// Load XPS stream into PdfDocument</span></span>
<span class="line"><span style="color: #BABED8">        </span><span style="color: #FFCB6B">var</span><span style="color: #BABED8"> </span><span style="color: #FFCB6B">pdfDoc</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">=</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">new</span><span style="color: #BABED8"> </span><span style="color: #FFCB6B">PdfDocument</span><span style="color: #89DDFF">();</span></span>
<span class="line"><span style="color: #BABED8">        pdfDoc</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">LoadFromXPS</span><span style="color: #89DDFF">(</span><span style="color: #BABED8">xpsStream</span><span style="color: #89DDFF">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #89DDFF; font-style: italic">        </span><span style="color: #464B5D; font-style: italic">// Set PDF page size to A4</span></span>
<span class="line"><span style="color: #BABED8">        pdfDoc</span><span style="color: #89DDFF">.</span><span style="color: #BABED8">PageSettings</span><span style="color: #89DDFF">.</span><span style="color: #BABED8">Size </span><span style="color: #89DDFF">=</span><span style="color: #BABED8"> PdfPageSize</span><span style="color: #89DDFF">.</span><span style="color: #BABED8">A4</span><span style="color: #89DDFF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #89DDFF; font-style: italic">        </span><span style="color: #464B5D; font-style: italic">// Save PdfDocument to PDF file</span></span>
<span class="line"><span style="color: #BABED8">        pdfDoc</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">SaveToFile</span><span style="color: #89DDFF">(</span><span style="color: #BABED8">outputPdfPath</span><span style="color: #89DDFF">);</span></span>
<span class="line"><span style="color: #BABED8">        pdfDoc</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">Close</span><span style="color: #89DDFF">();</span></span>
<span class="line"></span>
<span class="line"><span style="color: #89DDFF; font-style: italic">        </span><span style="color: #464B5D; font-style: italic">// Dispose the XPS stream</span></span>
<span class="line"><span style="color: #BABED8">        xpsStream</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">Dispose</span><span style="color: #89DDFF">();</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #89DDFF">}</span></span>
<span class="line"><span style="color: #89DDFF">}</span></span></code></pre></div>
</div>



<p></p>



<p>程式執行後，所產生的 PDF 檔內容，如下圖。</p>



<figure class="wp-block-image size-large"><img decoding="async" src="https://i.imgur.com/DL89AvH.png" alt=""/></figure>



<h2 class="wp-block-heading article_h2">總結</h2>



<p>在產生 PDF 這一塊，除了手動撰寫程式產生 PDF 排版與資料外，還有一些方法可以實現，例如，可以使用空白的 PDF 作為底稿，然後將需要的資料寫入其中，等等。</p>



<p>而直接使用 XAML 的 View ，再透過 Binding 來放入需要顯示的資料，最後透過 FreeSpire.PDF 套件轉存成 PDF。並且能 Binding 的話，表示不只文字，甚至圖片與集合都可以使用。如果遇到生成的 PDF 有語系的需求，也可以使用 DynamicResource 來切換，使用起來感覺方便不少。</p>



<p>此方法做出的 PDF 目前看起來沒有太大的問題，若是有遇到什麼問題，會再進行文章的更新。</p>



<p>而 UI 的部分，不一定要使用 FlowDocument 也可使用其他 UI 元件，只是再轉 XPS 的時候，則需要用另外的程式來實現。</p>
]]></content:encoded>
					
		
		
			</item>
	</channel>
</rss>
