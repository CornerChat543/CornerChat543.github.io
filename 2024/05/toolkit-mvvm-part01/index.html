<!DOCTYPE html>
<html lang="zh-TW">
<head>
	
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5, viewport-fit=cover">
	<link rel="profile" href="https://gmpg.org/xfn/11">

	<title>使用ToolKit.MVVM實現ViewModel &#8211; Part 1 &#8211; CornerChat543</title>
<meta name="robots" content="max-image-preview:large">
<link rel="alternate" type="application/rss+xml" title="訂閱《CornerChat543》&raquo; 資訊提供" href="https://cornerchat543.github.io/feed/">
<link rel="alternate" type="application/rss+xml" title="訂閱《CornerChat543》&raquo; 留言的資訊提供" href="https://cornerchat543.github.io/comments/feed/">
<link rel="stylesheet" id="blocksy-dynamic-global-css" href="https://cornerchat543.github.io/wp-content/uploads/blocksy/css/global.css?ver=20867" media="all">
<link rel="stylesheet" id="wp-block-library-css" href="https://cornerchat543.github.io/wp-includes/css/dist/block-library/style.min.css?ver=6.5.3" media="all">
<style id="kevinbatdorf-code-block-pro-style-inline-css">.wp-block-kevinbatdorf-code-block-pro{direction:ltr!important;font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;-webkit-text-size-adjust:100%!important;box-sizing:border-box!important;position:relative!important}.wp-block-kevinbatdorf-code-block-pro *{box-sizing:border-box!important}.wp-block-kevinbatdorf-code-block-pro pre,.wp-block-kevinbatdorf-code-block-pro pre *{font-size:inherit!important;line-height:inherit!important}.wp-block-kevinbatdorf-code-block-pro:not(.code-block-pro-editor) pre{background-image:none!important;border:0!important;border-radius:0!important;border-style:none!important;border-width:0!important;color:inherit!important;font-family:inherit!important;margin:0!important;overflow:auto!important;overflow-wrap:normal!important;padding:16px 0 16px 16px!important;text-align:left!important;white-space:pre!important;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;box-shadow:var(--tw-ring-offset-shadow,0 0 #0000),var(--tw-ring-shadow,0 0 #0000),var(--tw-shadow)!important}.wp-block-kevinbatdorf-code-block-pro.padding-disabled:not(.code-block-pro-editor) pre{padding:0!important}.wp-block-kevinbatdorf-code-block-pro.padding-bottom-disabled pre{padding-bottom:0!important}.wp-block-kevinbatdorf-code-block-pro:not(.code-block-pro-editor) pre code{background:none!important;background-color:transparent!important;border:0!important;border-radius:0!important;border-style:none!important;border-width:0!important;color:inherit!important;display:block!important;font-family:inherit!important;margin:0!important;overflow-wrap:normal!important;padding:0!important;text-align:left!important;white-space:pre!important;width:100%!important;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;box-shadow:var(--tw-ring-offset-shadow,0 0 #0000),var(--tw-ring-shadow,0 0 #0000),var(--tw-shadow)!important}.wp-block-kevinbatdorf-code-block-pro:not(.code-block-pro-editor) pre code .line{display:inline-block!important;min-width:var(--cbp-block-width,100%)!important;vertical-align:top!important}.wp-block-kevinbatdorf-code-block-pro.cbp-has-line-numbers:not(.code-block-pro-editor) pre code .line{padding-left:calc(12px + var(--cbp-line-number-width, auto))!important}.wp-block-kevinbatdorf-code-block-pro.cbp-has-line-numbers:not(.code-block-pro-editor) pre code{counter-increment:step calc(var(--cbp-line-number-start, 1) - 1)!important;counter-reset:step!important}.wp-block-kevinbatdorf-code-block-pro pre code .line{position:relative!important}.wp-block-kevinbatdorf-code-block-pro:not(.code-block-pro-editor) pre code .line:before{content:""!important;display:inline-block!important}.wp-block-kevinbatdorf-code-block-pro.cbp-has-line-numbers:not(.code-block-pro-editor) pre code .line:not(.cbp-line-number-disabled):before{color:var(--cbp-line-number-color,#999)!important;content:counter(step)!important;counter-increment:step!important;left:0!important;opacity:.5!important;position:absolute!important;text-align:right!important;transition-duration:.5s!important;transition-property:opacity!important;transition-timing-function:cubic-bezier(.4,0,.2,1)!important;-webkit-user-select:none!important;-moz-user-select:none!important;user-select:none!important;width:var(--cbp-line-number-width,auto)!important}.wp-block-kevinbatdorf-code-block-pro.cbp-highlight-hover .line{min-height:var(--cbp-block-height,100%)!important}.wp-block-kevinbatdorf-code-block-pro .line.cbp-line-highlight .cbp-line-highlighter,.wp-block-kevinbatdorf-code-block-pro .line.cbp-no-blur:hover .cbp-line-highlighter,.wp-block-kevinbatdorf-code-block-pro.cbp-highlight-hover:not(.cbp-blur-enabled:not(.cbp-unblur-on-hover)) .line:hover .cbp-line-highlighter{background:var(--cbp-line-highlight-color,rgb(14 165 233/.2))!important;left:-16px!important;min-height:var(--cbp-block-height,100%)!important;min-width:calc(var(--cbp-block-width, 100%) + 16px)!important;pointer-events:none!important;position:absolute!important;top:0!important;width:100%!important}[data-code-block-pro-font-family="Code-Pro-Comic-Mono.ttf"].wp-block-kevinbatdorf-code-block-pro .line.cbp-line-highlight .cbp-line-highlighter,[data-code-block-pro-font-family="Code-Pro-Comic-Mono.ttf"].wp-block-kevinbatdorf-code-block-pro .line.cbp-no-blur:hover .cbp-line-highlighter,[data-code-block-pro-font-family="Code-Pro-Comic-Mono.ttf"].wp-block-kevinbatdorf-code-block-pro.cbp-highlight-hover:not(.cbp-blur-enabled:not(.cbp-unblur-on-hover)) .line:hover .cbp-line-highlighter{top:-.125rem!important}[data-code-block-pro-font-family=Code-Pro-Fira-Code].wp-block-kevinbatdorf-code-block-pro .line.cbp-line-highlight .cbp-line-highlighter,[data-code-block-pro-font-family=Code-Pro-Fira-Code].wp-block-kevinbatdorf-code-block-pro .line.cbp-no-blur:hover .cbp-line-highlighter,[data-code-block-pro-font-family=Code-Pro-Fira-Code].wp-block-kevinbatdorf-code-block-pro.cbp-highlight-hover:not(.cbp-blur-enabled:not(.cbp-unblur-on-hover)) .line:hover .cbp-line-highlighter{top:-1.5px!important}[data-code-block-pro-font-family="Code-Pro-Deja-Vu-Mono.ttf"].wp-block-kevinbatdorf-code-block-pro .line.cbp-line-highlight .cbp-line-highlighter,[data-code-block-pro-font-family="Code-Pro-Deja-Vu-Mono.ttf"].wp-block-kevinbatdorf-code-block-pro .line.cbp-no-blur:hover .cbp-line-highlighter,[data-code-block-pro-font-family="Code-Pro-Deja-Vu-Mono.ttf"].wp-block-kevinbatdorf-code-block-pro.cbp-highlight-hover:not(.cbp-blur-enabled:not(.cbp-unblur-on-hover)) .line:hover .cbp-line-highlighter,[data-code-block-pro-font-family=Code-Pro-Cozette].wp-block-kevinbatdorf-code-block-pro .line.cbp-line-highlight .cbp-line-highlighter,[data-code-block-pro-font-family=Code-Pro-Cozette].wp-block-kevinbatdorf-code-block-pro .line.cbp-no-blur:hover .cbp-line-highlighter,[data-code-block-pro-font-family=Code-Pro-Cozette].wp-block-kevinbatdorf-code-block-pro.cbp-highlight-hover:not(.cbp-blur-enabled:not(.cbp-unblur-on-hover)) .line:hover .cbp-line-highlighter{top:-1px!important}.wp-block-kevinbatdorf-code-block-pro:not(.code-block-pro-editor).padding-disabled pre .line.cbp-line-highlight:after{left:0!important;width:100%!important}.wp-block-kevinbatdorf-code-block-pro.cbp-blur-enabled pre .line:not(.cbp-no-blur){filter:blur(1px)!important;opacity:.4!important;pointer-events:none!important;transition-duration:.2s!important;transition-property:all!important;transition-timing-function:cubic-bezier(.4,0,.2,1)!important}.wp-block-kevinbatdorf-code-block-pro.cbp-blur-enabled.cbp-unblur-on-hover:hover pre .line:not(.cbp-no-blur){opacity:1!important;pointer-events:auto!important;--tw-blur:blur(0);filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)!important}.wp-block-kevinbatdorf-code-block-pro:not(.code-block-pro-editor) pre *{font-family:inherit!important}.cbp-see-more-simple-btn-hover{transition-property:none!important}.cbp-see-more-simple-btn-hover:hover{box-shadow:inset 0 0 100px 100px hsla(0,0%,100%,.1)!important}.code-block-pro-copy-button{border:0!important;border-style:none!important;border-width:0!important;cursor:pointer!important;left:auto!important;line-height:1!important;opacity:.1!important;padding:6px!important;position:absolute!important;right:0!important;top:0!important;transition-duration:.2s!important;transition-property:opacity!important;transition-timing-function:cubic-bezier(.4,0,.2,1)!important;z-index:10!important}.code-block-pro-copy-button:focus{opacity:.4!important}.code-block-pro-copy-button:not([data-has-text-button]){background:none!important;background-color:transparent!important}.wp-block-kevinbatdorf-code-block-pro.padding-disabled .code-block-pro-copy-button{padding:0!important}.wp-block-kevinbatdorf-code-block-pro:hover .code-block-pro-copy-button{opacity:.5!important}.wp-block-kevinbatdorf-code-block-pro .code-block-pro-copy-button:hover{opacity:.9!important}.code-block-pro-copy-button[data-has-text-button],.wp-block-kevinbatdorf-code-block-pro:hover .code-block-pro-copy-button[data-has-text-button]{opacity:1!important}.wp-block-kevinbatdorf-code-block-pro .code-block-pro-copy-button[data-has-text-button]:hover{opacity:.8!important}.code-block-pro-copy-button[data-has-text-button]{border-radius:.75rem!important;display:block!important;margin-right:.75rem!important;margin-top:.7rem!important;padding:.125rem .375rem!important}.code-block-pro-copy-button[data-inside-header-type=headlightsMuted],.code-block-pro-copy-button[data-inside-header-type^=headlights]{margin-top:.85rem!important}.code-block-pro-copy-button[data-inside-header-type=headlightsMutedAlt]{margin-top:.65rem!important}.code-block-pro-copy-button[data-inside-header-type=simpleString]{margin-top:.645rem!important}.code-block-pro-copy-button[data-inside-header-type=pillString]{margin-top:1rem!important}.code-block-pro-copy-button[data-inside-header-type=pillString] .cbp-btn-text{position:relative!important;top:1px!important}.cbp-btn-text{font-size:.75rem!important;line-height:1rem!important}.code-block-pro-copy-button .without-check{display:block!important}.code-block-pro-copy-button .with-check{display:none!important}.code-block-pro-copy-button.cbp-copying{opacity:1!important}.code-block-pro-copy-button.cbp-copying .without-check{display:none!important}.code-block-pro-copy-button.cbp-copying .with-check{display:block!important}.cbp-footer-link:hover{text-decoration-line:underline!important}@media print{.wp-block-kevinbatdorf-code-block-pro pre{max-height:none!important}.wp-block-kevinbatdorf-code-block-pro:not(#x) .line:before{background-color:transparent!important;color:inherit!important}.wp-block-kevinbatdorf-code-block-pro:not(#x) .cbp-line-highlighter,.wp-block-kevinbatdorf-code-block-pro:not(#x)>span{display:none!important}}</style>
<style id="global-styles-inline-css">body{--wp--preset--color--black: #000000;--wp--preset--color--cyan-bluish-gray: #abb8c3;--wp--preset--color--white: #ffffff;--wp--preset--color--pale-pink: #f78da7;--wp--preset--color--vivid-red: #cf2e2e;--wp--preset--color--luminous-vivid-orange: #ff6900;--wp--preset--color--luminous-vivid-amber: #fcb900;--wp--preset--color--light-green-cyan: #7bdcb5;--wp--preset--color--vivid-green-cyan: #00d084;--wp--preset--color--pale-cyan-blue: #8ed1fc;--wp--preset--color--vivid-cyan-blue: #0693e3;--wp--preset--color--vivid-purple: #9b51e0;--wp--preset--color--palette-color-1: var(--theme-palette-color-1, #3EA6FF);--wp--preset--color--palette-color-2: var(--theme-palette-color-2, #3EA6FF);--wp--preset--color--palette-color-3: var(--theme-palette-color-3, #1E1E1E);--wp--preset--color--palette-color-4: var(--theme-palette-color-4, #313131);--wp--preset--color--palette-color-5: var(--theme-palette-color-5, #e1e8ed);--wp--preset--color--palette-color-6: var(--theme-palette-color-6, #f2f5f7);--wp--preset--color--palette-color-7: var(--theme-palette-color-7, #FAFBFC);--wp--preset--color--palette-color-8: var(--theme-palette-color-8, #ffffff);--wp--preset--color--palette-color-9: var(--theme-palette-color-9, rgba(255, 255, 255, 0.2));--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple: linear-gradient(135deg,rgba(6,147,227,1) 0%,rgb(155,81,224) 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan: linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange: linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red: linear-gradient(135deg,rgba(255,105,0,1) 0%,rgb(207,46,46) 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray: linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);--wp--preset--gradient--cool-to-warm-spectrum: linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);--wp--preset--gradient--blush-light-purple: linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);--wp--preset--gradient--blush-bordeaux: linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);--wp--preset--gradient--luminous-dusk: linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);--wp--preset--gradient--pale-ocean: linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);--wp--preset--gradient--electric-grass: linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);--wp--preset--gradient--midnight: linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);--wp--preset--gradient--juicy-peach: linear-gradient(to right, #ffecd2 0%, #fcb69f 100%);--wp--preset--gradient--young-passion: linear-gradient(to right, #ff8177 0%, #ff867a 0%, #ff8c7f 21%, #f99185 52%, #cf556c 78%, #b12a5b 100%);--wp--preset--gradient--true-sunset: linear-gradient(to right, #fa709a 0%, #fee140 100%);--wp--preset--gradient--morpheus-den: linear-gradient(to top, #30cfd0 0%, #330867 100%);--wp--preset--gradient--plum-plate: linear-gradient(135deg, #667eea 0%, #764ba2 100%);--wp--preset--gradient--aqua-splash: linear-gradient(15deg, #13547a 0%, #80d0c7 100%);--wp--preset--gradient--love-kiss: linear-gradient(to top, #ff0844 0%, #ffb199 100%);--wp--preset--gradient--new-retrowave: linear-gradient(to top, #3b41c5 0%, #a981bb 49%, #ffc8a9 100%);--wp--preset--gradient--plum-bath: linear-gradient(to top, #cc208e 0%, #6713d2 100%);--wp--preset--gradient--high-flight: linear-gradient(to right, #0acffe 0%, #495aff 100%);--wp--preset--gradient--teen-party: linear-gradient(-225deg, #FF057C 0%, #8D0B93 50%, #321575 100%);--wp--preset--gradient--fabled-sunset: linear-gradient(-225deg, #231557 0%, #44107A 29%, #FF1361 67%, #FFF800 100%);--wp--preset--gradient--arielle-smile: radial-gradient(circle 248px at center, #16d9e3 0%, #30c7ec 47%, #46aef7 100%);--wp--preset--gradient--itmeo-branding: linear-gradient(180deg, #2af598 0%, #009efd 100%);--wp--preset--gradient--deep-blue: linear-gradient(to right, #6a11cb 0%, #2575fc 100%);--wp--preset--gradient--strong-bliss: linear-gradient(to right, #f78ca0 0%, #f9748f 19%, #fd868c 60%, #fe9a8b 100%);--wp--preset--gradient--sweet-period: linear-gradient(to top, #3f51b1 0%, #5a55ae 13%, #7b5fac 25%, #8f6aae 38%, #a86aa4 50%, #cc6b8e 62%, #f18271 75%, #f3a469 87%, #f7c978 100%);--wp--preset--gradient--purple-division: linear-gradient(to top, #7028e4 0%, #e5b2ca 100%);--wp--preset--gradient--cold-evening: linear-gradient(to top, #0c3483 0%, #a2b6df 100%, #6b8cce 100%, #a2b6df 100%);--wp--preset--gradient--mountain-rock: linear-gradient(to right, #868f96 0%, #596164 100%);--wp--preset--gradient--desert-hump: linear-gradient(to top, #c79081 0%, #dfa579 100%);--wp--preset--gradient--ethernal-constance: linear-gradient(to top, #09203f 0%, #537895 100%);--wp--preset--gradient--happy-memories: linear-gradient(-60deg, #ff5858 0%, #f09819 100%);--wp--preset--gradient--grown-early: linear-gradient(to top, #0ba360 0%, #3cba92 100%);--wp--preset--gradient--morning-salad: linear-gradient(-225deg, #B7F8DB 0%, #50A7C2 100%);--wp--preset--gradient--night-call: linear-gradient(-225deg, #AC32E4 0%, #7918F2 48%, #4801FF 100%);--wp--preset--gradient--mind-crawl: linear-gradient(-225deg, #473B7B 0%, #3584A7 51%, #30D2BE 100%);--wp--preset--gradient--angel-care: linear-gradient(-225deg, #FFE29F 0%, #FFA99F 48%, #FF719A 100%);--wp--preset--gradient--juicy-cake: linear-gradient(to top, #e14fad 0%, #f9d423 100%);--wp--preset--gradient--rich-metal: linear-gradient(to right, #d7d2cc 0%, #304352 100%);--wp--preset--gradient--mole-hall: linear-gradient(-20deg, #616161 0%, #9bc5c3 100%);--wp--preset--gradient--cloudy-knoxville: linear-gradient(120deg, #fdfbfb 0%, #ebedee 100%);--wp--preset--gradient--soft-grass: linear-gradient(to top, #c1dfc4 0%, #deecdd 100%);--wp--preset--gradient--saint-petersburg: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);--wp--preset--gradient--everlasting-sky: linear-gradient(135deg, #fdfcfb 0%, #e2d1c3 100%);--wp--preset--gradient--kind-steel: linear-gradient(-20deg, #e9defa 0%, #fbfcdb 100%);--wp--preset--gradient--over-sun: linear-gradient(60deg, #abecd6 0%, #fbed96 100%);--wp--preset--gradient--premium-white: linear-gradient(to top, #d5d4d0 0%, #d5d4d0 1%, #eeeeec 31%, #efeeec 75%, #e9e9e7 100%);--wp--preset--gradient--clean-mirror: linear-gradient(45deg, #93a5cf 0%, #e4efe9 100%);--wp--preset--gradient--wild-apple: linear-gradient(to top, #d299c2 0%, #fef9d7 100%);--wp--preset--gradient--snow-again: linear-gradient(to top, #e6e9f0 0%, #eef1f5 100%);--wp--preset--gradient--confident-cloud: linear-gradient(to top, #dad4ec 0%, #dad4ec 1%, #f3e7e9 100%);--wp--preset--gradient--glass-water: linear-gradient(to top, #dfe9f3 0%, white 100%);--wp--preset--gradient--perfect-white: linear-gradient(-225deg, #E3FDF5 0%, #FFE6FA 100%);--wp--preset--font-size--small: 13px;--wp--preset--font-size--medium: 20px;--wp--preset--font-size--large: clamp(22px, 1.375rem + ((1vw - 3.2px) * 0.625), 30px);--wp--preset--font-size--x-large: clamp(30px, 1.875rem + ((1vw - 3.2px) * 1.563), 50px);--wp--preset--font-size--xx-large: clamp(45px, 2.813rem + ((1vw - 3.2px) * 2.734), 80px);--wp--preset--spacing--20: 0.44rem;--wp--preset--spacing--30: 0.67rem;--wp--preset--spacing--40: 1rem;--wp--preset--spacing--50: 1.5rem;--wp--preset--spacing--60: 2.25rem;--wp--preset--spacing--70: 3.38rem;--wp--preset--spacing--80: 5.06rem;--wp--preset--shadow--natural: 6px 6px 9px rgba(0, 0, 0, 0.2);--wp--preset--shadow--deep: 12px 12px 50px rgba(0, 0, 0, 0.4);--wp--preset--shadow--sharp: 6px 6px 0px rgba(0, 0, 0, 0.2);--wp--preset--shadow--outlined: 6px 6px 0px -3px rgba(255, 255, 255, 1), 6px 6px rgba(0, 0, 0, 1);--wp--preset--shadow--crisp: 6px 6px 0px rgba(0, 0, 0, 1);}body { margin: 0;--wp--style--global--content-size: var(--theme-block-max-width);--wp--style--global--wide-size: var(--theme-block-wide-max-width); }.wp-site-blocks > .alignleft { float: left; margin-right: 2em; }.wp-site-blocks > .alignright { float: right; margin-left: 2em; }.wp-site-blocks > .aligncenter { justify-content: center; margin-left: auto; margin-right: auto; }:where(.wp-site-blocks) > * { margin-block-start: var(--theme-content-spacing); margin-block-end: 0; }:where(.wp-site-blocks) > :first-child:first-child { margin-block-start: 0; }:where(.wp-site-blocks) > :last-child:last-child { margin-block-end: 0; }body { --wp--style--block-gap: var(--theme-content-spacing); }:where(body .is-layout-flow)  > :first-child:first-child{margin-block-start: 0;}:where(body .is-layout-flow)  > :last-child:last-child{margin-block-end: 0;}:where(body .is-layout-flow)  > *{margin-block-start: var(--theme-content-spacing);margin-block-end: 0;}:where(body .is-layout-constrained)  > :first-child:first-child{margin-block-start: 0;}:where(body .is-layout-constrained)  > :last-child:last-child{margin-block-end: 0;}:where(body .is-layout-constrained)  > *{margin-block-start: var(--theme-content-spacing);margin-block-end: 0;}:where(body .is-layout-flex) {gap: var(--theme-content-spacing);}:where(body .is-layout-grid) {gap: var(--theme-content-spacing);}body .is-layout-flow > .alignleft{float: left;margin-inline-start: 0;margin-inline-end: 2em;}body .is-layout-flow > .alignright{float: right;margin-inline-start: 2em;margin-inline-end: 0;}body .is-layout-flow > .aligncenter{margin-left: auto !important;margin-right: auto !important;}body .is-layout-constrained > .alignleft{float: left;margin-inline-start: 0;margin-inline-end: 2em;}body .is-layout-constrained > .alignright{float: right;margin-inline-start: 2em;margin-inline-end: 0;}body .is-layout-constrained > .aligncenter{margin-left: auto !important;margin-right: auto !important;}body .is-layout-constrained > :where(:not(.alignleft):not(.alignright):not(.alignfull)){max-width: var(--wp--style--global--content-size);margin-left: auto !important;margin-right: auto !important;}body .is-layout-constrained > .alignwide{max-width: var(--wp--style--global--wide-size);}body .is-layout-flex{display: flex;}body .is-layout-flex{flex-wrap: wrap;align-items: center;}body .is-layout-flex > *{margin: 0;}body .is-layout-grid{display: grid;}body .is-layout-grid > *{margin: 0;}body{padding-top: 0px;padding-right: 0px;padding-bottom: 0px;padding-left: 0px;}.has-black-color{color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-color{color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-color{color: var(--wp--preset--color--white) !important;}.has-pale-pink-color{color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-color{color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-color{color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-color{color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-color{color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-color{color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-color{color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-color{color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-color{color: var(--wp--preset--color--vivid-purple) !important;}.has-palette-color-1-color{color: var(--wp--preset--color--palette-color-1) !important;}.has-palette-color-2-color{color: var(--wp--preset--color--palette-color-2) !important;}.has-palette-color-3-color{color: var(--wp--preset--color--palette-color-3) !important;}.has-palette-color-4-color{color: var(--wp--preset--color--palette-color-4) !important;}.has-palette-color-5-color{color: var(--wp--preset--color--palette-color-5) !important;}.has-palette-color-6-color{color: var(--wp--preset--color--palette-color-6) !important;}.has-palette-color-7-color{color: var(--wp--preset--color--palette-color-7) !important;}.has-palette-color-8-color{color: var(--wp--preset--color--palette-color-8) !important;}.has-palette-color-9-color{color: var(--wp--preset--color--palette-color-9) !important;}.has-black-background-color{background-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-background-color{background-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-background-color{background-color: var(--wp--preset--color--white) !important;}.has-pale-pink-background-color{background-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-background-color{background-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-background-color{background-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-background-color{background-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-background-color{background-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-background-color{background-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-background-color{background-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-background-color{background-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-background-color{background-color: var(--wp--preset--color--vivid-purple) !important;}.has-palette-color-1-background-color{background-color: var(--wp--preset--color--palette-color-1) !important;}.has-palette-color-2-background-color{background-color: var(--wp--preset--color--palette-color-2) !important;}.has-palette-color-3-background-color{background-color: var(--wp--preset--color--palette-color-3) !important;}.has-palette-color-4-background-color{background-color: var(--wp--preset--color--palette-color-4) !important;}.has-palette-color-5-background-color{background-color: var(--wp--preset--color--palette-color-5) !important;}.has-palette-color-6-background-color{background-color: var(--wp--preset--color--palette-color-6) !important;}.has-palette-color-7-background-color{background-color: var(--wp--preset--color--palette-color-7) !important;}.has-palette-color-8-background-color{background-color: var(--wp--preset--color--palette-color-8) !important;}.has-palette-color-9-background-color{background-color: var(--wp--preset--color--palette-color-9) !important;}.has-black-border-color{border-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-border-color{border-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-border-color{border-color: var(--wp--preset--color--white) !important;}.has-pale-pink-border-color{border-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-border-color{border-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-border-color{border-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-border-color{border-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-border-color{border-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-border-color{border-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-border-color{border-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-border-color{border-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-border-color{border-color: var(--wp--preset--color--vivid-purple) !important;}.has-palette-color-1-border-color{border-color: var(--wp--preset--color--palette-color-1) !important;}.has-palette-color-2-border-color{border-color: var(--wp--preset--color--palette-color-2) !important;}.has-palette-color-3-border-color{border-color: var(--wp--preset--color--palette-color-3) !important;}.has-palette-color-4-border-color{border-color: var(--wp--preset--color--palette-color-4) !important;}.has-palette-color-5-border-color{border-color: var(--wp--preset--color--palette-color-5) !important;}.has-palette-color-6-border-color{border-color: var(--wp--preset--color--palette-color-6) !important;}.has-palette-color-7-border-color{border-color: var(--wp--preset--color--palette-color-7) !important;}.has-palette-color-8-border-color{border-color: var(--wp--preset--color--palette-color-8) !important;}.has-palette-color-9-border-color{border-color: var(--wp--preset--color--palette-color-9) !important;}.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background: var(--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple) !important;}.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background: var(--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan) !important;}.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange) !important;}.has-luminous-vivid-orange-to-vivid-red-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-orange-to-vivid-red) !important;}.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background: var(--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray) !important;}.has-cool-to-warm-spectrum-gradient-background{background: var(--wp--preset--gradient--cool-to-warm-spectrum) !important;}.has-blush-light-purple-gradient-background{background: var(--wp--preset--gradient--blush-light-purple) !important;}.has-blush-bordeaux-gradient-background{background: var(--wp--preset--gradient--blush-bordeaux) !important;}.has-luminous-dusk-gradient-background{background: var(--wp--preset--gradient--luminous-dusk) !important;}.has-pale-ocean-gradient-background{background: var(--wp--preset--gradient--pale-ocean) !important;}.has-electric-grass-gradient-background{background: var(--wp--preset--gradient--electric-grass) !important;}.has-midnight-gradient-background{background: var(--wp--preset--gradient--midnight) !important;}.has-juicy-peach-gradient-background{background: var(--wp--preset--gradient--juicy-peach) !important;}.has-young-passion-gradient-background{background: var(--wp--preset--gradient--young-passion) !important;}.has-true-sunset-gradient-background{background: var(--wp--preset--gradient--true-sunset) !important;}.has-morpheus-den-gradient-background{background: var(--wp--preset--gradient--morpheus-den) !important;}.has-plum-plate-gradient-background{background: var(--wp--preset--gradient--plum-plate) !important;}.has-aqua-splash-gradient-background{background: var(--wp--preset--gradient--aqua-splash) !important;}.has-love-kiss-gradient-background{background: var(--wp--preset--gradient--love-kiss) !important;}.has-new-retrowave-gradient-background{background: var(--wp--preset--gradient--new-retrowave) !important;}.has-plum-bath-gradient-background{background: var(--wp--preset--gradient--plum-bath) !important;}.has-high-flight-gradient-background{background: var(--wp--preset--gradient--high-flight) !important;}.has-teen-party-gradient-background{background: var(--wp--preset--gradient--teen-party) !important;}.has-fabled-sunset-gradient-background{background: var(--wp--preset--gradient--fabled-sunset) !important;}.has-arielle-smile-gradient-background{background: var(--wp--preset--gradient--arielle-smile) !important;}.has-itmeo-branding-gradient-background{background: var(--wp--preset--gradient--itmeo-branding) !important;}.has-deep-blue-gradient-background{background: var(--wp--preset--gradient--deep-blue) !important;}.has-strong-bliss-gradient-background{background: var(--wp--preset--gradient--strong-bliss) !important;}.has-sweet-period-gradient-background{background: var(--wp--preset--gradient--sweet-period) !important;}.has-purple-division-gradient-background{background: var(--wp--preset--gradient--purple-division) !important;}.has-cold-evening-gradient-background{background: var(--wp--preset--gradient--cold-evening) !important;}.has-mountain-rock-gradient-background{background: var(--wp--preset--gradient--mountain-rock) !important;}.has-desert-hump-gradient-background{background: var(--wp--preset--gradient--desert-hump) !important;}.has-ethernal-constance-gradient-background{background: var(--wp--preset--gradient--ethernal-constance) !important;}.has-happy-memories-gradient-background{background: var(--wp--preset--gradient--happy-memories) !important;}.has-grown-early-gradient-background{background: var(--wp--preset--gradient--grown-early) !important;}.has-morning-salad-gradient-background{background: var(--wp--preset--gradient--morning-salad) !important;}.has-night-call-gradient-background{background: var(--wp--preset--gradient--night-call) !important;}.has-mind-crawl-gradient-background{background: var(--wp--preset--gradient--mind-crawl) !important;}.has-angel-care-gradient-background{background: var(--wp--preset--gradient--angel-care) !important;}.has-juicy-cake-gradient-background{background: var(--wp--preset--gradient--juicy-cake) !important;}.has-rich-metal-gradient-background{background: var(--wp--preset--gradient--rich-metal) !important;}.has-mole-hall-gradient-background{background: var(--wp--preset--gradient--mole-hall) !important;}.has-cloudy-knoxville-gradient-background{background: var(--wp--preset--gradient--cloudy-knoxville) !important;}.has-soft-grass-gradient-background{background: var(--wp--preset--gradient--soft-grass) !important;}.has-saint-petersburg-gradient-background{background: var(--wp--preset--gradient--saint-petersburg) !important;}.has-everlasting-sky-gradient-background{background: var(--wp--preset--gradient--everlasting-sky) !important;}.has-kind-steel-gradient-background{background: var(--wp--preset--gradient--kind-steel) !important;}.has-over-sun-gradient-background{background: var(--wp--preset--gradient--over-sun) !important;}.has-premium-white-gradient-background{background: var(--wp--preset--gradient--premium-white) !important;}.has-clean-mirror-gradient-background{background: var(--wp--preset--gradient--clean-mirror) !important;}.has-wild-apple-gradient-background{background: var(--wp--preset--gradient--wild-apple) !important;}.has-snow-again-gradient-background{background: var(--wp--preset--gradient--snow-again) !important;}.has-confident-cloud-gradient-background{background: var(--wp--preset--gradient--confident-cloud) !important;}.has-glass-water-gradient-background{background: var(--wp--preset--gradient--glass-water) !important;}.has-perfect-white-gradient-background{background: var(--wp--preset--gradient--perfect-white) !important;}.has-small-font-size{font-size: var(--wp--preset--font-size--small) !important;}.has-medium-font-size{font-size: var(--wp--preset--font-size--medium) !important;}.has-large-font-size{font-size: var(--wp--preset--font-size--large) !important;}.has-x-large-font-size{font-size: var(--wp--preset--font-size--x-large) !important;}.has-xx-large-font-size{font-size: var(--wp--preset--font-size--xx-large) !important;}
.wp-block-navigation a:where(:not(.wp-element-button)){color: inherit;}
.wp-block-pullquote{font-size: clamp(0.984em, 0.984rem + ((1vw - 0.2em) * 0.645), 1.5em);line-height: 1.6;}</style>
<link rel="stylesheet" id="ez-toc-css" href="https://cornerchat543.github.io/wp-content/plugins/easy-table-of-contents/assets/css/screen.min.css?ver=2.0.66.1" media="all">
<style id="ez-toc-inline-css">div#ez-toc-container .ez-toc-title {font-size: 120%;}div#ez-toc-container .ez-toc-title {font-weight: 500;}div#ez-toc-container ul li {font-size: 95%;}div#ez-toc-container ul li {font-weight: 500;}div#ez-toc-container nav ul ul li {font-size: 90%;}div#ez-toc-container {background: #0f111a;border: 1px solid #6b6666;}div#ez-toc-container p.ez-toc-title , #ez-toc-container .ez_toc_custom_title_icon , #ez-toc-container .ez_toc_custom_toc_icon {color: #ffffff;}div#ez-toc-container ul.ez-toc-list a {color: #ffffff;}div#ez-toc-container ul.ez-toc-list a:hover {color: #ffffff;}div#ez-toc-container ul.ez-toc-list a:visited {color: #ffffff;}
.ez-toc-container-direction {direction: ltr;}.ez-toc-counter ul{counter-reset: item ;}.ez-toc-counter nav ul li a::before {content: counters(item, ".", decimal) ". ";display: inline-block;counter-increment: item;flex-grow: 0;flex-shrink: 0;margin-right: .2em; float: left; }.ez-toc-widget-direction {direction: ltr;}.ez-toc-widget-container ul{counter-reset: item ;}.ez-toc-widget-container nav ul li a::before {content: counters(item, ".", decimal) ". ";display: inline-block;counter-increment: item;flex-grow: 0;flex-shrink: 0;margin-right: .2em; float: left; }</style>
<link rel="stylesheet" id="ct-main-styles-css" href="https://cornerchat543.github.io/wp-content/themes/blocksy/static/bundle/main.min.css?ver=2.0.48" media="all">
<link rel="stylesheet" id="ct-page-title-styles-css" href="https://cornerchat543.github.io/wp-content/themes/blocksy/static/bundle/page-title.min.css?ver=2.0.48" media="all">
<link rel="stylesheet" id="ct-sidebar-styles-css" href="https://cornerchat543.github.io/wp-content/themes/blocksy/static/bundle/sidebar.min.css?ver=2.0.48" media="all">
<link rel="stylesheet" id="ct-posts-nav-styles-css" href="https://cornerchat543.github.io/wp-content/themes/blocksy/static/bundle/posts-nav.min.css?ver=2.0.48" media="all">
<script src="https://cornerchat543.github.io/wp-includes/js/jquery/jquery.min.js?ver=3.7.1" id="jquery-core-js"></script>
<script src="https://cornerchat543.github.io/wp-includes/js/jquery/jquery-migrate.min.js?ver=3.4.1" id="jquery-migrate-js"></script>
<link rel="https://api.w.org/" href="https://cornerchat543.github.io/wp-json/">
<link rel="alternate" type="application/json" href="https://cornerchat543.github.io/wp-json/wp/v2/posts/154">
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://cornerchat543.github.io/xmlrpc.php?rsd">
<meta name="generator" content="WordPress 6.5.3">
<link rel="canonical" href="https://cornerchat543.github.io/2024/05/toolkit-mvvm-part01/">
<link rel="shortlink" href="https://cornerchat543.github.io/?p=154">
<link rel="alternate" type="application/json+oembed" href="https://cornerchat543.github.io/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fcornerchat543.github.io%2F2024%2F05%2Ftoolkit-mvvm-part01%2F">
<link rel="alternate" type="text/xml+oembed" href="https://cornerchat543.github.io/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fcornerchat543.github.io%2F2024%2F05%2Ftoolkit-mvvm-part01%2F#038;format=xml">
<link rel="preconnect" href="https://i0.wp.com/" crossorigin>
<link rel="dns-prefetch" href="https://i0.wp.com/">
<link rel="preconnect" href="https://i1.wp.com/" crossorigin>
<link rel="dns-prefetch" href="https://i1.wp.com/">
<link rel="preconnect" href="https://i2.wp.com/" crossorigin>
<link rel="dns-prefetch" href="https://i2.wp.com/">
<link rel="preconnect" href="https://i3.wp.com/" crossorigin>
<link rel="dns-prefetch" href="https://i3.wp.com/">
<!-- FIFU: meta tags for featured image (begin) -->
<meta property="og:image" content="https://i2.wp.com/res.cloudinary.com/glide/image/fetch/https%3A%2F%2Fi.imgur.com%2FdNjQeay.png?ssl=1">
<!-- FIFU: meta tags for featured image (end) --><meta property="og:title" content="使用ToolKit.MVVM實現ViewModel &#8211; Part 1">
<meta property="og:description">

<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:title" content="使用ToolKit.MVVM實現ViewModel &#8211; Part 1">
<meta name="twitter:description">
<meta name="twitter:image" content="https://i2.wp.com/res.cloudinary.com/glide/image/fetch/https%3A%2F%2Fi.imgur.com%2FdNjQeay.png?ssl=1">
<noscript><link rel="stylesheet" href="https://cornerchat543.github.io/wp-content/themes/blocksy/static/bundle/no-scripts.min.css" type="text/css"></noscript>
<link rel="icon" href="https://cornerchat543.github.io/wp-content/uploads/2024/05/Logo_v2.jpg" sizes="32x32">
<link rel="icon" href="https://cornerchat543.github.io/wp-content/uploads/2024/05/Logo_v2.jpg" sizes="192x192">
<link rel="apple-touch-icon" href="https://cornerchat543.github.io/wp-content/uploads/2024/05/Logo_v2.jpg">
<meta name="msapplication-TileImage" content="https://cornerchat543.github.io/wp-content/uploads/2024/05/Logo_v2.jpg">
		<style id="wp-custom-css">/* h2 */
.article_h2
{  background: rgba(255, 255, 255, 0.1);
   border-left: 5px solid rgb(30, 30, 250);
   padding: 2px 0px 2px 20px;
}</style>
			</head>


<body class="post-template-default single single-post postid-154 single-format-standard wp-embed-responsive" data-link="type-2" data-prefix="single_blog_post" data-header="type-1" data-footer="type-1" itemscope="itemscope" itemtype="https://schema.org/Blog">

<a class="skip-link show-on-focus" href="#main">
	跳至主要內容</a>

<div class="ct-drawer-canvas" data-location="start">
<div id="offcanvas" class="ct-panel ct-header" data-behaviour="right-side"><div class="ct-panel-inner">
		<div class="ct-panel-actions">
			
			<button class="ct-toggle-close" data-type="type-1" aria-label="關閉側選單">
				<svg class="ct-icon" width="12" height="12" viewbox="0 0 15 15"><path d="M1 15a1 1 0 01-.71-.29 1 1 0 010-1.41l5.8-5.8-5.8-5.8A1 1 0 011.7.29l5.8 5.8 5.8-5.8a1 1 0 011.41 1.41l-5.8 5.8 5.8 5.8a1 1 0 01-1.41 1.41l-5.8-5.8-5.8 5.8A1 1 0 011 15z"></path></svg>
			</button>
		</div>
		<div class="ct-panel-content" data-device="desktop"><div class="ct-panel-content-inner"></div></div>
<div class="ct-panel-content" data-device="mobile"><div class="ct-panel-content-inner">
<nav class="mobile-menu" data-id="mobile-menu" data-interaction="click" data-toggle-type="type-1" data-submenu-dots="yes" aria-label="滑出選單">
	<ul><li class="page_item page-item-53"><a href="https://cornerchat543.github.io/about/" class="ct-menu-link">關於我</a></li></ul></nav>

</div></div>
</div></div>
	<a href="#main-container" class="ct-back-to-top ct-hidden-sm" data-shape="circle" data-alignment="right" title="到最上面" aria-label="到最上面" hidden>

		<svg class="ct-icon" width="15" height="15" viewbox="0 0 20 20"><path d="M18.1,9.4c-0.2,0.4-0.5,0.6-0.9,0.6h-3.7c0,0-0.6,8.7-0.9,9.1C12.2,19.6,11.1,20,10,20c-1,0-2.3-0.3-2.7-0.9C7,18.7,6.5,10,6.5,10H2.8c-0.4,0-0.7-0.2-1-0.6C1.7,9,1.7,8.6,1.9,8.3c2.8-4.1,7.2-8,7.4-8.1C9.5,0.1,9.8,0,10,0s0.5,0.1,0.6,0.2c0.2,0.1,4.6,3.9,7.4,8.1C18.2,8.7,18.3,9.1,18.1,9.4z"></path></svg>	</a>

	</div>
<div id="main-container">
	<header id="header" class="ct-header" data-id="type-1" itemscope="" itemtype="https://schema.org/WPHeader"><div data-device="desktop"><div data-row="middle" data-column-set="3"><div class="ct-container">
<div data-column="start" data-placements="1"><div data-items="primary">
<div class="site-branding" data-id="logo" itemscope="itemscope" itemtype="https://schema.org/Organization">

	
			<div class="site-title-container">
							<span class="site-title " itemprop="name">
					<a href="https://cornerchat543.github.io/" rel="home" itemprop="url">
						CornerChat543					</a>
				</span>
			
							<p class="site-description " itemprop="description">
									</p>
					</div>
	  </div>

</div></div>
<div data-column="middle"><div data-items="">
<nav id="header-menu-1" class="header-menu-1" data-id="menu" data-interaction="hover" data-menu="type-1" data-dropdown="type-1:simple" data-responsive="no" itemscope="" itemtype="https://schema.org/SiteNavigationElement" aria-label="頁首選單">

	<ul id="menu-%e4%b8%bb%e9%81%b8%e5%96%ae" class="menu" role="menubar">
<li id="menu-item-64" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-64" role="none"><a href="https://cornerchat543.github.io/" class="ct-menu-link" role="menuitem">首頁</a></li>
<li id="menu-item-155" class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-155" role="none"><a href="https://cornerchat543.github.io/category/c_sharp/" class="ct-menu-link" role="menuitem">C#</a></li>
<li id="menu-item-65" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-65" role="none"><a href="https://cornerchat543.github.io/category/github-pages/" class="ct-menu-link" role="menuitem">Github Pages</a></li>
<li id="menu-item-54" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-54" role="none"><a href="https://cornerchat543.github.io/about/" class="ct-menu-link" role="menuitem">關於我</a></li>
</ul></nav>

</div></div>
<div data-column="end"></div>
</div></div></div>
<div data-device="mobile"><div data-row="middle" data-column-set="2"><div class="ct-container">
<div data-column="start" data-placements="1"><div data-items="primary">
<div class="site-branding" data-id="logo">

	
			<div class="site-title-container">
							<span class="site-title ">
					<a href="https://cornerchat543.github.io/" rel="home">
						CornerChat543					</a>
				</span>
			
							<p class="site-description ">
									</p>
					</div>
	  </div>

</div></div>
<div data-column="end" data-placements="1"><div data-items="primary">
<button data-toggle-panel="#offcanvas" class="ct-header-trigger ct-toggle " data-design="simple" data-label="right" aria-label="選單" data-id="trigger">

	<span class="ct-label ct-hidden-sm ct-hidden-md ct-hidden-lg">選單</span>

	<svg class="ct-icon" width="18" height="14" viewbox="0 0 18 14" aria-hidden="true" data-type="type-1">

		<rect y="0.00" width="18" height="1.7" rx="1"></rect>
		<rect y="6.15" width="18" height="1.7" rx="1"></rect>
		<rect y="12.3" width="18" height="1.7" rx="1"></rect>
	</svg>
</button>
</div></div>
</div></div></div></header>
	<main id="main" class="site-main hfeed" itemscope="itemscope" itemtype="https://schema.org/CreativeWork">

		
	<div class="ct-container" data-sidebar="right" data-vertical-spacing="top:bottom">

		
		
	<article id="post-154" class="post-154 post type-post status-publish format-standard has-post-thumbnail hentry category-c_sharp tag-net tag-c tag-mvvm tag-nuget tag-toolkit-mvvm tag-wpf">

		
<div class="hero-section" data-type="type-1">
			<header class="entry-header">
			
			<nav class="ct-breadcrumbs" data-source="default" itemscope="" itemtype="https://schema.org/BreadcrumbList"><span class="first-item" itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem"><meta itemprop="position" content="1">
<a href="https://cornerchat543.github.io/" itemprop="item"><svg class="ct-home-icon" width="15" viewbox="0 0 24 20" fill="currentColor" aria-hidden="true" focusable="false"><path d="M12,0L0.4,10.5h3.2V20h6.3v-6.3h4.2V20h6.3v-9.5h3.2L12,0z"></path></svg><span itemprop="name" class="screen-reader-text">首頁</span></a><meta itemprop="url" content="https://cornerchat543.github.io/">
<svg class="separator" fill="currentColor" width="8" height="8" viewbox="0 0 8 8" aria-hidden="true" focusable="false">
				<path d="M2,6.9L4.8,4L2,1.1L2.6,0l4,4l-4,4L2,6.9z"></path>
			</svg></span><span class="item-0" itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem"><meta itemprop="position" content="2">
<a href="https://cornerchat543.github.io/category/c_sharp/" itemprop="item"><span itemprop="name">C#</span></a><meta itemprop="url" content="https://cornerchat543.github.io/category/c_sharp/">
<svg class="separator" fill="currentColor" width="8" height="8" viewbox="0 0 8 8" aria-hidden="true" focusable="false">
				<path d="M2,6.9L4.8,4L2,1.1L2.6,0l4,4l-4,4L2,6.9z"></path>
			</svg></span><span class="last-item" aria-current="page" itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem"><meta itemprop="position" content="3">
<span itemprop="name">使用ToolKit.MVVM實現ViewModel - Part 1</span><meta itemprop="url" content="https://cornerchat543.github.io/2024/05/toolkit-mvvm-part01/"></span>			</nav>

		<h1 class="page-title" title="使用ToolKit.MVVM實現ViewModel &#8211; Part 1" itemprop="headline">使用ToolKit.MVVM實現ViewModel &#8211; Part 1</h1>
<ul class="entry-meta" data-type="icons:circle">
<li class="meta-categories" data-type="simple">
<svg width="13" height="13" viewbox="0 0 15 15"><path d="M14.4,1.2H0.6C0.3,1.2,0,1.5,0,1.9V5c0,0.3,0.3,0.6,0.6,0.6h0.6v7.5c0,0.3,0.3,0.6,0.6,0.6h11.2c0.3,0,0.6-0.3,0.6-0.6V5.6h0.6C14.7,5.6,15,5.3,15,5V1.9C15,1.5,14.7,1.2,14.4,1.2z M12.5,12.5h-10V5.6h10V12.5z M13.8,4.4H1.2V2.5h12.5V4.4z M5.6,7.5c0-0.3,0.3-0.6,0.6-0.6h2.5c0.3,0,0.6,0.3,0.6,0.6S9.1,8.1,8.8,8.1H6.2C5.9,8.1,5.6,7.8,5.6,7.5z"></path></svg><a href="https://cornerchat543.github.io/category/c_sharp/" rel="tag" class="ct-term-3">C#</a>
</li>
<li class="meta-date" itemprop="datePublished">
<svg width="13" height="13" viewbox="0 0 15 15"><path d="M7.5,0C3.4,0,0,3.4,0,7.5S3.4,15,7.5,15S15,11.6,15,7.5S11.6,0,7.5,0z M7.5,13.6c-3.4,0-6.1-2.8-6.1-6.1c0-3.4,2.8-6.1,6.1-6.1c3.4,0,6.1,2.8,6.1,6.1C13.6,10.9,10.9,13.6,7.5,13.6z M10.8,9.2c-0.1,0.2-0.4,0.4-0.6,0.4c-0.1,0-0.2,0-0.3-0.1L7.2,8.1C7,8,6.8,7.8,6.8,7.5V4c0-0.4,0.3-0.7,0.7-0.7S8.2,3.6,8.2,4v3.1l2.4,1.2C10.9,8.4,11,8.8,10.8,9.2z"></path></svg><time class="ct-meta-element-date" datetime="2024-05-05T14:54:39+08:00">2024 年 5 月 5 日</time>
</li>
</ul>		</header>
	</div>

		
		
		<div class="entry-content">
			
<figure class="wp-block-image size-large"><img decoding="async" src="https://i.imgur.com/dNjQeay.png" alt="CommunityToolKit.Mvvm文章封面圖"></figure>



<p>在WPF開發中(或其他Windows框架)，若要實現MVVM架構的話，通常需要實作 <mark style="background-color:var(--theme-palette-color-9, rgba(255, 255, 255, 0.4))" class="has-inline-color has-palette-color-8-color">INotifyPropertyChanged</mark>、<mark style="background-color:var(--theme-palette-color-9, rgba(255, 255, 255, 0.4))" class="has-inline-color has-palette-color-8-color">ICommand</mark>，這兩個 interface 。自己先前的習慣是，從網路上找其他人寫好的實作，複製到自己的專案中使用，且每開一次新專案，就複製一份。</p>



<p>某天如往常地尋找資料時，發現了微軟在 Nuget 上的 CommunityToolkit.Mvvm 套件(也稱為MVVM工具包)。該套件不但實作了MVVM所需要的物件，還提供一些好用的 Attribute ，讓程式碼可以更精簡，從而讓開發人員更專注在重要的程式邏輯中。</p>



<p>關於 CommunityToolkit.Mvvm 套件使用方法，預計拆分成幾篇不同主題的文章，而本次將記錄，在未使用此套件之前的做法，接著套件的安裝方法、基本使用，以及如何使用其提供的 Attribute 功能。</p>



<p>開發環境，如下</p>



<ul>
<li>IDE : Visual Studio 2022</li>



<li>.NET版本 : . NET 6.0</li>
</ul>



<hr class="wp-block-separator has-alpha-channel-opacity is-style-wide">



<div id="ez-toc-container" class="ez-toc-v2_0_66_1 ez-toc-wrap-left counter-hierarchy ez-toc-counter ez-toc-custom ez-toc-container-direction">
<div class="ez-toc-title-container">
<p class="ez-toc-title ">內容目錄</p>
<span class="ez-toc-title-toggle"><a href="#" class="ez-toc-pull-right ez-toc-btn ez-toc-btn-xs ez-toc-btn-default ez-toc-toggle" aria-label="Toggle Table of Content"><span class="ez-toc-js-icon-con"><span class=""><span class="eztoc-hide" style="display:none;">Toggle</span><span class="ez-toc-icon-toggle-span"><svg style="fill: #ffffff;color:#ffffff" xmlns="http://www.w3.org/2000/svg" class="list-377408" width="20px" height="20px" viewbox="0 0 24 24" fill="none"><path d="M6 6H4v2h2V6zm14 0H8v2h12V6zM4 11h2v2H4v-2zm16 0H8v2h12v-2zM4 16h2v2H4v-2zm16 0H8v2h12v-2z" fill="currentColor"></path></svg><svg style="fill: #ffffff;color:#ffffff" class="arrow-unsorted-368013" xmlns="http://www.w3.org/2000/svg" width="10px" height="10px" viewbox="0 0 24 24" version="1.2" baseprofile="tiny"><path d="M18.2 9.3l-6.2-6.3-6.2 6.3c-.2.2-.3.4-.3.7s.1.5.3.7c.2.2.4.3.7.3h11c.3 0 .5-.1.7-.3.2-.2.3-.5.3-.7s-.1-.5-.3-.7zM5.8 14.7l6.2 6.3 6.2-6.3c.2-.2.3-.5.3-.7s-.1-.5-.3-.7c-.2-.2-.4-.3-.7-.3h-11c-.3 0-.5.1-.7.3-.2.2-.3.5-.3.7s.1.5.3.7z"></path></svg></span></span></span></a></span>
</div>
<nav><ul class="ez-toc-list ez-toc-list-level-1 ">
<li class="ez-toc-page-1 ez-toc-heading-level-2"><a class="ez-toc-link ez-toc-heading-1" href="#%e4%bb%a5%e5%be%80%e7%9a%84%e9%96%8b%e7%99%bc%e7%8b%80%e6%b3%81" title="以往的開發狀況">以往的開發狀況</a></li>
<li class="ez-toc-page-1 ez-toc-heading-level-2"><a class="ez-toc-link ez-toc-heading-2" href="#%e9%96%8b%e5%a7%8b%e4%bd%bf%e7%94%a8toolkitmvvm" title="開始使用ToolKit.MVVM">開始使用ToolKit.MVVM</a></li>
<li class="ez-toc-page-1 ez-toc-heading-level-2"><a class="ez-toc-link ez-toc-heading-3" href="#%e4%bd%bf%e7%94%a8%e5%a5%97%e4%bb%b6%e6%8f%90%e4%be%9b%e7%9a%84attribute" title="使用套件提供的Attribute">使用套件提供的Attribute</a></li>
<li class="ez-toc-page-1 ez-toc-heading-level-2"><a class="ez-toc-link ez-toc-heading-4" href="#%e5%b1%ac%e6%80%a7%e8%ae%8a%e6%9b%b4%e6%99%82%e7%9a%84%e9%a1%8d%e5%a4%96%e8%99%95%e7%90%86" title="屬性變更時的額外處理">屬性變更時的額外處理</a></li>
<li class="ez-toc-page-1 ez-toc-heading-level-2"><a class="ez-toc-link ez-toc-heading-5" href="#%e4%bd%bf%e7%94%a8%e7%95%b0%e6%ad%a5command" title="使用異步Command">使用異步Command</a></li>
<li class="ez-toc-page-1 ez-toc-heading-level-2"><a class="ez-toc-link ez-toc-heading-6" href="#%e6%99%ae%e9%80%9a%e9%a1%9e%e5%88%a5%e4%bd%bf%e7%94%a8-attribute" title="普通類別使用 Attribute">普通類別使用 Attribute</a></li>
<li class="ez-toc-page-1 ez-toc-heading-level-2"><a class="ez-toc-link ez-toc-heading-7" href="#%e7%b8%bd%e7%b5%90" title="總結">總結</a></li>
<li class="ez-toc-page-1 ez-toc-heading-level-2"><a class="ez-toc-link ez-toc-heading-8" href="#%e8%87%aa%e8%a8%80%e8%87%aa%e8%aa%9e543" title="自言自語543">自言自語543</a></li>
</ul></nav>
</div>
<h2 class="wp-block-heading article_h2">
<span class="ez-toc-section" id="%e4%bb%a5%e5%be%80%e7%9a%84%e9%96%8b%e7%99%bc%e7%8b%80%e6%b3%81"></span>以往的開發狀況<span class="ez-toc-section-end"></span>
</h2>



<p>有比較才有傷害，首先回顧尚未使用套件前，以往撰寫所用的類別與狀況。</p>



<p>View 的 XAML 部分如下，本篇文章的範例，View 都是用同一個，後面則是根據 ViewModel 的不同，替換 DataContext 中的 ViewModel 即可。</p>



<p>此 View 分為兩個部分，</p>



<p>第一部分為兩個 TextBox 搭配一個 Button 組成，預計按下 Button 後顯示 MessageBox。</p>



<p>第二部分為一個 TextBox 配上一個 Button ，不同之處在於預計點擊 Button 後，會傳送 CommandParameter，再顯示 MessageBox。</p>



<div class="wp-block-group is-vertical is-content-justification-stretch is-layout-flex wp-container-core-group-is-layout-1 wp-block-group-is-layout-flex">
<p>XAML</p>



<div class="wp-block-kevinbatdorf-code-block-pro cbp-has-line-numbers" data-code-block-pro-font-family="Code-Pro-JetBrains-Mono" style="font-size:.875rem;font-family:Code-Pro-JetBrains-Mono,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;--cbp-line-number-color:#babed8;--cbp-line-number-width:calc(2 * 0.6 * .875rem);line-height:1.25rem;--cbp-tab-width:2;tab-size:var(--cbp-tab-width, 2)">
<span style="display:flex;align-items:center;padding:10px 0px 10px 16px;margin-bottom:-2px;width:100%;text-align:left;background-color:#181c2a;color:#aaafcf">XML</span><span role="button" tabindex="0" data-code="&lt;Window.Resources&gt;
    &lt;Thickness x:Key=&quot;Margin.Top&quot;&gt;0,10,0,0&lt;/Thickness&gt;
&lt;/Window.Resources&gt;

&lt;Window.DataContext&gt;
    &lt;local:MainWindowViewModel/&gt;
&lt;/Window.DataContext&gt;

&lt;Grid&gt;

    &lt;StackPanel Margin=&quot;20&quot;&gt;

        &lt;!--Name--&gt;
        &lt;TextBlock Text=&quot;Name:&quot;/&gt;
        &lt;TextBox Text=&quot;{Binding Path=Name,
                                UpdateSourceTrigger=PropertyChanged}&quot;/&gt;

        &lt;!--Phone--&gt;
        &lt;TextBlock Margin=&quot;{StaticResource Margin.Top}&quot;
                   Text=&quot;Phone:&quot;/&gt;
        &lt;TextBox Text=&quot;{Binding Path=Phone,
                                UpdateSourceTrigger=PropertyChanged}&quot;/&gt;

        &lt;Button Margin=&quot;{StaticResource Margin.Top}&quot;
                Content=&quot;Show Info&quot;
                Command=&quot;{Binding Path=ShowInfoCommand}&quot;/&gt;

        &lt;!--Note--&gt;
        &lt;TextBlock Margin=&quot;{StaticResource Margin.Top}&quot;
                   Text=&quot;Note:&quot;/&gt;
        &lt;TextBox x:Name=&quot;tbNote&quot;/&gt;

        &lt;Button Margin=&quot;{StaticResource Margin.Top}&quot;
                Content=&quot;Show Note&quot;
                Command=&quot;{Binding Path=ShowNoteCommand}&quot;
                CommandParameter=&quot;{Binding ElementName=tbNote, Path=Text}&quot;/&gt;

    &lt;/StackPanel&gt;

&lt;/Grid&gt;" style="color:#babed8;display:none" aria-label="Copy" class="code-block-pro-copy-button"><svg xmlns="http://www.w3.org/2000/svg" style="width:24px;height:24px" fill="none" viewbox="0 0 24 24" stroke="currentColor" stroke-width="2"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M4.5 12.75l6 6 9-13.5"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M16.5 8.25V6a2.25 2.25 0 00-2.25-2.25H6A2.25 2.25 0 003.75 6v8.25A2.25 2.25 0 006 16.5h2.25m8.25-8.25H18a2.25 2.25 0 012.25 2.25V18A2.25 2.25 0 0118 20.25h-7.5A2.25 2.25 0 018.25 18v-1.5m8.25-8.25h-6a2.25 2.25 0 00-2.25 2.25v6"></path></svg></span><pre class="shiki material-theme-ocean" style="background-color: #0F111A" tabindex="0"><code><span class="line"><span style="color: #89DDFF">&lt;</span><span style="color: #F07178">Window.Resources</span><span style="color: #89DDFF">&gt;</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #89DDFF">&lt;</span><span style="color: #F07178">Thickness</span><span style="color: #89DDFF"> </span><span style="color: #C792EA">x</span><span style="color: #89DDFF">:</span><span style="color: #C792EA">Key</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">Margin.Top</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">&gt;</span><span style="color: #BABED8">0,10,0,0</span><span style="color: #89DDFF">&lt;/</span><span style="color: #F07178">Thickness</span><span style="color: #89DDFF">&gt;</span></span>
<span class="line"><span style="color: #89DDFF">&lt;/</span><span style="color: #F07178">Window.Resources</span><span style="color: #89DDFF">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #89DDFF">&lt;</span><span style="color: #F07178">Window.DataContext</span><span style="color: #89DDFF">&gt;</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #89DDFF">&lt;</span><span style="color: #F07178">local</span><span style="color: #89DDFF">:</span><span style="color: #F07178">MainWindowViewModel</span><span style="color: #89DDFF">/&gt;</span></span>
<span class="line"><span style="color: #89DDFF">&lt;/</span><span style="color: #F07178">Window.DataContext</span><span style="color: #89DDFF">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #89DDFF">&lt;</span><span style="color: #F07178">Grid</span><span style="color: #89DDFF">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #89DDFF">&lt;</span><span style="color: #F07178">StackPanel</span><span style="color: #89DDFF"> </span><span style="color: #C792EA">Margin</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">20</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #BABED8">        </span><span style="color: #464B5D; font-style: italic">&lt;!--Name--&gt;</span></span>
<span class="line"><span style="color: #BABED8">        </span><span style="color: #89DDFF">&lt;</span><span style="color: #F07178">TextBlock</span><span style="color: #89DDFF"> </span><span style="color: #C792EA">Text</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">Name:</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">/&gt;</span></span>
<span class="line"><span style="color: #BABED8">        </span><span style="color: #89DDFF">&lt;</span><span style="color: #F07178">TextBox</span><span style="color: #89DDFF"> </span><span style="color: #C792EA">Text</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">{Binding Path=Name,</span></span>
<span class="line"><span style="color: #C3E88D">                                UpdateSourceTrigger=PropertyChanged}</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">/&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #BABED8">        </span><span style="color: #464B5D; font-style: italic">&lt;!--Phone--&gt;</span></span>
<span class="line"><span style="color: #BABED8">        </span><span style="color: #89DDFF">&lt;</span><span style="color: #F07178">TextBlock</span><span style="color: #89DDFF"> </span><span style="color: #C792EA">Margin</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">{StaticResource Margin.Top}</span><span style="color: #89DDFF">&quot;</span></span>
<span class="line"><span style="color: #89DDFF">                   </span><span style="color: #C792EA">Text</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">Phone:</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">/&gt;</span></span>
<span class="line"><span style="color: #BABED8">        </span><span style="color: #89DDFF">&lt;</span><span style="color: #F07178">TextBox</span><span style="color: #89DDFF"> </span><span style="color: #C792EA">Text</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">{Binding Path=Phone,</span></span>
<span class="line"><span style="color: #C3E88D">                                UpdateSourceTrigger=PropertyChanged}</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">/&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #BABED8">        </span><span style="color: #89DDFF">&lt;</span><span style="color: #F07178">Button</span><span style="color: #89DDFF"> </span><span style="color: #C792EA">Margin</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">{StaticResource Margin.Top}</span><span style="color: #89DDFF">&quot;</span></span>
<span class="line"><span style="color: #89DDFF">                </span><span style="color: #C792EA">Content</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">Show Info</span><span style="color: #89DDFF">&quot;</span></span>
<span class="line"><span style="color: #89DDFF">                </span><span style="color: #C792EA">Command</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">{Binding Path=ShowInfoCommand}</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">/&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #BABED8">        </span><span style="color: #464B5D; font-style: italic">&lt;!--Note--&gt;</span></span>
<span class="line"><span style="color: #BABED8">        </span><span style="color: #89DDFF">&lt;</span><span style="color: #F07178">TextBlock</span><span style="color: #89DDFF"> </span><span style="color: #C792EA">Margin</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">{StaticResource Margin.Top}</span><span style="color: #89DDFF">&quot;</span></span>
<span class="line"><span style="color: #89DDFF">                   </span><span style="color: #C792EA">Text</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">Note:</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">/&gt;</span></span>
<span class="line"><span style="color: #BABED8">        </span><span style="color: #89DDFF">&lt;</span><span style="color: #F07178">TextBox</span><span style="color: #89DDFF"> </span><span style="color: #C792EA">x</span><span style="color: #89DDFF">:</span><span style="color: #C792EA">Name</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">tbNote</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">/&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #BABED8">        </span><span style="color: #89DDFF">&lt;</span><span style="color: #F07178">Button</span><span style="color: #89DDFF"> </span><span style="color: #C792EA">Margin</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">{StaticResource Margin.Top}</span><span style="color: #89DDFF">&quot;</span></span>
<span class="line"><span style="color: #89DDFF">                </span><span style="color: #C792EA">Content</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">Show Note</span><span style="color: #89DDFF">&quot;</span></span>
<span class="line"><span style="color: #89DDFF">                </span><span style="color: #C792EA">Command</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">{Binding Path=ShowNoteCommand}</span><span style="color: #89DDFF">&quot;</span></span>
<span class="line"><span style="color: #89DDFF">                </span><span style="color: #C792EA">CommandParameter</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">{Binding ElementName=tbNote, Path=Text}</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">/&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #89DDFF">&lt;/</span><span style="color: #F07178">StackPanel</span><span style="color: #89DDFF">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #89DDFF">&lt;/</span><span style="color: #F07178">Grid</span><span style="color: #89DDFF">&gt;</span></span></code></pre>
</div>
</div>



<p>View 執行起來，如下圖。</p>



<div class="wp-block-group is-vertical is-content-justification-left is-layout-flex wp-container-core-group-is-layout-2 wp-block-group-is-layout-flex">
<p>View</p>



<figure class="wp-block-image size-large is-style-default wp-duotone-unset-1"><img decoding="async" src="https://i.imgur.com/OInGGRD.png" alt="範例View執行結果"></figure>
</div>



<p><mark style="background-color:var(--theme-palette-color-9, rgba(255, 255, 255, 0.4))" class="has-inline-color has-palette-color-8-color"> INotifyPropertyChanged</mark> 的實作 ViewModelBase 程式碼如下。</p>



<p>每個人的實作與使用上多少有點不同<s>(廢話)</s>，這邊則是網路上找到的某個版本。</p>



<div class="wp-block-group is-vertical is-content-justification-stretch is-layout-flex wp-container-core-group-is-layout-3 wp-block-group-is-layout-flex">
<p>ViewModelBase</p>



<div class="wp-block-kevinbatdorf-code-block-pro cbp-has-line-numbers" data-code-block-pro-font-family="Code-Pro-JetBrains-Mono" style="font-size:.875rem;font-family:Code-Pro-JetBrains-Mono,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;--cbp-line-number-color:#babed8;--cbp-line-number-width:calc(2 * 0.6 * .875rem);line-height:1.25rem;--cbp-tab-width:2;tab-size:var(--cbp-tab-width, 2)">
<span style="display:flex;align-items:center;padding:10px 0px 10px 16px;margin-bottom:-2px;width:100%;text-align:left;background-color:#181c2a;color:#aaafcf">C#</span><span role="button" tabindex="0" data-code="using System.ComponentModel;
using System.Runtime.CompilerServices;

namespace BindingLibrary
{
    public abstract class ViewModelBase : INotifyPropertyChanged
    {
        public event PropertyChangedEventHandler? PropertyChanged;

        protected virtual void OnPropertyChanged(string? propertyName)
        {
            PropertyChanged?.Invoke(
                this, new PropertyChangedEventArgs(propertyName));
        }

        protected bool SetProperty&lt;T&gt;(
            ref T field,
            T value,
            [CallerMemberName] string? propertyName = null)
        {
            if (EqualityComparer&lt;T&gt;.Default.Equals(field, value))
            {
                return false;
            }

            field = value;
            OnPropertyChanged(propertyName);

            return true;
        }
    }
}
" style="color:#babed8;display:none" aria-label="Copy" class="code-block-pro-copy-button"><svg xmlns="http://www.w3.org/2000/svg" style="width:24px;height:24px" fill="none" viewbox="0 0 24 24" stroke="currentColor" stroke-width="2"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M4.5 12.75l6 6 9-13.5"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M16.5 8.25V6a2.25 2.25 0 00-2.25-2.25H6A2.25 2.25 0 003.75 6v8.25A2.25 2.25 0 006 16.5h2.25m8.25-8.25H18a2.25 2.25 0 012.25 2.25V18A2.25 2.25 0 0118 20.25h-7.5A2.25 2.25 0 018.25 18v-1.5m8.25-8.25h-6a2.25 2.25 0 00-2.25 2.25v6"></path></svg></span><pre class="shiki material-theme-ocean" style="background-color: #0F111A" tabindex="0"><code><span class="line"><span style="color: #F78C6C">using</span><span style="color: #BABED8"> System</span><span style="color: #89DDFF">.</span><span style="color: #BABED8">ComponentModel</span><span style="color: #89DDFF">;</span></span>
<span class="line"><span style="color: #F78C6C">using</span><span style="color: #BABED8"> System</span><span style="color: #89DDFF">.</span><span style="color: #BABED8">Runtime</span><span style="color: #89DDFF">.</span><span style="color: #BABED8">CompilerServices</span><span style="color: #89DDFF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #FFCB6B">namespace</span><span style="color: #BABED8"> BindingLibrary</span></span>
<span class="line"><span style="color: #89DDFF">{</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #C792EA">public</span><span style="color: #BABED8"> </span><span style="color: #C792EA">abstract</span><span style="color: #BABED8"> </span><span style="color: #FFCB6B">class</span><span style="color: #BABED8"> </span><span style="color: #FFCB6B">ViewModelBase</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">:</span><span style="color: #BABED8"> </span><span style="color: #FFCB6B">INotifyPropertyChanged</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #89DDFF">{</span></span>
<span class="line"><span style="color: #BABED8">        </span><span style="color: #C792EA">public</span><span style="color: #BABED8"> </span><span style="color: #FFCB6B">event</span><span style="color: #BABED8"> </span><span style="color: #FFCB6B">PropertyChangedEventHandler</span><span style="color: #89DDFF">?</span><span style="color: #BABED8"> </span><span style="color: #FFCB6B">PropertyChanged</span><span style="color: #89DDFF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #BABED8">        </span><span style="color: #C792EA">protected</span><span style="color: #BABED8"> </span><span style="color: #C792EA">virtual</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">void</span><span style="color: #BABED8"> </span><span style="color: #82AAFF">OnPropertyChanged</span><span style="color: #89DDFF">(</span><span style="color: #89DDFF">string</span><span style="color: #89DDFF">?</span><span style="color: #BABED8"> </span><span style="color: #FFCB6B">propertyName</span><span style="color: #89DDFF">)</span></span>
<span class="line"><span style="color: #BABED8">        </span><span style="color: #89DDFF">{</span></span>
<span class="line"><span style="color: #BABED8">            PropertyChanged</span><span style="color: #89DDFF">?.</span><span style="color: #82AAFF">Invoke</span><span style="color: #89DDFF">(</span></span>
<span class="line"><span style="color: #BABED8">                </span><span style="color: #89DDFF">this,</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">new</span><span style="color: #BABED8"> </span><span style="color: #FFCB6B">PropertyChangedEventArgs</span><span style="color: #89DDFF">(</span><span style="color: #BABED8">propertyName</span><span style="color: #89DDFF">));</span></span>
<span class="line"><span style="color: #BABED8">        </span><span style="color: #89DDFF">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #BABED8">        </span><span style="color: #C792EA">protected</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">bool</span><span style="color: #BABED8"> </span><span style="color: #82AAFF">SetProperty</span><span style="color: #89DDFF">&lt;</span><span style="color: #FFCB6B">T</span><span style="color: #89DDFF">&gt;(</span></span>
<span class="line"><span style="color: #BABED8">            </span><span style="color: #C792EA">ref</span><span style="color: #BABED8"> </span><span style="color: #FFCB6B">T</span><span style="color: #BABED8"> </span><span style="color: #FFCB6B">field</span><span style="color: #89DDFF">,</span></span>
<span class="line"><span style="color: #BABED8">            </span><span style="color: #FFCB6B">T</span><span style="color: #BABED8"> </span><span style="color: #FFCB6B">value</span><span style="color: #89DDFF">,</span></span>
<span class="line"><span style="color: #BABED8">            </span><span style="color: #89DDFF">[</span><span style="color: #FFCB6B">CallerMemberName</span><span style="color: #89DDFF">]</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">string</span><span style="color: #89DDFF">?</span><span style="color: #BABED8"> </span><span style="color: #FFCB6B">propertyName</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">=</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">null)</span></span>
<span class="line"><span style="color: #BABED8">        </span><span style="color: #89DDFF">{</span></span>
<span class="line"><span style="color: #BABED8">            </span><span style="color: #89DDFF; font-style: italic">if</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">(</span><span style="color: #BABED8">EqualityComparer</span><span style="color: #89DDFF">&lt;</span><span style="color: #FFCB6B">T</span><span style="color: #89DDFF">&gt;.</span><span style="color: #BABED8">Default</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">Equals</span><span style="color: #89DDFF">(</span><span style="color: #BABED8">field</span><span style="color: #89DDFF">,</span><span style="color: #BABED8"> value</span><span style="color: #89DDFF">))</span></span>
<span class="line"><span style="color: #BABED8">            </span><span style="color: #89DDFF">{</span></span>
<span class="line"><span style="color: #BABED8">                </span><span style="color: #89DDFF; font-style: italic">return</span><span style="color: #BABED8"> </span><span style="color: #FF9CAC">false</span><span style="color: #89DDFF">;</span></span>
<span class="line"><span style="color: #BABED8">            </span><span style="color: #89DDFF">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #BABED8">            field </span><span style="color: #89DDFF">=</span><span style="color: #BABED8"> value</span><span style="color: #89DDFF">;</span></span>
<span class="line"><span style="color: #BABED8">            </span><span style="color: #82AAFF">OnPropertyChanged</span><span style="color: #89DDFF">(</span><span style="color: #BABED8">propertyName</span><span style="color: #89DDFF">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #BABED8">            </span><span style="color: #89DDFF; font-style: italic">return</span><span style="color: #BABED8"> </span><span style="color: #FF9CAC">true</span><span style="color: #89DDFF">;</span></span>
<span class="line"><span style="color: #BABED8">        </span><span style="color: #89DDFF">}</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #89DDFF">}</span></span>
<span class="line"><span style="color: #89DDFF">}</span></span>
<span class="line"></span></code></pre>
</div>
</div>



<p>再來是 <mark style="background-color:var(--theme-palette-color-9, rgba(255, 255, 255, 0.4))" class="has-inline-color has-palette-color-8-color">ICommand</mark> 的實作 RelayCommand 程式碼如下。</p>



<div class="wp-block-group is-vertical is-content-justification-stretch is-layout-flex wp-container-core-group-is-layout-4 wp-block-group-is-layout-flex">
<p>RelayCommand</p>



<div class="wp-block-kevinbatdorf-code-block-pro cbp-has-line-numbers" data-code-block-pro-font-family="Code-Pro-JetBrains-Mono" style="font-size:.875rem;font-family:Code-Pro-JetBrains-Mono,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;--cbp-line-number-color:#babed8;--cbp-line-number-width:calc(2 * 0.6 * .875rem);line-height:1.25rem;--cbp-tab-width:2;tab-size:var(--cbp-tab-width, 2)">
<span style="display:flex;align-items:center;padding:10px 0px 10px 16px;margin-bottom:-2px;width:100%;text-align:left;background-color:#181c2a;color:#aaafcf">C#</span><span role="button" tabindex="0" data-code="using System.Windows.Input;

namespace BindingLibrary
{
    public class RelayCommand : ICommand
    {
        private readonly Action&lt;object?&gt; _execute;
        private readonly Predicate&lt;object?&gt;? _canExecute;

        public RelayCommand
            (Action&lt;object?&gt; execute,
            Predicate&lt;object?&gt;? canExecute = null)
        {
            _execute = execute ?? 
                throw new ArgumentNullException(nameof(execute));
            _canExecute = canExecute;
        }

        public event EventHandler? CanExecuteChanged;

        public bool CanExecute(object? parameter)
        {
            return _canExecute == null
                || _canExecute(parameter);
        }

        public void Execute(object? parameter)
        {
            _execute(parameter);
        }

        public void RaiseCanExecuteChanged()
        {
            CanExecuteChanged?.Invoke(this, EventArgs.Empty);
        }
    }
}
" style="color:#babed8;display:none" aria-label="Copy" class="code-block-pro-copy-button"><svg xmlns="http://www.w3.org/2000/svg" style="width:24px;height:24px" fill="none" viewbox="0 0 24 24" stroke="currentColor" stroke-width="2"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M4.5 12.75l6 6 9-13.5"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M16.5 8.25V6a2.25 2.25 0 00-2.25-2.25H6A2.25 2.25 0 003.75 6v8.25A2.25 2.25 0 006 16.5h2.25m8.25-8.25H18a2.25 2.25 0 012.25 2.25V18A2.25 2.25 0 0118 20.25h-7.5A2.25 2.25 0 018.25 18v-1.5m8.25-8.25h-6a2.25 2.25 0 00-2.25 2.25v6"></path></svg></span><pre class="shiki material-theme-ocean" style="background-color: #0F111A" tabindex="0"><code><span class="line"><span style="color: #F78C6C">using</span><span style="color: #BABED8"> System</span><span style="color: #89DDFF">.</span><span style="color: #BABED8">Windows</span><span style="color: #89DDFF">.</span><span style="color: #BABED8">Input</span><span style="color: #89DDFF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #FFCB6B">namespace</span><span style="color: #BABED8"> BindingLibrary</span></span>
<span class="line"><span style="color: #89DDFF">{</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #C792EA">public</span><span style="color: #BABED8"> </span><span style="color: #FFCB6B">class</span><span style="color: #BABED8"> </span><span style="color: #FFCB6B">RelayCommand</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">:</span><span style="color: #BABED8"> </span><span style="color: #FFCB6B">ICommand</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #89DDFF">{</span></span>
<span class="line"><span style="color: #BABED8">        </span><span style="color: #C792EA">private</span><span style="color: #BABED8"> </span><span style="color: #C792EA">readonly</span><span style="color: #BABED8"> </span><span style="color: #FFCB6B">Action</span><span style="color: #89DDFF">&lt;object?&gt;</span><span style="color: #BABED8"> </span><span style="color: #FFCB6B">_execute</span><span style="color: #89DDFF">;</span></span>
<span class="line"><span style="color: #BABED8">        </span><span style="color: #C792EA">private</span><span style="color: #BABED8"> </span><span style="color: #C792EA">readonly</span><span style="color: #BABED8"> </span><span style="color: #FFCB6B">Predicate</span><span style="color: #89DDFF">&lt;object?&gt;?</span><span style="color: #BABED8"> </span><span style="color: #FFCB6B">_canExecute</span><span style="color: #89DDFF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #BABED8">        </span><span style="color: #C792EA">public</span><span style="color: #BABED8"> RelayCommand</span></span>
<span class="line"><span style="color: #BABED8">            (</span><span style="color: #FFCB6B">Action</span><span style="color: #89DDFF">&lt;object?&gt;</span><span style="color: #BABED8"> </span><span style="color: #FFCB6B">execute</span><span style="color: #89DDFF">,</span></span>
<span class="line"><span style="color: #BABED8">            </span><span style="color: #FFCB6B">Predicate</span><span style="color: #BABED8">&lt;</span><span style="color: #FFCB6B">object</span><span style="color: #BABED8">?&gt;? </span><span style="color: #FFCB6B">canExecute</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">=</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">null</span><span style="color: #BABED8">)</span></span>
<span class="line"><span style="color: #BABED8">        {</span></span>
<span class="line"><span style="color: #BABED8">            </span><span style="color: #FFCB6B">_execute</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">=</span><span style="color: #BABED8"> execute </span><span style="color: #89DDFF">??</span><span style="color: #BABED8"> </span></span>
<span class="line"><span style="color: #BABED8">                </span><span style="color: #89DDFF; font-style: italic">throw</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">new</span><span style="color: #BABED8"> </span><span style="color: #FFCB6B">ArgumentNullException</span><span style="color: #89DDFF">(nameof(</span><span style="color: #BABED8">execute</span><span style="color: #89DDFF">));</span></span>
<span class="line"><span style="color: #BABED8">            _canExecute </span><span style="color: #89DDFF">=</span><span style="color: #BABED8"> canExecute</span><span style="color: #89DDFF">;</span></span>
<span class="line"><span style="color: #BABED8">        </span><span style="color: #89DDFF">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #BABED8">        </span><span style="color: #C792EA">public</span><span style="color: #BABED8"> event EventHandler? CanExecuteChanged</span><span style="color: #89DDFF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #BABED8">        </span><span style="color: #C792EA">public</span><span style="color: #BABED8"> bool CanExecute(object? parameter)</span></span>
<span class="line"><span style="color: #BABED8">        {</span></span>
<span class="line"><span style="color: #BABED8">            return _canExecute == null</span></span>
<span class="line"><span style="color: #BABED8">                || _canExecute(parameter)</span><span style="color: #89DDFF">;</span></span>
<span class="line"><span style="color: #BABED8">        </span><span style="color: #89DDFF">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #BABED8">        </span><span style="color: #C792EA">public</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">void</span><span style="color: #BABED8"> </span><span style="color: #82AAFF">Execute</span><span style="color: #89DDFF">(object?</span><span style="color: #BABED8"> </span><span style="color: #FFCB6B">parameter</span><span style="color: #89DDFF">)</span></span>
<span class="line"><span style="color: #BABED8">        </span><span style="color: #89DDFF">{</span></span>
<span class="line"><span style="color: #BABED8">            </span><span style="color: #82AAFF">_execute</span><span style="color: #89DDFF">(</span><span style="color: #BABED8">parameter</span><span style="color: #89DDFF">);</span></span>
<span class="line"><span style="color: #BABED8">        </span><span style="color: #89DDFF">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #BABED8">        </span><span style="color: #C792EA">public</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">void</span><span style="color: #BABED8"> </span><span style="color: #82AAFF">RaiseCanExecuteChanged</span><span style="color: #89DDFF">()</span></span>
<span class="line"><span style="color: #BABED8">        </span><span style="color: #89DDFF">{</span></span>
<span class="line"><span style="color: #BABED8">            CanExecuteChanged</span><span style="color: #89DDFF">?.</span><span style="color: #82AAFF">Invoke</span><span style="color: #89DDFF">(this,</span><span style="color: #BABED8"> EventArgs</span><span style="color: #89DDFF">.</span><span style="color: #BABED8">Empty</span><span style="color: #89DDFF">);</span></span>
<span class="line"><span style="color: #BABED8">        </span><span style="color: #89DDFF">}</span></span>
<span class="line"><span style="color: #BABED8">    }</span></span>
<span class="line"><span style="color: #BABED8">}</span></span>
<span class="line"></span></code></pre>
</div>
</div>



<p>最後是 ViewModel 的程式碼 MainWindowViewModel。</p>



<p>繼承部分，</p>



<ul>
<li>此類別繼承 ViewModelBase。</li>
</ul>



<p>Property 部分，</p>



<ul>
<li>Name，set 時使用 SetProperty 方法外，還會呼叫 RaiseCanExecuteChanged 進行對應的 CanExecute 方法。</li>



<li>Phone，單純使用 SetProperty 方法。</li>
</ul>



<p>Command 部分，</p>



<ul>
<li>ShowInfoCommand，CanExecute 部分呼叫 CanShowInfo() ，檢查 _name 變數是否為 null 或 empty ；Execute 部分呼叫 ShowInfo() ，將 Name 與 Phone 的內容顯示在 MessageBox 中。</li>



<li>ShowNoteCommand，Execute 部分呼叫 ShowNote(object? obj) ，將 View 傳進來的物件，傳成字串並顯示在 MessageBox 中。</li>
</ul>



<div class="wp-block-group is-vertical is-content-justification-stretch is-layout-flex wp-container-core-group-is-layout-5 wp-block-group-is-layout-flex">
<p>MainWindowViewModel</p>



<div class="wp-block-kevinbatdorf-code-block-pro cbp-has-line-numbers" data-code-block-pro-font-family="Code-Pro-JetBrains-Mono" style="font-size:.875rem;font-family:Code-Pro-JetBrains-Mono,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;--cbp-line-number-color:#babed8;--cbp-line-number-width:calc(2 * 0.6 * .875rem);line-height:1.25rem;--cbp-tab-width:2;tab-size:var(--cbp-tab-width, 2)">
<span style="display:flex;align-items:center;padding:10px 0px 10px 16px;margin-bottom:-2px;width:100%;text-align:left;background-color:#181c2a;color:#aaafcf">C#</span><span role="button" tabindex="0" data-code="public class MainWindowViewModel : ViewModelBase
{
    private string? _name;
    public string? Name
    {
        get =&gt; _name;
        set
        {
            SetProperty(ref _name, value);
            ShowInfoCommand.RaiseCanExecuteChanged();
        }
    }

    private string? _phone;
    public string? Phone
    {
        get =&gt; _phone;
        set =&gt; SetProperty(ref _phone, value);
    }

    private RelayCommand? _showInfoCommand;
    public RelayCommand ShowInfoCommand
        =&gt; _showInfoCommand ??= new RelayCommand(
            _ =&gt; ShowInfo(), _ =&gt; CanShowInfo());

    private ICommand? _showNoteCommand;
    public ICommand ShowNoteCommand
        =&gt; _showNoteCommand ??= new RelayCommand(ShowNote);

    private bool CanShowInfo()
    {
        return !string.IsNullOrEmpty(_name);
    }

    private void ShowInfo()
    {
        string info = $&quot;Name: {Name}\nPhone: {Phone}&quot;;
        MessageBox.Show(info, &quot;MessageBox&quot;);
    }

    private void ShowNote(object? obj)
    {
        string? str = (string?)obj;
        string info = $&quot;Note: {str}&quot;;
        MessageBox.Show(info, &quot;MessageBox&quot;);
    }
}" style="color:#babed8;display:none" aria-label="Copy" class="code-block-pro-copy-button"><svg xmlns="http://www.w3.org/2000/svg" style="width:24px;height:24px" fill="none" viewbox="0 0 24 24" stroke="currentColor" stroke-width="2"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M4.5 12.75l6 6 9-13.5"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M16.5 8.25V6a2.25 2.25 0 00-2.25-2.25H6A2.25 2.25 0 003.75 6v8.25A2.25 2.25 0 006 16.5h2.25m8.25-8.25H18a2.25 2.25 0 012.25 2.25V18A2.25 2.25 0 0118 20.25h-7.5A2.25 2.25 0 018.25 18v-1.5m8.25-8.25h-6a2.25 2.25 0 00-2.25 2.25v6"></path></svg></span><pre class="shiki material-theme-ocean" style="background-color: #0F111A" tabindex="0"><code><span class="line"><span style="color: #C792EA">public</span><span style="color: #BABED8"> </span><span style="color: #FFCB6B">class</span><span style="color: #BABED8"> </span><span style="color: #FFCB6B">MainWindowViewModel</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">:</span><span style="color: #BABED8"> </span><span style="color: #FFCB6B">ViewModelBase</span></span>
<span class="line"><span style="color: #89DDFF">{</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #C792EA">private</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">string</span><span style="color: #89DDFF">?</span><span style="color: #BABED8"> </span><span style="color: #FFCB6B">_name</span><span style="color: #89DDFF">;</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #C792EA">public</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">string</span><span style="color: #89DDFF">?</span><span style="color: #BABED8"> </span><span style="color: #FFCB6B">Name</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #89DDFF">{</span></span>
<span class="line"><span style="color: #BABED8">        </span><span style="color: #FFCB6B">get</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">=&gt;</span><span style="color: #BABED8"> _name</span><span style="color: #89DDFF">;</span></span>
<span class="line"><span style="color: #BABED8">        </span><span style="color: #FFCB6B">set</span></span>
<span class="line"><span style="color: #BABED8">        </span><span style="color: #89DDFF">{</span></span>
<span class="line"><span style="color: #BABED8">            </span><span style="color: #82AAFF">SetProperty</span><span style="color: #89DDFF">(</span><span style="color: #C792EA">ref</span><span style="color: #BABED8"> _name</span><span style="color: #89DDFF">,</span><span style="color: #BABED8"> value</span><span style="color: #89DDFF">);</span></span>
<span class="line"><span style="color: #BABED8">            ShowInfoCommand</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">RaiseCanExecuteChanged</span><span style="color: #89DDFF">();</span></span>
<span class="line"><span style="color: #BABED8">        </span><span style="color: #89DDFF">}</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #89DDFF">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #C792EA">private</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">string</span><span style="color: #89DDFF">?</span><span style="color: #BABED8"> </span><span style="color: #FFCB6B">_phone</span><span style="color: #89DDFF">;</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #C792EA">public</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">string</span><span style="color: #89DDFF">?</span><span style="color: #BABED8"> </span><span style="color: #FFCB6B">Phone</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #89DDFF">{</span></span>
<span class="line"><span style="color: #BABED8">        </span><span style="color: #FFCB6B">get</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">=&gt;</span><span style="color: #BABED8"> _phone</span><span style="color: #89DDFF">;</span></span>
<span class="line"><span style="color: #BABED8">        </span><span style="color: #FFCB6B">set</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">=&gt;</span><span style="color: #BABED8"> </span><span style="color: #82AAFF">SetProperty</span><span style="color: #89DDFF">(</span><span style="color: #C792EA">ref</span><span style="color: #BABED8"> _phone</span><span style="color: #89DDFF">,</span><span style="color: #BABED8"> value</span><span style="color: #89DDFF">);</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #89DDFF">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #C792EA">private</span><span style="color: #BABED8"> </span><span style="color: #FFCB6B">RelayCommand</span><span style="color: #89DDFF">?</span><span style="color: #BABED8"> </span><span style="color: #FFCB6B">_showInfoCommand</span><span style="color: #89DDFF">;</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #C792EA">public</span><span style="color: #BABED8"> </span><span style="color: #FFCB6B">RelayCommand</span><span style="color: #BABED8"> </span><span style="color: #FFCB6B">ShowInfoCommand</span></span>
<span class="line"><span style="color: #BABED8">        </span><span style="color: #89DDFF">=&gt;</span><span style="color: #BABED8"> _showInfoCommand </span><span style="color: #89DDFF">??=</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">new</span><span style="color: #BABED8"> </span><span style="color: #FFCB6B">RelayCommand</span><span style="color: #89DDFF">(</span></span>
<span class="line"><span style="color: #BABED8">            </span><span style="color: #FFCB6B">_</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">=&gt;</span><span style="color: #BABED8"> </span><span style="color: #82AAFF">ShowInfo</span><span style="color: #89DDFF">(),</span><span style="color: #BABED8"> </span><span style="color: #FFCB6B">_</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">=&gt;</span><span style="color: #BABED8"> </span><span style="color: #82AAFF">CanShowInfo</span><span style="color: #89DDFF">());</span></span>
<span class="line"></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #C792EA">private</span><span style="color: #BABED8"> </span><span style="color: #FFCB6B">ICommand</span><span style="color: #89DDFF">?</span><span style="color: #BABED8"> </span><span style="color: #FFCB6B">_showNoteCommand</span><span style="color: #89DDFF">;</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #C792EA">public</span><span style="color: #BABED8"> </span><span style="color: #FFCB6B">ICommand</span><span style="color: #BABED8"> </span><span style="color: #FFCB6B">ShowNoteCommand</span></span>
<span class="line"><span style="color: #BABED8">        </span><span style="color: #89DDFF">=&gt;</span><span style="color: #BABED8"> _showNoteCommand </span><span style="color: #89DDFF">??=</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">new</span><span style="color: #BABED8"> </span><span style="color: #FFCB6B">RelayCommand</span><span style="color: #89DDFF">(</span><span style="color: #BABED8">ShowNote</span><span style="color: #89DDFF">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #C792EA">private</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">bool</span><span style="color: #BABED8"> </span><span style="color: #82AAFF">CanShowInfo</span><span style="color: #89DDFF">()</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #89DDFF">{</span></span>
<span class="line"><span style="color: #BABED8">        </span><span style="color: #89DDFF; font-style: italic">return</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">!</span><span style="color: #89DDFF">string</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">IsNullOrEmpty</span><span style="color: #89DDFF">(</span><span style="color: #BABED8">_name</span><span style="color: #89DDFF">);</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #89DDFF">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #C792EA">private</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">void</span><span style="color: #BABED8"> </span><span style="color: #82AAFF">ShowInfo</span><span style="color: #89DDFF">()</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #89DDFF">{</span></span>
<span class="line"><span style="color: #BABED8">        </span><span style="color: #89DDFF">string</span><span style="color: #BABED8"> </span><span style="color: #FFCB6B">info</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">=</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">$&quot;</span><span style="color: #C3E88D">Name: </span><span style="color: #89DDFF">{</span><span style="color: #BABED8">Name</span><span style="color: #89DDFF">}</span><span style="color: #BABED8">\n</span><span style="color: #C3E88D">Phone: </span><span style="color: #89DDFF">{</span><span style="color: #BABED8">Phone</span><span style="color: #89DDFF">}&quot;</span><span style="color: #89DDFF">;</span></span>
<span class="line"><span style="color: #BABED8">        MessageBox</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">Show</span><span style="color: #89DDFF">(</span><span style="color: #BABED8">info</span><span style="color: #89DDFF">,</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">MessageBox</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">);</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #89DDFF">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #C792EA">private</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">void</span><span style="color: #BABED8"> </span><span style="color: #82AAFF">ShowNote</span><span style="color: #89DDFF">(object?</span><span style="color: #BABED8"> </span><span style="color: #FFCB6B">obj</span><span style="color: #89DDFF">)</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #89DDFF">{</span></span>
<span class="line"><span style="color: #BABED8">        </span><span style="color: #89DDFF">string</span><span style="color: #89DDFF">?</span><span style="color: #BABED8"> </span><span style="color: #FFCB6B">str</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">=</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">(</span><span style="color: #89DDFF">string</span><span style="color: #89DDFF">?)</span><span style="color: #BABED8">obj</span><span style="color: #89DDFF">;</span></span>
<span class="line"><span style="color: #BABED8">        </span><span style="color: #89DDFF">string</span><span style="color: #BABED8"> </span><span style="color: #FFCB6B">info</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">=</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">$&quot;</span><span style="color: #C3E88D">Note: </span><span style="color: #89DDFF">{</span><span style="color: #BABED8">str</span><span style="color: #89DDFF">}&quot;</span><span style="color: #89DDFF">;</span></span>
<span class="line"><span style="color: #BABED8">        MessageBox</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">Show</span><span style="color: #89DDFF">(</span><span style="color: #BABED8">info</span><span style="color: #89DDFF">,</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">MessageBox</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">);</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #89DDFF">}</span></span>
<span class="line"><span style="color: #89DDFF">}</span></span></code></pre>
</div>
</div>



<p>整體程式執行結果，如下，</p>



<p>在輸入 Name 前，Show Info 按鈕為 Disable 狀態，輸入文字後則變為 Enable 狀態，按下 Show Info 按鈕後，出現 MessageBox 並顯示所 Binding 的內容。</p>



<div class="wp-block-group is-vertical is-content-justification-stretch is-layout-flex wp-container-core-group-is-layout-6 wp-block-group-is-layout-flex">
<p>執行結果1</p>



<figure class="wp-block-image size-large is-style-default wp-duotone-unset-2"><img decoding="async" src="https://i.imgur.com/z1SbLGL.jpeg" alt="範例程式執行結果1"></figure>
</div>



<p>輸入 Note 後，按下 Show Note 按鈕，View 會將內容文字經由 CommandParameter 傳到 ViewModel 中，最後由 MessageBox 顯示其內容。</p>



<div class="wp-block-group is-vertical is-content-justification-stretch is-layout-flex wp-container-core-group-is-layout-7 wp-block-group-is-layout-flex">
<p>執行結果2</p>



<figure class="wp-block-image size-large is-style-default wp-duotone-unset-3"><img decoding="async" src="https://i.imgur.com/ic2pyqS.png" alt="範例程式執行結果2"></figure>
</div>



<p>到這裡，示範了如何在 View 與 ViewModel DataBinding 時，實作基礎介面與使用方式，相信有寫過C# MVVM架構的人，是會感到很熟悉的。</p>



<p>那麼，接下來將會把上面的範例程式，改成使用套件的情況。</p>



<h2 class="wp-block-heading article_h2">
<span class="ez-toc-section" id="%e9%96%8b%e5%a7%8b%e4%bd%bf%e7%94%a8toolkitmvvm"></span>開始使用ToolKit.MVVM<span class="ez-toc-section-end"></span>
</h2>



<p>開始使用前，需要進行套件的安裝。</p>



<p>打開專案後，在該專案下找到&#8221;相依性&#8221;，並在該項目上按右鍵，選擇選單中的 &#8220;管理NuGet套件&#8221; ，切換到&#8221;瀏覽&#8221;的頁籤中，在搜尋框中輸入 &#8220;ToolKit.Mvvm&#8221;。</p>



<p>在搜尋結果列表中，選擇 &#8220;CommunityToolkit.Mvvm&#8221; 進行安裝。</p>



<p>另外列表中會看到 Microsoft.Toolkit.Mvvm 的套件，該套件是較早期的版本而 CommunityToolkit.Mvvm 則是其最新的版本。</p>



<div class="wp-block-group is-vertical is-content-justification-stretch is-layout-flex wp-container-core-group-is-layout-8 wp-block-group-is-layout-flex">
<p>Nuget 搜尋結果</p>



<figure class="wp-block-image size-large is-style-default wp-duotone-unset-4"><img decoding="async" src="https://i.imgur.com/lqeaStK.jpeg" alt="Nuget搜尋CommunityToolKit.Mvvm套件的搜尋結果"></figure>
</div>



<p>套件安裝完成後，接下來使用套件內的類別來完成 ViewModel，這邊我建立新的 ViewModel，並且將前一個 ViewModel 複製過來做程式碼的修改。</p>



<p>using 下面這兩個 Namespace，當然也可以輸入對應的類別，在IDE上設定引用。</p>



<div class="wp-block-group is-vertical is-content-justification-stretch is-layout-flex wp-container-core-group-is-layout-9 wp-block-group-is-layout-flex">
<p>Namespace部分</p>



<div class="wp-block-kevinbatdorf-code-block-pro cbp-has-line-numbers" data-code-block-pro-font-family="Code-Pro-JetBrains-Mono" style="font-size:.875rem;font-family:Code-Pro-JetBrains-Mono,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;--cbp-line-number-color:#babed8;--cbp-line-number-width:calc(1 * 0.6 * .875rem);line-height:1.25rem;--cbp-tab-width:2;tab-size:var(--cbp-tab-width, 2)">
<span style="display:flex;align-items:center;padding:10px 0px 10px 16px;margin-bottom:-2px;width:100%;text-align:left;background-color:#181c2a;color:#aaafcf">C#</span><span role="button" tabindex="0" data-code="using CommunityToolkit.Mvvm.ComponentModel;
using CommunityToolkit.Mvvm.Input;" style="color:#babed8;display:none" aria-label="Copy" class="code-block-pro-copy-button"><svg xmlns="http://www.w3.org/2000/svg" style="width:24px;height:24px" fill="none" viewbox="0 0 24 24" stroke="currentColor" stroke-width="2"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M4.5 12.75l6 6 9-13.5"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M16.5 8.25V6a2.25 2.25 0 00-2.25-2.25H6A2.25 2.25 0 003.75 6v8.25A2.25 2.25 0 006 16.5h2.25m8.25-8.25H18a2.25 2.25 0 012.25 2.25V18A2.25 2.25 0 0118 20.25h-7.5A2.25 2.25 0 018.25 18v-1.5m8.25-8.25h-6a2.25 2.25 0 00-2.25 2.25v6"></path></svg></span><pre class="shiki material-theme-ocean" style="background-color: #0F111A" tabindex="0"><code><span class="line"><span style="color: #F78C6C">using</span><span style="color: #BABED8"> CommunityToolkit</span><span style="color: #89DDFF">.</span><span style="color: #BABED8">Mvvm</span><span style="color: #89DDFF">.</span><span style="color: #BABED8">ComponentModel</span><span style="color: #89DDFF">;</span></span>
<span class="line"><span style="color: #F78C6C">using</span><span style="color: #BABED8"> CommunityToolkit</span><span style="color: #89DDFF">.</span><span style="color: #BABED8">Mvvm</span><span style="color: #89DDFF">.</span><span style="color: #BABED8">Input</span><span style="color: #89DDFF">;</span></span></code></pre>
</div>
</div>



<p>ViewModel 的程式碼如下，來說明有修改的地方</p>



<p>繼承部分，</p>



<ul>
<li>繼承 <mark style="background-color:var(--theme-palette-color-9, rgba(255, 255, 255, 0.2))" class="has-inline-color has-palette-color-8-color">ObservableObject</mark>，該類別實作了 <mark style="background-color:var(--theme-palette-color-9, rgba(255, 255, 255, 0.2))" class="has-inline-color has-palette-color-8-color">INotifyPropertyChanged</mark> 和  <mark style="background-color:var(--theme-palette-color-9, rgba(255, 255, 255, 0.2))" class="has-inline-color has-palette-color-8-color">INotifyPropertyChanging</mark>。</li>
</ul>



<p>Property 部分，</p>



<ul>
<li>基本上是一模一樣，唯一不同的地方是，Name 屬性的 set 方法中，原本呼叫 CanExecute 方法，在該套件下方法名是 <mark style="background-color:var(--theme-palette-color-9, rgba(255, 255, 255, 0.2))" class="has-inline-color has-palette-color-8-color">NotifyCanExecuteChanged()</mark>。</li>
</ul>



<p>Command 部分，</p>



<ul>
<li>Command 在使用上，也是差不多的，類別也是叫 <mark style="background-color:var(--theme-palette-color-9, rgba(255, 255, 255, 0.2))" class="has-inline-color has-palette-color-8-color">RelayCommand</mark> </li>



<li>套件內有分 <mark style="background-color:var(--theme-palette-color-9, rgba(255, 255, 255, 0.2))" class="has-inline-color has-palette-color-8-color">RelayCommand</mark> 與 <mark style="background-color:var(--theme-palette-color-9, rgba(255, 255, 255, 0.2))" class="has-inline-color has-palette-color-8-color">RelayCommand&lt;T&gt;</mark> ，以前自己用的是 RelayCommand 算是兩種的混合，固定參數都是 object 型態，不使用時用 lamda 捨棄，要使用時從 object 來轉型，那既然套件內有做區分，使用對應的類別即可。</li>
</ul>



<div class="wp-block-group is-vertical is-content-justification-stretch is-layout-flex wp-container-core-group-is-layout-10 wp-block-group-is-layout-flex">
<p>MainWindowViewModel01</p>



<div class="wp-block-kevinbatdorf-code-block-pro cbp-has-line-numbers" data-code-block-pro-font-family="Code-Pro-JetBrains-Mono" style="font-size:.875rem;font-family:Code-Pro-JetBrains-Mono,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;--cbp-line-number-color:#babed8;--cbp-line-number-width:calc(2 * 0.6 * .875rem);line-height:1.25rem;--cbp-tab-width:2;tab-size:var(--cbp-tab-width, 2)">
<span style="display:flex;align-items:center;padding:10px 0px 10px 16px;margin-bottom:-2px;width:100%;text-align:left;background-color:#181c2a;color:#aaafcf">C#</span><span role="button" tabindex="0" data-code="public class MainWindowViewModel01 : ObservableObject
{
    private string? _name;
    public string? Name
    {
        get =&gt; _name;
        set
        {
            SetProperty(ref _name, value);
            ShowInfoCommand.NotifyCanExecuteChanged();
        }
    }

    private string? _phone;
    public string? Phone
    {
        get =&gt; _phone;
        set =&gt; SetProperty(ref _phone, value);
    }

    private RelayCommand? _showInfoCommand;
    public RelayCommand ShowInfoCommand
        =&gt; _showInfoCommand ??= new RelayCommand(ShowInfo, CanShowInfo);

    private ICommand? _showNoteCommand;
    public ICommand ShowNoteCommand
        =&gt; _showNoteCommand ??= new RelayCommand&lt;string&gt;(ShowNote);

    private bool CanShowInfo()
    {
        return !string.IsNullOrEmpty(_name);
    }

    private void ShowInfo()
    {
        string info = $&quot;Name: {Name}\nPhone: {Phone}&quot;;
        MessageBox.Show(info, &quot;MessageBox&quot;);
    }

    private void ShowNote(string? str)
    {
        string info = $&quot;Note: {str}&quot;;
        MessageBox.Show(info, &quot;MessageBox&quot;);
    }
}" style="color:#babed8;display:none" aria-label="Copy" class="code-block-pro-copy-button"><svg xmlns="http://www.w3.org/2000/svg" style="width:24px;height:24px" fill="none" viewbox="0 0 24 24" stroke="currentColor" stroke-width="2"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M4.5 12.75l6 6 9-13.5"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M16.5 8.25V6a2.25 2.25 0 00-2.25-2.25H6A2.25 2.25 0 003.75 6v8.25A2.25 2.25 0 006 16.5h2.25m8.25-8.25H18a2.25 2.25 0 012.25 2.25V18A2.25 2.25 0 0118 20.25h-7.5A2.25 2.25 0 018.25 18v-1.5m8.25-8.25h-6a2.25 2.25 0 00-2.25 2.25v6"></path></svg></span><pre class="shiki material-theme-ocean" style="background-color: #0F111A" tabindex="0"><code><span class="line"><span style="color: #C792EA">public</span><span style="color: #BABED8"> </span><span style="color: #FFCB6B">class</span><span style="color: #BABED8"> </span><span style="color: #FFCB6B">MainWindowViewModel01</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">:</span><span style="color: #BABED8"> </span><span style="color: #FFCB6B">ObservableObject</span></span>
<span class="line"><span style="color: #89DDFF">{</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #C792EA">private</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">string</span><span style="color: #89DDFF">?</span><span style="color: #BABED8"> </span><span style="color: #FFCB6B">_name</span><span style="color: #89DDFF">;</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #C792EA">public</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">string</span><span style="color: #89DDFF">?</span><span style="color: #BABED8"> </span><span style="color: #FFCB6B">Name</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #89DDFF">{</span></span>
<span class="line"><span style="color: #BABED8">        </span><span style="color: #FFCB6B">get</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">=&gt;</span><span style="color: #BABED8"> _name</span><span style="color: #89DDFF">;</span></span>
<span class="line"><span style="color: #BABED8">        </span><span style="color: #FFCB6B">set</span></span>
<span class="line"><span style="color: #BABED8">        </span><span style="color: #89DDFF">{</span></span>
<span class="line"><span style="color: #BABED8">            </span><span style="color: #82AAFF">SetProperty</span><span style="color: #89DDFF">(</span><span style="color: #C792EA">ref</span><span style="color: #BABED8"> _name</span><span style="color: #89DDFF">,</span><span style="color: #BABED8"> value</span><span style="color: #89DDFF">);</span></span>
<span class="line"><span style="color: #BABED8">            ShowInfoCommand</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">NotifyCanExecuteChanged</span><span style="color: #89DDFF">();</span></span>
<span class="line"><span style="color: #BABED8">        </span><span style="color: #89DDFF">}</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #89DDFF">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #C792EA">private</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">string</span><span style="color: #89DDFF">?</span><span style="color: #BABED8"> </span><span style="color: #FFCB6B">_phone</span><span style="color: #89DDFF">;</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #C792EA">public</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">string</span><span style="color: #89DDFF">?</span><span style="color: #BABED8"> </span><span style="color: #FFCB6B">Phone</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #89DDFF">{</span></span>
<span class="line"><span style="color: #BABED8">        </span><span style="color: #FFCB6B">get</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">=&gt;</span><span style="color: #BABED8"> _phone</span><span style="color: #89DDFF">;</span></span>
<span class="line"><span style="color: #BABED8">        </span><span style="color: #FFCB6B">set</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">=&gt;</span><span style="color: #BABED8"> </span><span style="color: #82AAFF">SetProperty</span><span style="color: #89DDFF">(</span><span style="color: #C792EA">ref</span><span style="color: #BABED8"> _phone</span><span style="color: #89DDFF">,</span><span style="color: #BABED8"> value</span><span style="color: #89DDFF">);</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #89DDFF">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #C792EA">private</span><span style="color: #BABED8"> </span><span style="color: #FFCB6B">RelayCommand</span><span style="color: #89DDFF">?</span><span style="color: #BABED8"> </span><span style="color: #FFCB6B">_showInfoCommand</span><span style="color: #89DDFF">;</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #C792EA">public</span><span style="color: #BABED8"> </span><span style="color: #FFCB6B">RelayCommand</span><span style="color: #BABED8"> </span><span style="color: #FFCB6B">ShowInfoCommand</span></span>
<span class="line"><span style="color: #BABED8">        </span><span style="color: #89DDFF">=&gt;</span><span style="color: #BABED8"> _showInfoCommand </span><span style="color: #89DDFF">??=</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">new</span><span style="color: #BABED8"> </span><span style="color: #FFCB6B">RelayCommand</span><span style="color: #89DDFF">(</span><span style="color: #BABED8">ShowInfo</span><span style="color: #89DDFF">,</span><span style="color: #BABED8"> CanShowInfo</span><span style="color: #89DDFF">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #C792EA">private</span><span style="color: #BABED8"> </span><span style="color: #FFCB6B">ICommand</span><span style="color: #89DDFF">?</span><span style="color: #BABED8"> </span><span style="color: #FFCB6B">_showNoteCommand</span><span style="color: #89DDFF">;</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #C792EA">public</span><span style="color: #BABED8"> </span><span style="color: #FFCB6B">ICommand</span><span style="color: #BABED8"> </span><span style="color: #FFCB6B">ShowNoteCommand</span></span>
<span class="line"><span style="color: #BABED8">        </span><span style="color: #89DDFF">=&gt;</span><span style="color: #BABED8"> _showNoteCommand </span><span style="color: #89DDFF">??=</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">new</span><span style="color: #BABED8"> </span><span style="color: #FFCB6B">RelayCommand</span><span style="color: #89DDFF">&lt;</span><span style="color: #89DDFF">string</span><span style="color: #89DDFF">&gt;(</span><span style="color: #BABED8">ShowNote</span><span style="color: #89DDFF">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #C792EA">private</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">bool</span><span style="color: #BABED8"> </span><span style="color: #82AAFF">CanShowInfo</span><span style="color: #89DDFF">()</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #89DDFF">{</span></span>
<span class="line"><span style="color: #BABED8">        </span><span style="color: #89DDFF; font-style: italic">return</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">!</span><span style="color: #89DDFF">string</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">IsNullOrEmpty</span><span style="color: #89DDFF">(</span><span style="color: #BABED8">_name</span><span style="color: #89DDFF">);</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #89DDFF">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #C792EA">private</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">void</span><span style="color: #BABED8"> </span><span style="color: #82AAFF">ShowInfo</span><span style="color: #89DDFF">()</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #89DDFF">{</span></span>
<span class="line"><span style="color: #BABED8">        </span><span style="color: #89DDFF">string</span><span style="color: #BABED8"> </span><span style="color: #FFCB6B">info</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">=</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">$&quot;</span><span style="color: #C3E88D">Name: </span><span style="color: #89DDFF">{</span><span style="color: #BABED8">Name</span><span style="color: #89DDFF">}</span><span style="color: #BABED8">\n</span><span style="color: #C3E88D">Phone: </span><span style="color: #89DDFF">{</span><span style="color: #BABED8">Phone</span><span style="color: #89DDFF">}&quot;</span><span style="color: #89DDFF">;</span></span>
<span class="line"><span style="color: #BABED8">        MessageBox</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">Show</span><span style="color: #89DDFF">(</span><span style="color: #BABED8">info</span><span style="color: #89DDFF">,</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">MessageBox</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">);</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #89DDFF">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #C792EA">private</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">void</span><span style="color: #BABED8"> </span><span style="color: #82AAFF">ShowNote</span><span style="color: #89DDFF">(</span><span style="color: #89DDFF">string</span><span style="color: #89DDFF">?</span><span style="color: #BABED8"> </span><span style="color: #FFCB6B">str</span><span style="color: #89DDFF">)</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #89DDFF">{</span></span>
<span class="line"><span style="color: #BABED8">        </span><span style="color: #89DDFF">string</span><span style="color: #BABED8"> </span><span style="color: #FFCB6B">info</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">=</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">$&quot;</span><span style="color: #C3E88D">Note: </span><span style="color: #89DDFF">{</span><span style="color: #BABED8">str</span><span style="color: #89DDFF">}&quot;</span><span style="color: #89DDFF">;</span></span>
<span class="line"><span style="color: #BABED8">        MessageBox</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">Show</span><span style="color: #89DDFF">(</span><span style="color: #BABED8">info</span><span style="color: #89DDFF">,</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">MessageBox</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">);</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #89DDFF">}</span></span>
<span class="line"><span style="color: #89DDFF">}</span></span></code></pre>
</div>
</div>



<p>替換成套件中的類別，程式碼不要說87%像，根本一模一樣啊?</p>



<p>這樣有什麼特別的嗎?</p>



<p>ToolKit.Mvvm 還提供的一些 Attribute 供使用，接下來看看此部分。</p>



<p><s>那麼，接下來就來看看，讓程式碼變短的魔法!</s></p>



<h2 class="wp-block-heading article_h2">
<span class="ez-toc-section" id="%e4%bd%bf%e7%94%a8%e5%a5%97%e4%bb%b6%e6%8f%90%e4%be%9b%e7%9a%84attribute"></span>使用套件提供的Attribute<span class="ez-toc-section-end"></span>
</h2>



<p>ViewModel 全部改用 Attribute 後的程式碼如下。</p>



<p>程式碼少將近一半，留下最主要的邏輯部分，並且還完全等同於上一段的程式碼，接下來將逐步解析程式碼，以便更好地理解其邏輯並正確的使用。</p>



<div class="wp-block-group is-vertical is-content-justification-stretch is-layout-flex wp-container-core-group-is-layout-11 wp-block-group-is-layout-flex">
<p>MainWindowViewModel02</p>



<div class="wp-block-kevinbatdorf-code-block-pro cbp-has-line-numbers" data-code-block-pro-font-family="Code-Pro-JetBrains-Mono" style="font-size:.875rem;font-family:Code-Pro-JetBrains-Mono,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;--cbp-line-number-color:#babed8;--cbp-line-number-width:calc(2 * 0.6 * .875rem);line-height:1.25rem;--cbp-tab-width:2;tab-size:var(--cbp-tab-width, 2)">
<span style="display:flex;align-items:center;padding:10px 0px 10px 16px;margin-bottom:-2px;width:100%;text-align:left;background-color:#181c2a;color:#aaafcf">C#</span><span role="button" tabindex="0" data-code="public partial class MainWindowViewModel02 : ObservableObject
{
    [ObservableProperty]
    [NotifyCanExecuteChangedFor(nameof(ShowInfoCommand))]
    private string? _name;

    [ObservableProperty]
    private string? _phone;

    private bool CanShowInfo()
    {
        return !string.IsNullOrEmpty(_name);
    }

    [RelayCommand(CanExecute = nameof(CanShowInfo))]
    private void ShowInfo()
    {
        string info = $&quot;Name: {Name}\nPhone: {Phone}&quot;;
        MessageBox.Show(info, &quot;MessageBox&quot;);
    }

    [RelayCommand]
    private void ShowNote(string? str)
    {
        string info = $&quot;Note: {str}&quot;;
        MessageBox.Show(info, &quot;MessageBox&quot;);
    }
}" style="color:#babed8;display:none" aria-label="Copy" class="code-block-pro-copy-button"><svg xmlns="http://www.w3.org/2000/svg" style="width:24px;height:24px" fill="none" viewbox="0 0 24 24" stroke="currentColor" stroke-width="2"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M4.5 12.75l6 6 9-13.5"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M16.5 8.25V6a2.25 2.25 0 00-2.25-2.25H6A2.25 2.25 0 003.75 6v8.25A2.25 2.25 0 006 16.5h2.25m8.25-8.25H18a2.25 2.25 0 012.25 2.25V18A2.25 2.25 0 0118 20.25h-7.5A2.25 2.25 0 018.25 18v-1.5m8.25-8.25h-6a2.25 2.25 0 00-2.25 2.25v6"></path></svg></span><pre class="shiki material-theme-ocean" style="background-color: #0F111A" tabindex="0"><code><span class="line"><span style="color: #C792EA">public</span><span style="color: #BABED8"> </span><span style="color: #C792EA">partial</span><span style="color: #BABED8"> </span><span style="color: #FFCB6B">class</span><span style="color: #BABED8"> </span><span style="color: #FFCB6B">MainWindowViewModel02</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">:</span><span style="color: #BABED8"> </span><span style="color: #FFCB6B">ObservableObject</span></span>
<span class="line"><span style="color: #89DDFF">{</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #89DDFF">[</span><span style="color: #FFCB6B">ObservableProperty</span><span style="color: #89DDFF">]</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #89DDFF">[</span><span style="color: #FFCB6B">NotifyCanExecuteChangedFor</span><span style="color: #89DDFF">(nameof(</span><span style="color: #BABED8">ShowInfoCommand</span><span style="color: #89DDFF">))]</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #C792EA">private</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">string</span><span style="color: #89DDFF">?</span><span style="color: #BABED8"> </span><span style="color: #FFCB6B">_name</span><span style="color: #89DDFF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #89DDFF">[</span><span style="color: #FFCB6B">ObservableProperty</span><span style="color: #89DDFF">]</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #C792EA">private</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">string</span><span style="color: #89DDFF">?</span><span style="color: #BABED8"> </span><span style="color: #FFCB6B">_phone</span><span style="color: #89DDFF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #C792EA">private</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">bool</span><span style="color: #BABED8"> </span><span style="color: #82AAFF">CanShowInfo</span><span style="color: #89DDFF">()</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #89DDFF">{</span></span>
<span class="line"><span style="color: #BABED8">        </span><span style="color: #89DDFF; font-style: italic">return</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">!</span><span style="color: #89DDFF">string</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">IsNullOrEmpty</span><span style="color: #89DDFF">(</span><span style="color: #BABED8">_name</span><span style="color: #89DDFF">);</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #89DDFF">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #89DDFF">[</span><span style="color: #FFCB6B">RelayCommand</span><span style="color: #89DDFF">(</span><span style="color: #FFCB6B">CanExecute</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">=</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">nameof(</span><span style="color: #BABED8">CanShowInfo</span><span style="color: #89DDFF">))]</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #C792EA">private</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">void</span><span style="color: #BABED8"> </span><span style="color: #82AAFF">ShowInfo</span><span style="color: #89DDFF">()</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #89DDFF">{</span></span>
<span class="line"><span style="color: #BABED8">        </span><span style="color: #89DDFF">string</span><span style="color: #BABED8"> </span><span style="color: #FFCB6B">info</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">=</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">$&quot;</span><span style="color: #C3E88D">Name: </span><span style="color: #89DDFF">{</span><span style="color: #BABED8">Name</span><span style="color: #89DDFF">}</span><span style="color: #BABED8">\n</span><span style="color: #C3E88D">Phone: </span><span style="color: #89DDFF">{</span><span style="color: #BABED8">Phone</span><span style="color: #89DDFF">}&quot;</span><span style="color: #89DDFF">;</span></span>
<span class="line"><span style="color: #BABED8">        MessageBox</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">Show</span><span style="color: #89DDFF">(</span><span style="color: #BABED8">info</span><span style="color: #89DDFF">,</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">MessageBox</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">);</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #89DDFF">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #89DDFF">[</span><span style="color: #FFCB6B">RelayCommand</span><span style="color: #89DDFF">]</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #C792EA">private</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">void</span><span style="color: #BABED8"> </span><span style="color: #82AAFF">ShowNote</span><span style="color: #89DDFF">(</span><span style="color: #89DDFF">string</span><span style="color: #89DDFF">?</span><span style="color: #BABED8"> </span><span style="color: #FFCB6B">str</span><span style="color: #89DDFF">)</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #89DDFF">{</span></span>
<span class="line"><span style="color: #BABED8">        </span><span style="color: #89DDFF">string</span><span style="color: #BABED8"> </span><span style="color: #FFCB6B">info</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">=</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">$&quot;</span><span style="color: #C3E88D">Note: </span><span style="color: #89DDFF">{</span><span style="color: #BABED8">str</span><span style="color: #89DDFF">}&quot;</span><span style="color: #89DDFF">;</span></span>
<span class="line"><span style="color: #BABED8">        MessageBox</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">Show</span><span style="color: #89DDFF">(</span><span style="color: #BABED8">info</span><span style="color: #89DDFF">,</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">MessageBox</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">);</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #89DDFF">}</span></span>
<span class="line"><span style="color: #89DDFF">}</span></span></code></pre>
</div>
</div>



<p>首先，要使用此套件的 Attribute 時，除了要繼承 <mark style="background-color:var(--theme-palette-color-9, rgba(255, 255, 255, 0.2))" class="has-inline-color has-palette-color-8-color">ObservableObject</mark> 以外，類別前面還需要加上 <mark style="background-color:var(--theme-palette-color-9, rgba(255, 255, 255, 0.2))" class="has-inline-color has-palette-color-8-color">partial</mark> 關鍵字，這樣加上對應的 Attribute 時，對應的程式碼便會自動產生。忘記加 <mark style="background-color:var(--theme-palette-color-9, rgba(255, 255, 255, 0.2))" class="has-inline-color has-palette-color-8-color">partial</mark> 關鍵字，使用了 Attrubute 也沒關係，IDE會提示的。</p>



<p>※補充：partial 這個關鍵字允許開發者將一個類別、結構、介面或方法的定義分散在兩個或更多的程式碼檔案中。</p>



<p>不過有個先決條件，專案的C#版本需要是C# 8.0以上，才能使用此套件的 Attribute 功能。如果版本不到，IDE便會提示 <mark style="background-color:var(--theme-palette-color-9, rgba(255, 255, 255, 0.2))" class="has-inline-color has-palette-color-8-color">MVVMTK0008</mark> 的錯誤提示。</p>



<figure class="wp-block-image size-large"><img decoding="async" src="https://i.imgur.com/truQ3mN.jpeg" alt="類別加入partial關鍵字"></figure>



<p>再來是 Attribute 的使用。</p>



<p>在撰寫 ViewModel 時，通常會需要綁定一些變數。在大多數情況下，會先撰寫私有變數，然後再寫相應的屬性。這些屬性不僅用於讀寫私有變數，還需要包含通知 View 變動的方法，如下圖中紅底部分。</p>



<p>然而，如果使用 <mark style="background-color:var(--theme-palette-color-9, rgba(255, 255, 255, 0.2))" class="has-inline-color has-palette-color-8-color">ObservableProperty</mark> Attribute，只需要在私有變數上方加上 <mark style="background-color:var(--theme-palette-color-9, rgba(255, 255, 255, 0.2))" class="has-inline-color has-palette-color-8-color">[ObservableProperty]</mark> 標註，就完成綁定屬性的撰寫，無需額外撰寫紅底部分的程式碼，如下圖中綠底部分所示。</p>



<div class="wp-block-group is-vertical is-content-justification-left is-layout-flex wp-container-core-group-is-layout-12 wp-block-group-is-layout-flex">
<p>紅底：標準使用</p>



<p>綠底：使用 Attribute</p>



<figure class="wp-block-image size-large is-style-default wp-duotone-unset-5"><img decoding="async" src="https://i.imgur.com/85bHAPG.jpeg" alt="Property改使用ObservableProperty Attribute"></figure>
</div>



<p>那麼為什麼加上 <mark style="background-color:var(--theme-palette-color-9, rgba(255, 255, 255, 0.2))" class="has-inline-color has-palette-color-8-color">ObservableProperty</mark> Attribute 就能達成這個效果呢?</p>



<p>此部分可參考文件註解的詳細說明，如下圖。</p>



<p>大致的意思是，在需要的變數前加上 <mark style="background-color:var(--theme-palette-color-9, rgba(255, 255, 255, 0.2))" class="has-inline-color has-palette-color-8-color">ObservableProperty</mark> Attribute 後，便會自動產生出公開屬性，包含 set 方法中使用 SetProperty。</p>



<p>而屬性的命名，則會自動根據使用的變數名稱來命名，支援小寫、底線、小m開頭。例如變數名稱為 phone、_phone、m_phone 時，自動產生的屬性則會叫做 Phone。</p>



<figure class="wp-block-image size-large"><img decoding="async" src="https://i.imgur.com/tUL375f.jpeg" alt="ObservableProperty Attribute使用原理"></figure>



<p>如果想看自動產生的程式碼，該怎麼做呢?</p>



<p>其中一個方式為，在撰寫的 ViewModel 上，右鍵 &gt; 移至定義 (或按F12)。</p>



<figure class="wp-block-image size-large"><img decoding="async" src="https://i.imgur.com/3nvVh2R.jpeg" alt="前往類別定義"></figure>



<p>如下圖，IDE會顯示所有定義該 ViewModel 的檔案，以圖中的狀況，前三個檔案都是自動產生的，這邊點選第一個檔案。</p>



<figure class="wp-block-image size-large"><img decoding="async" src="https://i.imgur.com/5sZDHZE.jpeg" alt="類別宣告列表"></figure>



<p>進入到該檔案後，如下圖，IDE會提示該檔案為自動產生的。</p>



<p>在內容中便可找到對應的 Property，同時能看到set方法中，還使用很多的方法，至於怎麼使用，後面的章節會在做說明。</p>



<figure class="wp-block-image size-large"><img decoding="async" src="https://i.imgur.com/hTdTeTX.jpeg" alt="套件自動產生的Property程式碼"></figure>



<p>如果在屬性中需要使用 CanExecute 通知方法，除了使用 <mark style="background-color:var(--theme-palette-color-9, rgba(255, 255, 255, 0.2))" class="has-inline-color has-palette-color-8-color">ObservableProperty</mark> 的同時，還需要加上 <mark style="background-color:var(--theme-palette-color-9, rgba(255, 255, 255, 0.2))" class="has-inline-color has-palette-color-8-color">NotifyCanExecuteChangedFor</mark> Attribute。</p>



<p>如下圖所示，紅底的區域的程式碼可以用綠底的兩個 Attribute 取代，並且將要執行通知的 Command 填入 <mark style="background-color:var(--theme-palette-color-9, rgba(255, 255, 255, 0.2))" class="has-inline-color has-palette-color-8-color">NotifyCanExecuteChangedFor</mark> Attribute 的參數中。</p>



<div class="wp-block-group is-vertical is-content-justification-left is-layout-flex wp-container-core-group-is-layout-13 wp-block-group-is-layout-flex">
<p>紅底：標準使用</p>



<p>綠底：使用 Attribute</p>



<figure class="wp-block-image size-large is-style-default wp-duotone-unset-6"><img decoding="async" src="https://i.imgur.com/4PI6R5u.png" alt="Property使用NotifyCanExecuteChangedFor Attribute"></figure>
</div>



<p>除了 Property 可以使用 Attribute 外，Command 也有方便的 Attribute 可以使用。</p>



<p>使用方法也很簡單，只需要在 Command 呼叫時要執行的方法上面，加上 <mark style="background-color:var(--theme-palette-color-9, rgba(255, 255, 255, 0.2))" class="has-inline-color has-palette-color-8-color">[RelayCommand]</mark> 標註即可，如下圖，紅底的區域的程式碼，由兩個綠底的中的Attribute取代。</p>



<p>若要使用 CanExecute 方法，則在 RelayCommand 的 Attribute 中設定 CanExecute 的參數指定要使用的方法。</p>



<div class="wp-block-group is-vertical is-content-justification-left is-layout-flex wp-container-core-group-is-layout-14 wp-block-group-is-layout-flex">
<p>紅底：標準使用</p>



<p>綠底：使用 Attribute</p>



<figure class="wp-block-image size-large is-style-default wp-duotone-unset-7"><img decoding="async" src="https://i.imgur.com/mU2ILuw.png" alt="使用RelayCommand Attribute"></figure>
</div>



<p>套件內雖然有分 <mark style="background-color:var(--theme-palette-color-9, rgba(255, 255, 255, 0.2))" class="has-inline-color has-palette-color-8-color">RelayCommand</mark> 與 <mark style="background-color:var(--theme-palette-color-9, rgba(255, 255, 255, 0.2))" class="has-inline-color has-palette-color-8-color">RelayCommand&lt;T&gt;</mark> 兩種類別，不過 Attribute 都是使用 <mark style="background-color:var(--theme-palette-color-9, rgba(255, 255, 255, 0.2))" class="has-inline-color has-palette-color-8-color">RelayCommand</mark>，自動產生程式碼會根據方法的定義，自動使用對應的類別。</p>



<p>至於自動產生的 Command 命名規則，通常會是方法名加上 &#8220;Command&#8221; 。例如，在範例程式中 ShowInfo 方法上使用，自動產生的 Command 就會命名為 ShowInfoCommand。</p>



<p>上述的詳細資訊，可至自動產生的程式碼檔案中看到，如下圖所示。</p>



<figure class="wp-block-image size-large"><img decoding="async" src="https://i.imgur.com/EETmWLX.png" alt="自動產生的RelayCommand程式碼"></figure>



<p>以上便是範例程式替換成套件內提供的 Attribute 的情況。該範例基本上涵蓋了寫 ViewModel 時較常用到的程式碼。</p>



<p>接下來，將進一步延伸使用 Attribute 的範例，來探索套件內其他功能。</p>



<h2 class="wp-block-heading article_h2">
<span class="ez-toc-section" id="%e5%b1%ac%e6%80%a7%e8%ae%8a%e6%9b%b4%e6%99%82%e7%9a%84%e9%a1%8d%e5%a4%96%e8%99%95%e7%90%86"></span>屬性變更時的額外處理<span class="ez-toc-section-end"></span>
</h2>



<p>當ViewModel程式中使用了 <mark style="background-color:var(--theme-palette-color-9, rgba(255, 255, 255, 0.2))" class="has-inline-color has-palette-color-8-color">ObservableProperty</mark> Attribute ，但同時又想在Property的set過程中執行一些額外的操作時，該怎麼辦呢?</p>



<p>這時候，可以試著使用自動產生的 partial 方法來處理看看。</p>



<p>當進入到自動產生的 Property 程式碼中，在 set 方法中可以看到中間會有以該屬性名的 <mark style="background-color:var(--theme-palette-color-9, rgba(255, 255, 255, 0.2))" class="has-inline-color has-palette-color-8-color">OnXxxChanging()</mark> 、 <mark style="background-color:var(--theme-palette-color-9, rgba(255, 255, 255, 0.2))" class="has-inline-color has-palette-color-8-color">OnXxxChanged()</mark> 方法。如下圖，像是 Name 屬性便有 OnNameChaging() 、OnNameChaged()，而 Phone 屬性則是有 OnPhoneChaging() 、OnPhoneChaged() 。</p>



<p>那這些方法是怎麼定義的呢?</p>



<figure class="wp-block-image size-large"><img decoding="async" src="https://i.imgur.com/cp3htR8.png" alt="自動產生的Property程式碼"></figure>



<p>在自動產生的程式碼部分繼續往下拉，可以看到方法的定義。</p>



<p>這些 Changing 、 Changed 方法，都是宣告為 <mark style="background-color:var(--theme-palette-color-9, rgba(255, 255, 255, 0.2))" class="has-inline-color has-palette-color-8-color">partial</mark> ，這樣只要挑選需要的方法，並在 ViewModel 中實作即可。</p>



<figure class="wp-block-image size-large"><img decoding="async" src="https://i.imgur.com/TGEAe4M.png" alt="自動產生的partial方法定義"></figure>



<p>例如，把下面的 partial void OnNameChanged 程式，寫到 ViewMode l中。</p>



<p>這段程式，會在 _name = value 之後，檢查value是否為空，如果是的話，就把 Phone 屬性設為空字串。</p>



<p>基本上，在自動產生的程式碼中確認方法呼叫的時機，並將要實現的方法定義複製到 ViewModel 中，再撰寫需要的程式邏輯即可。</p>



<div class="wp-block-group is-vertical is-content-justification-stretch is-layout-flex wp-container-core-group-is-layout-15 wp-block-group-is-layout-flex">
<p>使用 partial 方法</p>



<div class="wp-block-kevinbatdorf-code-block-pro cbp-has-line-numbers" data-code-block-pro-font-family="Code-Pro-JetBrains-Mono" style="font-size:.875rem;font-family:Code-Pro-JetBrains-Mono,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;--cbp-line-number-color:#babed8;--cbp-line-number-width:calc(1 * 0.6 * .875rem);line-height:1.25rem;--cbp-tab-width:2;tab-size:var(--cbp-tab-width, 2)">
<span style="display:flex;align-items:center;padding:10px 0px 10px 16px;margin-bottom:-2px;width:100%;text-align:left;background-color:#181c2a;color:#aaafcf">C#</span><span role="button" tabindex="0" data-code="partial void OnNameChanged(string? value)
{
    if (string.IsNullOrEmpty(value))
    {
        Phone = &quot;&quot;;
    }

    Console.WriteLine(value);
}" style="color:#babed8;display:none" aria-label="Copy" class="code-block-pro-copy-button"><svg xmlns="http://www.w3.org/2000/svg" style="width:24px;height:24px" fill="none" viewbox="0 0 24 24" stroke="currentColor" stroke-width="2"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M4.5 12.75l6 6 9-13.5"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M16.5 8.25V6a2.25 2.25 0 00-2.25-2.25H6A2.25 2.25 0 003.75 6v8.25A2.25 2.25 0 006 16.5h2.25m8.25-8.25H18a2.25 2.25 0 012.25 2.25V18A2.25 2.25 0 0118 20.25h-7.5A2.25 2.25 0 018.25 18v-1.5m8.25-8.25h-6a2.25 2.25 0 00-2.25 2.25v6"></path></svg></span><pre class="shiki material-theme-ocean" style="background-color: #0F111A" tabindex="0"><code><span class="line"><span style="color: #C792EA">partial</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">void</span><span style="color: #BABED8"> </span><span style="color: #82AAFF">OnNameChanged</span><span style="color: #89DDFF">(</span><span style="color: #89DDFF">string</span><span style="color: #89DDFF">?</span><span style="color: #BABED8"> </span><span style="color: #FFCB6B">value</span><span style="color: #89DDFF">)</span></span>
<span class="line"><span style="color: #89DDFF">{</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #89DDFF; font-style: italic">if</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">(</span><span style="color: #89DDFF">string</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">IsNullOrEmpty</span><span style="color: #89DDFF">(</span><span style="color: #BABED8">value</span><span style="color: #89DDFF">))</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #89DDFF">{</span></span>
<span class="line"><span style="color: #BABED8">        Phone </span><span style="color: #89DDFF">=</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">&quot;&quot;</span><span style="color: #89DDFF">;</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #89DDFF">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #BABED8">    Console</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">WriteLine</span><span style="color: #89DDFF">(</span><span style="color: #BABED8">value</span><span style="color: #89DDFF">);</span></span>
<span class="line"><span style="color: #89DDFF">}</span></span></code></pre>
</div>
</div>



<p>附上完整的程式碼。</p>



<div class="wp-block-group is-vertical is-content-justification-stretch is-layout-flex wp-container-core-group-is-layout-16 wp-block-group-is-layout-flex">
<p>MainWindowViewModel03</p>



<div class="wp-block-kevinbatdorf-code-block-pro cbp-has-line-numbers" data-code-block-pro-font-family="Code-Pro-JetBrains-Mono" style="font-size:.875rem;font-family:Code-Pro-JetBrains-Mono,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;--cbp-line-number-color:#babed8;--cbp-line-number-width:calc(2 * 0.6 * .875rem);line-height:1.25rem;--cbp-tab-width:2;tab-size:var(--cbp-tab-width, 2)">
<span style="display:flex;align-items:center;padding:10px 0px 10px 16px;margin-bottom:-2px;width:100%;text-align:left;background-color:#181c2a;color:#aaafcf">C#</span><span role="button" tabindex="0" data-code="public partial class MainWindowViewModel03 : ObservableObject
{
    [ObservableProperty]
    [NotifyCanExecuteChangedFor(nameof(ShowInfoCommand))]
    private string? _name;

    [ObservableProperty]
    private string? _phone;

    partial void OnNameChanged(string? value)
    {
        if (string.IsNullOrEmpty(value))
        {
            Phone = &quot;&quot;;
        }

        Console.WriteLine(value);
    }

    private bool CanShowInfo()
    {
        return !string.IsNullOrEmpty(_name);
    }

    [RelayCommand(CanExecute = nameof(CanShowInfo))]
    private void ShowInfo()
    {
        string info = $&quot;Name: {Name}\nPhone: {Phone}&quot;;
        MessageBox.Show(info, &quot;MessageBox&quot;);
    }

    [RelayCommand]
    private void ShowNote(string? str)
    {
        string info = $&quot;Note: {str}&quot;;
        MessageBox.Show(info, &quot;MessageBox&quot;);
    }
}" style="color:#babed8;display:none" aria-label="Copy" class="code-block-pro-copy-button"><svg xmlns="http://www.w3.org/2000/svg" style="width:24px;height:24px" fill="none" viewbox="0 0 24 24" stroke="currentColor" stroke-width="2"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M4.5 12.75l6 6 9-13.5"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M16.5 8.25V6a2.25 2.25 0 00-2.25-2.25H6A2.25 2.25 0 003.75 6v8.25A2.25 2.25 0 006 16.5h2.25m8.25-8.25H18a2.25 2.25 0 012.25 2.25V18A2.25 2.25 0 0118 20.25h-7.5A2.25 2.25 0 018.25 18v-1.5m8.25-8.25h-6a2.25 2.25 0 00-2.25 2.25v6"></path></svg></span><pre class="shiki material-theme-ocean" style="background-color: #0F111A" tabindex="0"><code><span class="line"><span style="color: #C792EA">public</span><span style="color: #BABED8"> </span><span style="color: #C792EA">partial</span><span style="color: #BABED8"> </span><span style="color: #FFCB6B">class</span><span style="color: #BABED8"> </span><span style="color: #FFCB6B">MainWindowViewModel03</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">:</span><span style="color: #BABED8"> </span><span style="color: #FFCB6B">ObservableObject</span></span>
<span class="line"><span style="color: #89DDFF">{</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #89DDFF">[</span><span style="color: #FFCB6B">ObservableProperty</span><span style="color: #89DDFF">]</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #89DDFF">[</span><span style="color: #FFCB6B">NotifyCanExecuteChangedFor</span><span style="color: #89DDFF">(nameof(</span><span style="color: #BABED8">ShowInfoCommand</span><span style="color: #89DDFF">))]</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #C792EA">private</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">string</span><span style="color: #89DDFF">?</span><span style="color: #BABED8"> </span><span style="color: #FFCB6B">_name</span><span style="color: #89DDFF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #89DDFF">[</span><span style="color: #FFCB6B">ObservableProperty</span><span style="color: #89DDFF">]</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #C792EA">private</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">string</span><span style="color: #89DDFF">?</span><span style="color: #BABED8"> </span><span style="color: #FFCB6B">_phone</span><span style="color: #89DDFF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #C792EA">partial</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">void</span><span style="color: #BABED8"> </span><span style="color: #82AAFF">OnNameChanged</span><span style="color: #89DDFF">(</span><span style="color: #89DDFF">string</span><span style="color: #89DDFF">?</span><span style="color: #BABED8"> </span><span style="color: #FFCB6B">value</span><span style="color: #89DDFF">)</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #89DDFF">{</span></span>
<span class="line"><span style="color: #BABED8">        </span><span style="color: #89DDFF; font-style: italic">if</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">(</span><span style="color: #89DDFF">string</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">IsNullOrEmpty</span><span style="color: #89DDFF">(</span><span style="color: #BABED8">value</span><span style="color: #89DDFF">))</span></span>
<span class="line"><span style="color: #BABED8">        </span><span style="color: #89DDFF">{</span></span>
<span class="line"><span style="color: #BABED8">            Phone </span><span style="color: #89DDFF">=</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">&quot;&quot;</span><span style="color: #89DDFF">;</span></span>
<span class="line"><span style="color: #BABED8">        </span><span style="color: #89DDFF">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #BABED8">        Console</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">WriteLine</span><span style="color: #89DDFF">(</span><span style="color: #BABED8">value</span><span style="color: #89DDFF">);</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #89DDFF">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #C792EA">private</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">bool</span><span style="color: #BABED8"> </span><span style="color: #82AAFF">CanShowInfo</span><span style="color: #89DDFF">()</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #89DDFF">{</span></span>
<span class="line"><span style="color: #BABED8">        </span><span style="color: #89DDFF; font-style: italic">return</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">!</span><span style="color: #89DDFF">string</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">IsNullOrEmpty</span><span style="color: #89DDFF">(</span><span style="color: #BABED8">_name</span><span style="color: #89DDFF">);</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #89DDFF">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #89DDFF">[</span><span style="color: #FFCB6B">RelayCommand</span><span style="color: #89DDFF">(</span><span style="color: #FFCB6B">CanExecute</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">=</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">nameof(</span><span style="color: #BABED8">CanShowInfo</span><span style="color: #89DDFF">))]</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #C792EA">private</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">void</span><span style="color: #BABED8"> </span><span style="color: #82AAFF">ShowInfo</span><span style="color: #89DDFF">()</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #89DDFF">{</span></span>
<span class="line"><span style="color: #BABED8">        </span><span style="color: #89DDFF">string</span><span style="color: #BABED8"> </span><span style="color: #FFCB6B">info</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">=</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">$&quot;</span><span style="color: #C3E88D">Name: </span><span style="color: #89DDFF">{</span><span style="color: #BABED8">Name</span><span style="color: #89DDFF">}</span><span style="color: #BABED8">\n</span><span style="color: #C3E88D">Phone: </span><span style="color: #89DDFF">{</span><span style="color: #BABED8">Phone</span><span style="color: #89DDFF">}&quot;</span><span style="color: #89DDFF">;</span></span>
<span class="line"><span style="color: #BABED8">        MessageBox</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">Show</span><span style="color: #89DDFF">(</span><span style="color: #BABED8">info</span><span style="color: #89DDFF">,</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">MessageBox</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">);</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #89DDFF">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #89DDFF">[</span><span style="color: #FFCB6B">RelayCommand</span><span style="color: #89DDFF">]</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #C792EA">private</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">void</span><span style="color: #BABED8"> </span><span style="color: #82AAFF">ShowNote</span><span style="color: #89DDFF">(</span><span style="color: #89DDFF">string</span><span style="color: #89DDFF">?</span><span style="color: #BABED8"> </span><span style="color: #FFCB6B">str</span><span style="color: #89DDFF">)</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #89DDFF">{</span></span>
<span class="line"><span style="color: #BABED8">        </span><span style="color: #89DDFF">string</span><span style="color: #BABED8"> </span><span style="color: #FFCB6B">info</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">=</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">$&quot;</span><span style="color: #C3E88D">Note: </span><span style="color: #89DDFF">{</span><span style="color: #BABED8">str</span><span style="color: #89DDFF">}&quot;</span><span style="color: #89DDFF">;</span></span>
<span class="line"><span style="color: #BABED8">        MessageBox</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">Show</span><span style="color: #89DDFF">(</span><span style="color: #BABED8">info</span><span style="color: #89DDFF">,</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">MessageBox</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">);</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #89DDFF">}</span></span>
<span class="line"><span style="color: #89DDFF">}</span></span></code></pre>
</div>
</div>



<h2 class="wp-block-heading article_h2">
<span class="ez-toc-section" id="%e4%bd%bf%e7%94%a8%e7%95%b0%e6%ad%a5command"></span>使用異步Command<span class="ez-toc-section-end"></span>
</h2>



<p>CommunityToolkit.Mvvm 套件， Command 的部分，除了提供了 </p>



<ul>
<li>RelayCommand</li>



<li>RealyCommand&lt;T&gt;</li>
</ul>



<p>除此之外，如果有異步程式的需要，也有提供</p>



<ul>
<li>AsyncRelayCommand</li>



<li>AsyncRelayCommand&lt;T&gt; </li>
</ul>



<p>這兩種 Command 類別供使用。</p>



<p>而在使用上，可以像一般情況下那樣宣告 <mark style="background-color:var(--theme-palette-color-9, rgba(255, 255, 255, 0.2))" class="has-inline-color has-palette-color-8-color">AsyncRelayCommand</mark> 並使用 new 來實例化。</p>



<p>個人還是推薦使用 Attribute ，如下面的程式碼所示，跟之前的程式碼基本相同，方法上方加上 <mark style="background-color:var(--theme-palette-color-9, rgba(255, 255, 255, 0.2))" class="has-inline-color has-palette-color-8-color">[RelayCommand]</mark> 標註即可，而差別則是回傳型別，從 void 改成 async Task 。自動產生程式碼就會自動去變更並使用 <mark style="background-color:var(--theme-palette-color-9, rgba(255, 255, 255, 0.2))" class="has-inline-color has-palette-color-8-color">AsyncRelayCommand</mark>  。</p>



<div class="wp-block-group is-vertical is-content-justification-stretch is-layout-flex wp-container-core-group-is-layout-17 wp-block-group-is-layout-flex">
<p>使用AsyncRelayCommand</p>



<div class="wp-block-kevinbatdorf-code-block-pro cbp-has-line-numbers" data-code-block-pro-font-family="Code-Pro-JetBrains-Mono" style="font-size:.875rem;font-family:Code-Pro-JetBrains-Mono,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;--cbp-line-number-color:#babed8;--cbp-line-number-width:calc(2 * 0.6 * .875rem);line-height:1.25rem;--cbp-tab-width:2;tab-size:var(--cbp-tab-width, 2)">
<span style="display:flex;align-items:center;padding:10px 0px 10px 16px;margin-bottom:-2px;width:100%;text-align:left;background-color:#181c2a;color:#aaafcf">C#</span><span role="button" tabindex="0" data-code="[RelayCommand(CanExecute = nameof(CanShowInfo))]
private async Task ShowInfo()
{
    await Task.Delay(500);
    string info = $&quot;Name: {Name}\nPhone: {Phone}&quot;;
    MessageBox.Show(info, &quot;MessageBox&quot;);
}

[RelayCommand]
private async Task ShowNote(string? str)
{
    await Task.Delay(500);
    string info = $&quot;Note: {str}&quot;;
    MessageBox.Show(info, &quot;MessageBox&quot;);
}" style="color:#babed8;display:none" aria-label="Copy" class="code-block-pro-copy-button"><svg xmlns="http://www.w3.org/2000/svg" style="width:24px;height:24px" fill="none" viewbox="0 0 24 24" stroke="currentColor" stroke-width="2"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M4.5 12.75l6 6 9-13.5"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M16.5 8.25V6a2.25 2.25 0 00-2.25-2.25H6A2.25 2.25 0 003.75 6v8.25A2.25 2.25 0 006 16.5h2.25m8.25-8.25H18a2.25 2.25 0 012.25 2.25V18A2.25 2.25 0 0118 20.25h-7.5A2.25 2.25 0 018.25 18v-1.5m8.25-8.25h-6a2.25 2.25 0 00-2.25 2.25v6"></path></svg></span><pre class="shiki material-theme-ocean" style="background-color: #0F111A" tabindex="0"><code><span class="line"><span style="color: #89DDFF">[</span><span style="color: #FFCB6B">RelayCommand</span><span style="color: #89DDFF">(</span><span style="color: #FFCB6B">CanExecute</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">=</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">nameof(</span><span style="color: #BABED8">CanShowInfo</span><span style="color: #89DDFF">))]</span></span>
<span class="line"><span style="color: #C792EA">private</span><span style="color: #BABED8"> </span><span style="color: #C792EA">async</span><span style="color: #BABED8"> </span><span style="color: #FFCB6B">Task</span><span style="color: #BABED8"> </span><span style="color: #82AAFF">ShowInfo</span><span style="color: #89DDFF">()</span></span>
<span class="line"><span style="color: #89DDFF">{</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #89DDFF">await</span><span style="color: #BABED8"> Task</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">Delay</span><span style="color: #89DDFF">(</span><span style="color: #F78C6C">500</span><span style="color: #89DDFF">);</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #89DDFF">string</span><span style="color: #BABED8"> </span><span style="color: #FFCB6B">info</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">=</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">$&quot;</span><span style="color: #C3E88D">Name: </span><span style="color: #89DDFF">{</span><span style="color: #BABED8">Name</span><span style="color: #89DDFF">}</span><span style="color: #BABED8">\n</span><span style="color: #C3E88D">Phone: </span><span style="color: #89DDFF">{</span><span style="color: #BABED8">Phone</span><span style="color: #89DDFF">}&quot;</span><span style="color: #89DDFF">;</span></span>
<span class="line"><span style="color: #BABED8">    MessageBox</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">Show</span><span style="color: #89DDFF">(</span><span style="color: #BABED8">info</span><span style="color: #89DDFF">,</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">MessageBox</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">);</span></span>
<span class="line"><span style="color: #89DDFF">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #89DDFF">[</span><span style="color: #FFCB6B">RelayCommand</span><span style="color: #89DDFF">]</span></span>
<span class="line"><span style="color: #C792EA">private</span><span style="color: #BABED8"> </span><span style="color: #C792EA">async</span><span style="color: #BABED8"> </span><span style="color: #FFCB6B">Task</span><span style="color: #BABED8"> </span><span style="color: #82AAFF">ShowNote</span><span style="color: #89DDFF">(</span><span style="color: #89DDFF">string</span><span style="color: #89DDFF">?</span><span style="color: #BABED8"> </span><span style="color: #FFCB6B">str</span><span style="color: #89DDFF">)</span></span>
<span class="line"><span style="color: #89DDFF">{</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #89DDFF">await</span><span style="color: #BABED8"> Task</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">Delay</span><span style="color: #89DDFF">(</span><span style="color: #F78C6C">500</span><span style="color: #89DDFF">);</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #89DDFF">string</span><span style="color: #BABED8"> </span><span style="color: #FFCB6B">info</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">=</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">$&quot;</span><span style="color: #C3E88D">Note: </span><span style="color: #89DDFF">{</span><span style="color: #BABED8">str</span><span style="color: #89DDFF">}&quot;</span><span style="color: #89DDFF">;</span></span>
<span class="line"><span style="color: #BABED8">    MessageBox</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">Show</span><span style="color: #89DDFF">(</span><span style="color: #BABED8">info</span><span style="color: #89DDFF">,</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">MessageBox</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">);</span></span>
<span class="line"><span style="color: #89DDFF">}</span></span></code></pre>
</div>
</div>



<p>附上完整的程式碼。</p>



<div class="wp-block-group is-vertical is-content-justification-stretch is-layout-flex wp-container-core-group-is-layout-18 wp-block-group-is-layout-flex">
<p>MainWindowViewModel04</p>



<div class="wp-block-kevinbatdorf-code-block-pro cbp-has-line-numbers" data-code-block-pro-font-family="Code-Pro-JetBrains-Mono" style="font-size:.875rem;font-family:Code-Pro-JetBrains-Mono,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;--cbp-line-number-color:#babed8;--cbp-line-number-width:calc(2 * 0.6 * .875rem);line-height:1.25rem;--cbp-tab-width:2;tab-size:var(--cbp-tab-width, 2)">
<span style="display:flex;align-items:center;padding:10px 0px 10px 16px;margin-bottom:-2px;width:100%;text-align:left;background-color:#181c2a;color:#aaafcf">C#</span><span role="button" tabindex="0" data-code="public partial class MainWindowViewModel04 : ObservableObject
{
    [ObservableProperty]
    [NotifyCanExecuteChangedFor(nameof(ShowInfoCommand))]
    private string? _name;

    [ObservableProperty]
    private string? _phone;

    private bool CanShowInfo()
    {
        return !string.IsNullOrEmpty(_name);
    }

    [RelayCommand(CanExecute = nameof(CanShowInfo))]
    private async Task ShowInfo()
    {
        await Task.Delay(500);
        string info = $&quot;Name: {Name}\nPhone: {Phone}&quot;;
        MessageBox.Show(info, &quot;MessageBox&quot;);
    }

    [RelayCommand]
    private async Task ShowNote(string? str)
    {
        await Task.Delay(500);
        string info = $&quot;Note: {str}&quot;;
        MessageBox.Show(info, &quot;MessageBox&quot;);
    }
}" style="color:#babed8;display:none" aria-label="Copy" class="code-block-pro-copy-button"><svg xmlns="http://www.w3.org/2000/svg" style="width:24px;height:24px" fill="none" viewbox="0 0 24 24" stroke="currentColor" stroke-width="2"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M4.5 12.75l6 6 9-13.5"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M16.5 8.25V6a2.25 2.25 0 00-2.25-2.25H6A2.25 2.25 0 003.75 6v8.25A2.25 2.25 0 006 16.5h2.25m8.25-8.25H18a2.25 2.25 0 012.25 2.25V18A2.25 2.25 0 0118 20.25h-7.5A2.25 2.25 0 018.25 18v-1.5m8.25-8.25h-6a2.25 2.25 0 00-2.25 2.25v6"></path></svg></span><pre class="shiki material-theme-ocean" style="background-color: #0F111A" tabindex="0"><code><span class="line"><span style="color: #C792EA">public</span><span style="color: #BABED8"> </span><span style="color: #C792EA">partial</span><span style="color: #BABED8"> </span><span style="color: #FFCB6B">class</span><span style="color: #BABED8"> </span><span style="color: #FFCB6B">MainWindowViewModel04</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">:</span><span style="color: #BABED8"> </span><span style="color: #FFCB6B">ObservableObject</span></span>
<span class="line"><span style="color: #89DDFF">{</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #89DDFF">[</span><span style="color: #FFCB6B">ObservableProperty</span><span style="color: #89DDFF">]</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #89DDFF">[</span><span style="color: #FFCB6B">NotifyCanExecuteChangedFor</span><span style="color: #89DDFF">(nameof(</span><span style="color: #BABED8">ShowInfoCommand</span><span style="color: #89DDFF">))]</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #C792EA">private</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">string</span><span style="color: #89DDFF">?</span><span style="color: #BABED8"> </span><span style="color: #FFCB6B">_name</span><span style="color: #89DDFF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #89DDFF">[</span><span style="color: #FFCB6B">ObservableProperty</span><span style="color: #89DDFF">]</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #C792EA">private</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">string</span><span style="color: #89DDFF">?</span><span style="color: #BABED8"> </span><span style="color: #FFCB6B">_phone</span><span style="color: #89DDFF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #C792EA">private</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">bool</span><span style="color: #BABED8"> </span><span style="color: #82AAFF">CanShowInfo</span><span style="color: #89DDFF">()</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #89DDFF">{</span></span>
<span class="line"><span style="color: #BABED8">        </span><span style="color: #89DDFF; font-style: italic">return</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">!</span><span style="color: #89DDFF">string</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">IsNullOrEmpty</span><span style="color: #89DDFF">(</span><span style="color: #BABED8">_name</span><span style="color: #89DDFF">);</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #89DDFF">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #89DDFF">[</span><span style="color: #FFCB6B">RelayCommand</span><span style="color: #89DDFF">(</span><span style="color: #FFCB6B">CanExecute</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">=</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">nameof(</span><span style="color: #BABED8">CanShowInfo</span><span style="color: #89DDFF">))]</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #C792EA">private</span><span style="color: #BABED8"> </span><span style="color: #C792EA">async</span><span style="color: #BABED8"> </span><span style="color: #FFCB6B">Task</span><span style="color: #BABED8"> </span><span style="color: #82AAFF">ShowInfo</span><span style="color: #89DDFF">()</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #89DDFF">{</span></span>
<span class="line"><span style="color: #BABED8">        </span><span style="color: #89DDFF">await</span><span style="color: #BABED8"> Task</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">Delay</span><span style="color: #89DDFF">(</span><span style="color: #F78C6C">500</span><span style="color: #89DDFF">);</span></span>
<span class="line"><span style="color: #BABED8">        </span><span style="color: #89DDFF">string</span><span style="color: #BABED8"> </span><span style="color: #FFCB6B">info</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">=</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">$&quot;</span><span style="color: #C3E88D">Name: </span><span style="color: #89DDFF">{</span><span style="color: #BABED8">Name</span><span style="color: #89DDFF">}</span><span style="color: #BABED8">\n</span><span style="color: #C3E88D">Phone: </span><span style="color: #89DDFF">{</span><span style="color: #BABED8">Phone</span><span style="color: #89DDFF">}&quot;</span><span style="color: #89DDFF">;</span></span>
<span class="line"><span style="color: #BABED8">        MessageBox</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">Show</span><span style="color: #89DDFF">(</span><span style="color: #BABED8">info</span><span style="color: #89DDFF">,</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">MessageBox</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">);</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #89DDFF">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #89DDFF">[</span><span style="color: #FFCB6B">RelayCommand</span><span style="color: #89DDFF">]</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #C792EA">private</span><span style="color: #BABED8"> </span><span style="color: #C792EA">async</span><span style="color: #BABED8"> </span><span style="color: #FFCB6B">Task</span><span style="color: #BABED8"> </span><span style="color: #82AAFF">ShowNote</span><span style="color: #89DDFF">(</span><span style="color: #89DDFF">string</span><span style="color: #89DDFF">?</span><span style="color: #BABED8"> </span><span style="color: #FFCB6B">str</span><span style="color: #89DDFF">)</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #89DDFF">{</span></span>
<span class="line"><span style="color: #BABED8">        </span><span style="color: #89DDFF">await</span><span style="color: #BABED8"> Task</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">Delay</span><span style="color: #89DDFF">(</span><span style="color: #F78C6C">500</span><span style="color: #89DDFF">);</span></span>
<span class="line"><span style="color: #BABED8">        </span><span style="color: #89DDFF">string</span><span style="color: #BABED8"> </span><span style="color: #FFCB6B">info</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">=</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">$&quot;</span><span style="color: #C3E88D">Note: </span><span style="color: #89DDFF">{</span><span style="color: #BABED8">str</span><span style="color: #89DDFF">}&quot;</span><span style="color: #89DDFF">;</span></span>
<span class="line"><span style="color: #BABED8">        MessageBox</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">Show</span><span style="color: #89DDFF">(</span><span style="color: #BABED8">info</span><span style="color: #89DDFF">,</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">MessageBox</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">);</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #89DDFF">}</span></span>
<span class="line"><span style="color: #89DDFF">}</span></span></code></pre>
</div>
</div>



<h2 class="wp-block-heading article_h2">
<span class="ez-toc-section" id="%e6%99%ae%e9%80%9a%e9%a1%9e%e5%88%a5%e4%bd%bf%e7%94%a8-attribute"></span>普通類別使用 Attribute<span class="ez-toc-section-end"></span>
</h2>



<p>當使用的類別已經繼承了其他父類別，但由於 C# 不支援多重繼承，因此無法直接繼承 <mark style="background-color:var(--theme-palette-color-9, rgba(255, 255, 255, 0.2))" class="has-inline-color has-palette-color-8-color">ObservableObject</mark> 來創建 ViewModel 類別，在這種情況下，該怎麼處理呢?</p>



<p>針對這樣的情況，套件中提供了 <mark style="background-color:var(--theme-palette-color-9, rgba(255, 255, 255, 0.2))" class="has-inline-color has-palette-color-8-color">ObservableObject</mark> Attribute。</p>



<p>如下面的程式碼所示，ViewModel 已經繼承了其他類別，此時將該類別宣告為 <mark style="background-color:var(--theme-palette-color-9, rgba(255, 255, 255, 0.2))" class="has-inline-color has-palette-color-8-color">partial</mark> ，並且在類別上方加上 <mark style="background-color:var(--theme-palette-color-9, rgba(255, 255, 255, 0.2))" class="has-inline-color has-palette-color-8-color">[ObservableObject]</mark> 標註，這樣該類別就等同於繼承了 <mark style="background-color:var(--theme-palette-color-9, rgba(255, 255, 255, 0.2))" class="has-inline-color has-palette-color-8-color">ObservableObject</mark> 。</p>



<p>MainWindowViewModel05</p>



<div class="wp-block-group is-vertical is-content-justification-stretch is-layout-flex wp-container-core-group-is-layout-19 wp-block-group-is-layout-flex">
<div class="wp-block-kevinbatdorf-code-block-pro cbp-has-line-numbers" data-code-block-pro-font-family="Code-Pro-JetBrains-Mono" style="font-size:.875rem;font-family:Code-Pro-JetBrains-Mono,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;--cbp-line-number-color:#babed8;--cbp-line-number-width:calc(2 * 0.6 * .875rem);line-height:1.25rem;--cbp-tab-width:2;tab-size:var(--cbp-tab-width, 2)">
<span style="display:flex;align-items:center;padding:10px 0px 10px 16px;margin-bottom:-2px;width:100%;text-align:left;background-color:#181c2a;color:#aaafcf">C#</span><span role="button" tabindex="0" data-code="// 示範用父類別
public class SomeOtherClass
{
    protected string someString = &quot;Some string&quot;;
}

// 使用ObservableObject Attribute
[ObservableObject]
public partial class MainWindowViewModel05 : SomeOtherClass
{
    [ObservableProperty]
    [NotifyCanExecuteChangedFor(nameof(ShowInfoCommand))]
    private string? _name;

    [ObservableProperty]
    private string? _phone;

    private bool CanShowInfo()
    {
        return !string.IsNullOrEmpty(_name);
    }

    [RelayCommand(CanExecute = nameof(CanShowInfo))]
    private void ShowInfo()
    {
        string info = $&quot;Name: {Name}\nPhone: {Phone}&quot;;
        MessageBox.Show(info, &quot;MessageBox&quot;);
    }

    [RelayCommand]
    private void ShowNote(string? str)
    {
        string info = $&quot;Note: {str}&quot;;
        MessageBox.Show(info, &quot;MessageBox&quot;);
    }
}" style="color:#babed8;display:none" aria-label="Copy" class="code-block-pro-copy-button"><svg xmlns="http://www.w3.org/2000/svg" style="width:24px;height:24px" fill="none" viewbox="0 0 24 24" stroke="currentColor" stroke-width="2"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M4.5 12.75l6 6 9-13.5"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M16.5 8.25V6a2.25 2.25 0 00-2.25-2.25H6A2.25 2.25 0 003.75 6v8.25A2.25 2.25 0 006 16.5h2.25m8.25-8.25H18a2.25 2.25 0 012.25 2.25V18A2.25 2.25 0 0118 20.25h-7.5A2.25 2.25 0 018.25 18v-1.5m8.25-8.25h-6a2.25 2.25 0 00-2.25 2.25v6"></path></svg></span><pre class="shiki material-theme-ocean" style="background-color: #0F111A" tabindex="0"><code><span class="line"><span style="color: #464B5D; font-style: italic">// 示範用父類別</span></span>
<span class="line"><span style="color: #C792EA">public</span><span style="color: #BABED8"> </span><span style="color: #FFCB6B">class</span><span style="color: #BABED8"> </span><span style="color: #FFCB6B">SomeOtherClass</span></span>
<span class="line"><span style="color: #89DDFF">{</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #C792EA">protected</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">string</span><span style="color: #BABED8"> </span><span style="color: #FFCB6B">someString</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">=</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">Some string</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">;</span></span>
<span class="line"><span style="color: #89DDFF">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #464B5D; font-style: italic">// 使用ObservableObject Attribute</span></span>
<span class="line"><span style="color: #89DDFF">[</span><span style="color: #FFCB6B">ObservableObject</span><span style="color: #89DDFF">]</span></span>
<span class="line"><span style="color: #C792EA">public</span><span style="color: #BABED8"> </span><span style="color: #C792EA">partial</span><span style="color: #BABED8"> </span><span style="color: #FFCB6B">class</span><span style="color: #BABED8"> </span><span style="color: #FFCB6B">MainWindowViewModel05</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">:</span><span style="color: #BABED8"> </span><span style="color: #FFCB6B">SomeOtherClass</span></span>
<span class="line"><span style="color: #89DDFF">{</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #89DDFF">[</span><span style="color: #FFCB6B">ObservableProperty</span><span style="color: #89DDFF">]</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #89DDFF">[</span><span style="color: #FFCB6B">NotifyCanExecuteChangedFor</span><span style="color: #89DDFF">(nameof(</span><span style="color: #BABED8">ShowInfoCommand</span><span style="color: #89DDFF">))]</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #C792EA">private</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">string</span><span style="color: #89DDFF">?</span><span style="color: #BABED8"> </span><span style="color: #FFCB6B">_name</span><span style="color: #89DDFF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #89DDFF">[</span><span style="color: #FFCB6B">ObservableProperty</span><span style="color: #89DDFF">]</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #C792EA">private</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">string</span><span style="color: #89DDFF">?</span><span style="color: #BABED8"> </span><span style="color: #FFCB6B">_phone</span><span style="color: #89DDFF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #C792EA">private</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">bool</span><span style="color: #BABED8"> </span><span style="color: #82AAFF">CanShowInfo</span><span style="color: #89DDFF">()</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #89DDFF">{</span></span>
<span class="line"><span style="color: #BABED8">        </span><span style="color: #89DDFF; font-style: italic">return</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">!</span><span style="color: #89DDFF">string</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">IsNullOrEmpty</span><span style="color: #89DDFF">(</span><span style="color: #BABED8">_name</span><span style="color: #89DDFF">);</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #89DDFF">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #89DDFF">[</span><span style="color: #FFCB6B">RelayCommand</span><span style="color: #89DDFF">(</span><span style="color: #FFCB6B">CanExecute</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">=</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">nameof(</span><span style="color: #BABED8">CanShowInfo</span><span style="color: #89DDFF">))]</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #C792EA">private</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">void</span><span style="color: #BABED8"> </span><span style="color: #82AAFF">ShowInfo</span><span style="color: #89DDFF">()</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #89DDFF">{</span></span>
<span class="line"><span style="color: #BABED8">        </span><span style="color: #89DDFF">string</span><span style="color: #BABED8"> </span><span style="color: #FFCB6B">info</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">=</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">$&quot;</span><span style="color: #C3E88D">Name: </span><span style="color: #89DDFF">{</span><span style="color: #BABED8">Name</span><span style="color: #89DDFF">}</span><span style="color: #BABED8">\n</span><span style="color: #C3E88D">Phone: </span><span style="color: #89DDFF">{</span><span style="color: #BABED8">Phone</span><span style="color: #89DDFF">}&quot;</span><span style="color: #89DDFF">;</span></span>
<span class="line"><span style="color: #BABED8">        MessageBox</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">Show</span><span style="color: #89DDFF">(</span><span style="color: #BABED8">info</span><span style="color: #89DDFF">,</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">MessageBox</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">);</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #89DDFF">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #89DDFF">[</span><span style="color: #FFCB6B">RelayCommand</span><span style="color: #89DDFF">]</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #C792EA">private</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">void</span><span style="color: #BABED8"> </span><span style="color: #82AAFF">ShowNote</span><span style="color: #89DDFF">(</span><span style="color: #89DDFF">string</span><span style="color: #89DDFF">?</span><span style="color: #BABED8"> </span><span style="color: #FFCB6B">str</span><span style="color: #89DDFF">)</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #89DDFF">{</span></span>
<span class="line"><span style="color: #BABED8">        </span><span style="color: #89DDFF">string</span><span style="color: #BABED8"> </span><span style="color: #FFCB6B">info</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">=</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">$&quot;</span><span style="color: #C3E88D">Note: </span><span style="color: #89DDFF">{</span><span style="color: #BABED8">str</span><span style="color: #89DDFF">}&quot;</span><span style="color: #89DDFF">;</span></span>
<span class="line"><span style="color: #BABED8">        MessageBox</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">Show</span><span style="color: #89DDFF">(</span><span style="color: #BABED8">info</span><span style="color: #89DDFF">,</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">MessageBox</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">);</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #89DDFF">}</span></span>
<span class="line"><span style="color: #89DDFF">}</span></span></code></pre>
</div>
</div>



<p>至於怎麼做到的呢?</p>



<p>有興趣的話可以到自動產生的程式碼中看看，便能看到類別多繼承了 <mark style="background-color:var(--theme-palette-color-9, rgba(255, 255, 255, 0.2))" class="has-inline-color has-palette-color-8-color">INotifyPropertyChanged</mark> 和 <mark style="background-color:var(--theme-palette-color-9, rgba(255, 255, 255, 0.2))" class="has-inline-color has-palette-color-8-color">INotifyPropertyChanging</mark> 這兩個 interface 外，也能看到實作了很多ViewModel需要用的方法，基本上與 <mark style="background-color:var(--theme-palette-color-9, rgba(255, 255, 255, 0.2))" class="has-inline-color has-palette-color-8-color">ObservableObject</mark> 類別所繼承和實作的方法是一樣的。</p>



<figure class="wp-block-image size-large"><img decoding="async" src="https://i.imgur.com/5UlJrML.png" alt="使用ObservableObject Attribute所自動產生的程式碼"></figure>



<h2 class="wp-block-heading article_h2">
<span class="ez-toc-section" id="%e7%b8%bd%e7%b5%90"></span>總結<span class="ez-toc-section-end"></span>
</h2>



<p>以上便是關於 CommunityToolkit.Mvvm 套件的系列文章的Part 1，本次介紹了在 WPF 中使用該套件中的類別來實現 ViewModel ，取代了自己 <s>(網路複製來的)</s> 實現 ViewModel 所需的相關類別。</p>



<p>以及套件所提供的 Attribute 來減少 ViewModel 中的程式碼，像是</p>



<p>類別方面，</p>



<ul>
<li>[ObservableObject]</li>



<li>[INotifyPropertyChanged] (※未出現在文章範例中)</li>
</ul>



<p>Property 方面，</p>



<ul>
<li>[ObservableProperty]</li>



<li>[NotifyPropertyChangedFor] (※未出現在文章範例中)</li>



<li>[NotifyCanExecuteChangedFor]</li>
</ul>



<p>Command 方面，</p>



<ul>
<li>[RelayCommand] (※RelayCommand、RelayCommand&lt;T&gt;、AsyncRelayCommand、AsyncRelayCommand&lt;T&gt; 皆使用此 Attribute )</li>
</ul>



<p>當然還有其他的 Attribute ，這邊僅列出個人認為基礎且較常會用到的部分。</p>



<p>至於能夠實現數據驗證的 ViewModel 功能，將在Part 2中來講解與示範。</p>



<p>另外，雖然本篇文章是以 WPF 來做範例，而該套件也同樣適用在其他的 XAML 平台 <s>(應該吧，看到官網有 UWP 的範例，不過我沒用過)</s> 。</p>



<h2 class="wp-block-heading article_h2">
<span class="ez-toc-section" id="%e8%87%aa%e8%a8%80%e8%87%aa%e8%aa%9e543"></span>自言自語543<span class="ez-toc-section-end"></span>
</h2>



<p>真沒想到有這樣的套件，以前在建立新的 WPF 專案或撰寫時，很常到別的專案中複製 ViewModelBase ，或是複製 Property 中使用相關方法的程式碼，總是想著，明明是 MVVM 99% 會用到的東西，為什麼一直沒有內建實作的類別可以直接用呢?</p>



<p>然後隨著 ViewModel 龐大起來，Property 和 Command 的程式越來越大串，雖然有 Region 可以收納起來，但是展開後&#8230;嗯&#8230;還是收起來吧&#8230;</p>



<p>結果居然在 Nuget 上，已經有套件的存在了 <s>(小丑竟是我自己!?)</s></p>



<p>不僅解決了，複製來複製去的程式碼，還把很多程式碼給變不見，有夠讚，有夠讚，有夠讚 <s>(因為很重要所以說三次)</s></p>



<p>未來就只會看到，舒服乾淨的 ViewModel 程式碼。</p>



<figure class="wp-block-image size-large"><img decoding="async" src="https://i.imgur.com/2ks8bcm.png" alt=""></figure>
		</div>

		
					<div class="entry-tags ">
<span class="ct-module-title">標籤</span><div class="entry-tags-items">
<a href="https://cornerchat543.github.io/tag/net/" rel="tag"><span>#</span> .NET</a><a href="https://cornerchat543.github.io/tag/c/" rel="tag"><span>#</span> C#</a><a href="https://cornerchat543.github.io/tag/mvvm/" rel="tag"><span>#</span> MVVM</a><a href="https://cornerchat543.github.io/tag/nuget/" rel="tag"><span>#</span> Nuget</a><a href="https://cornerchat543.github.io/tag/toolkit-mvvm/" rel="tag"><span>#</span> ToolKit.MVVM</a><a href="https://cornerchat543.github.io/tag/wpf/" rel="tag"><span>#</span> WPF</a>
</div>
</div>		
		
		
		<nav class="post-navigation ">
							<a href="https://cornerchat543.github.io/2024/04/wordpress-on-github-pages/" class="nav-item-prev">
					<figure class="ct-media-container  "><img post-id="63" fifu-featured="1" width="300" height="300" src="https://i1.wp.com/res.cloudinary.com/glide/image/fetch/https%3A%2F%2Fi.imgur.com%2FdWtDbbf.jpg?w=300&amp;resize=300,300&amp;ssl=1" class="attachment-medium size-medium wp-post-image" alt="" loading="lazy" decoding="async" itemprop="image" style="aspect-ratio: 1/1;"><svg width="20px" height="15px" viewbox="0 0 20 15" fill="#ffffff"><polygon points="0,7.5 5.5,13 6.4,12.1 2.4,8.1 20,8.1 20,6.9 2.4,6.9 6.4,2.9 5.5,2 "></polygon></svg></figure>
					<div class="item-content">
						<span class="item-label">
							上一 <span>文章</span>						</span>

													<span class="item-title ct-hidden-sm">
								使用WordPress建立GitHub Pages							</span>
											</div>

				</a>
			
							<a href="https://cornerchat543.github.io/2024/05/toolkit-mvvm-part02/" class="nav-item-next">
					<div class="item-content">
						<span class="item-label">
							下一 <span>文章</span>						</span>

													<span class="item-title ct-hidden-sm">
								使用ToolKit.MVVM實現ViewModel - Part 2							</span>
											</div>

					<figure class="ct-media-container  "><img post-id="187" fifu-featured="1" width="300" height="300" src="https://i3.wp.com/res.cloudinary.com/glide/image/fetch/https%3A%2F%2Fi.imgur.com%2F6eIEfY5.png?w=300&amp;resize=300,300&amp;ssl=1" class="attachment-medium size-medium wp-post-image" alt="" loading="lazy" decoding="async" itemprop="image" style="aspect-ratio: 1/1;"><svg width="20px" height="15px" viewbox="0 0 20 15" fill="#ffffff"><polygon points="14.5,2 13.6,2.9 17.6,6.9 0,6.9 0,8.1 17.6,8.1 13.6,12.1 14.5,13 20,7.5 "></polygon></svg></figure>				</a>
			
		</nav>

	
	</article>

	
		<aside class="ct-hidden-sm ct-hidden-md" data-type="type-2" id="sidebar" itemtype="https://schema.org/WPSideBar" itemscope="itemscope"><div class="ct-sidebar">
<div class="ct-widget widget_block" id="block-3">
<div class="wp-block-group is-layout-flow wp-block-group-is-layout-flow">
<h6 class="wp-block-heading">近期文章</h6>



<hr class="wp-block-separator has-alpha-channel-opacity is-style-wide">


<ul class="wp-block-latest-posts__list wp-block-latest-posts">
<li><a class="wp-block-latest-posts__post-title" href="https://cornerchat543.github.io/2024/05/toolkit-mvvm-part02/">使用ToolKit.MVVM實現ViewModel &#8211; Part 2</a></li>
<li><a class="wp-block-latest-posts__post-title" href="https://cornerchat543.github.io/2024/05/toolkit-mvvm-part01/">使用ToolKit.MVVM實現ViewModel &#8211; Part 1</a></li>
<li><a class="wp-block-latest-posts__post-title" href="https://cornerchat543.github.io/2024/04/wordpress-on-github-pages/">使用WordPress建立GitHub Pages</a></li>
</ul>
</div>
</div>
<div class="ct-widget widget_block" id="block-6">
<div class="wp-block-group is-layout-flow wp-block-group-is-layout-flow">
<h6 class="wp-block-heading">分類</h6>



<hr class="wp-block-separator has-alpha-channel-opacity is-style-wide">


<ul class="wp-block-categories-list wp-block-categories">	<li class="cat-item cat-item-3">
<a href="https://cornerchat543.github.io/category/c_sharp/">C#</a>
</li>
	<li class="cat-item cat-item-4">
<a href="https://cornerchat543.github.io/category/github-pages/">Github Pages</a>
</li>
</ul>
</div>
</div>
<div class="ct-widget widget_block" id="block-8">
<div class="wp-block-group is-layout-flow wp-block-group-is-layout-flow">
<h6 class="wp-block-heading">標籤</h6>



<hr class="wp-block-separator has-alpha-channel-opacity is-style-wide">


<p class="wp-block-tag-cloud"><a href="https://cornerchat543.github.io/tag/net/" class="tag-cloud-link tag-link-5 tag-link-position-1" style="font-size: 22pt;" aria-label=".NET (2 個項目)">.NET</a>
<a href="https://cornerchat543.github.io/tag/c/" class="tag-cloud-link tag-link-6 tag-link-position-2" style="font-size: 22pt;" aria-label="C# (2 個項目)">C#</a>
<a href="https://cornerchat543.github.io/tag/github-io/" class="tag-cloud-link tag-link-8 tag-link-position-3" style="font-size: 8pt;" aria-label="github.io (1 個項目)">github.io</a>
<a href="https://cornerchat543.github.io/tag/github-pages/" class="tag-cloud-link tag-link-7 tag-link-position-4" style="font-size: 8pt;" aria-label="github pages (1 個項目)">github pages</a>
<a href="https://cornerchat543.github.io/tag/mvvm/" class="tag-cloud-link tag-link-9 tag-link-position-5" style="font-size: 22pt;" aria-label="MVVM (2 個項目)">MVVM</a>
<a href="https://cornerchat543.github.io/tag/nuget/" class="tag-cloud-link tag-link-10 tag-link-position-6" style="font-size: 22pt;" aria-label="Nuget (2 個項目)">Nuget</a>
<a href="https://cornerchat543.github.io/tag/toolkit-mvvm/" class="tag-cloud-link tag-link-11 tag-link-position-7" style="font-size: 22pt;" aria-label="ToolKit.MVVM (2 個項目)">ToolKit.MVVM</a>
<a href="https://cornerchat543.github.io/tag/wordpress/" class="tag-cloud-link tag-link-12 tag-link-position-8" style="font-size: 8pt;" aria-label="WordPress (1 個項目)">WordPress</a>
<a href="https://cornerchat543.github.io/tag/wpf/" class="tag-cloud-link tag-link-13 tag-link-position-9" style="font-size: 22pt;" aria-label="WPF (2 個項目)">WPF</a>
<a href="https://cornerchat543.github.io/tag/xampp/" class="tag-cloud-link tag-link-14 tag-link-position-10" style="font-size: 8pt;" aria-label="XAMPP (1 個項目)">XAMPP</a></p>
</div>
</div>
</div></aside>
			</div>

	</main>

	<footer id="footer" class="ct-footer" data-id="type-1" itemscope="" itemtype="https://schema.org/WPFooter"><div data-row="bottom"><div class="ct-container" data-columns-divider="md:sm"><div data-column="copyright">
<div class="ct-footer-copyright" data-id="copyright">

	<p>版權 © 2024 CornerChat543 - WordPress 佈景主題由 <a href="https://creativethemes.com/">CreativeThemes</a> 開發</p>
</div>
</div></div></div></footer>
</div>

<style id="core-block-supports-inline-css">.wp-container-core-group-is-layout-1.wp-container-core-group-is-layout-1{gap:0;flex-direction:column;align-items:stretch;}.wp-container-core-group-is-layout-2.wp-container-core-group-is-layout-2{gap:0;flex-direction:column;align-items:flex-start;}.wp-container-core-group-is-layout-3.wp-container-core-group-is-layout-3{gap:0;flex-direction:column;align-items:stretch;}.wp-container-core-group-is-layout-4.wp-container-core-group-is-layout-4{gap:0;flex-direction:column;align-items:stretch;}.wp-container-core-group-is-layout-5.wp-container-core-group-is-layout-5{gap:0;flex-direction:column;align-items:stretch;}.wp-container-core-group-is-layout-6.wp-container-core-group-is-layout-6{gap:0;flex-direction:column;align-items:stretch;}.wp-container-core-group-is-layout-7.wp-container-core-group-is-layout-7{gap:0;flex-direction:column;align-items:stretch;}.wp-container-core-group-is-layout-8.wp-container-core-group-is-layout-8{gap:0;flex-direction:column;align-items:stretch;}.wp-container-core-group-is-layout-9.wp-container-core-group-is-layout-9{gap:0;flex-direction:column;align-items:stretch;}.wp-container-core-group-is-layout-10.wp-container-core-group-is-layout-10{gap:0;flex-direction:column;align-items:stretch;}.wp-container-core-group-is-layout-11.wp-container-core-group-is-layout-11{gap:0;flex-direction:column;align-items:stretch;}.wp-container-core-group-is-layout-12.wp-container-core-group-is-layout-12{gap:0;flex-direction:column;align-items:flex-start;}.wp-container-core-group-is-layout-13.wp-container-core-group-is-layout-13{gap:0;flex-direction:column;align-items:flex-start;}.wp-container-core-group-is-layout-14.wp-container-core-group-is-layout-14{gap:0;flex-direction:column;align-items:flex-start;}.wp-container-core-group-is-layout-15.wp-container-core-group-is-layout-15{gap:0;flex-direction:column;align-items:stretch;}.wp-container-core-group-is-layout-16.wp-container-core-group-is-layout-16{gap:0;flex-direction:column;align-items:stretch;}.wp-container-core-group-is-layout-17.wp-container-core-group-is-layout-17{gap:0;flex-direction:column;align-items:stretch;}.wp-container-core-group-is-layout-18.wp-container-core-group-is-layout-18{gap:0;flex-direction:column;align-items:stretch;}.wp-container-core-group-is-layout-19.wp-container-core-group-is-layout-19{gap:0;flex-direction:column;align-items:stretch;}.wp-container-core-group-is-layout-20.wp-container-core-group-is-layout-20{gap:0;flex-direction:column;align-items:stretch;}.wp-container-core-group-is-layout-21.wp-container-core-group-is-layout-21{gap:0;flex-direction:column;align-items:flex-start;}.wp-container-core-group-is-layout-22.wp-container-core-group-is-layout-22{gap:0;flex-direction:column;align-items:stretch;}.wp-container-core-group-is-layout-23.wp-container-core-group-is-layout-23{gap:0;flex-direction:column;align-items:stretch;}.wp-container-core-group-is-layout-24.wp-container-core-group-is-layout-24{gap:0;flex-direction:column;align-items:stretch;}.wp-container-core-group-is-layout-25.wp-container-core-group-is-layout-25{gap:0;flex-direction:column;align-items:stretch;}.wp-container-core-group-is-layout-26.wp-container-core-group-is-layout-26{gap:0;flex-direction:column;align-items:stretch;}.wp-container-core-group-is-layout-27.wp-container-core-group-is-layout-27{gap:0;flex-direction:column;align-items:stretch;}.wp-container-core-group-is-layout-28.wp-container-core-group-is-layout-28{gap:0;flex-direction:column;align-items:stretch;}.wp-container-core-group-is-layout-29.wp-container-core-group-is-layout-29{gap:0;flex-direction:column;align-items:stretch;}.wp-container-core-group-is-layout-30.wp-container-core-group-is-layout-30{gap:0;flex-direction:column;align-items:stretch;}.wp-container-core-group-is-layout-31.wp-container-core-group-is-layout-31{gap:0;flex-direction:column;align-items:flex-start;}.wp-container-core-group-is-layout-32.wp-container-core-group-is-layout-32{gap:0;flex-direction:column;align-items:flex-start;}.wp-container-core-group-is-layout-33.wp-container-core-group-is-layout-33{gap:0;flex-direction:column;align-items:flex-start;}.wp-container-core-group-is-layout-34.wp-container-core-group-is-layout-34{gap:0;flex-direction:column;align-items:stretch;}.wp-container-core-group-is-layout-35.wp-container-core-group-is-layout-35{gap:0;flex-direction:column;align-items:stretch;}.wp-container-core-group-is-layout-36.wp-container-core-group-is-layout-36{gap:0;flex-direction:column;align-items:stretch;}.wp-container-core-group-is-layout-37.wp-container-core-group-is-layout-37{gap:0;flex-direction:column;align-items:stretch;}.wp-container-core-group-is-layout-38.wp-container-core-group-is-layout-38{gap:0;flex-direction:column;align-items:stretch;}</style>
<style id="core-block-supports-duotone-inline-css">.wp-duotone-unset-1.wp-block-image img, .wp-duotone-unset-1.wp-block-image .components-placeholder{filter:unset;}.wp-duotone-unset-2.wp-block-image img, .wp-duotone-unset-2.wp-block-image .components-placeholder{filter:unset;}.wp-duotone-unset-3.wp-block-image img, .wp-duotone-unset-3.wp-block-image .components-placeholder{filter:unset;}.wp-duotone-unset-4.wp-block-image img, .wp-duotone-unset-4.wp-block-image .components-placeholder{filter:unset;}.wp-duotone-unset-5.wp-block-image img, .wp-duotone-unset-5.wp-block-image .components-placeholder{filter:unset;}.wp-duotone-unset-6.wp-block-image img, .wp-duotone-unset-6.wp-block-image .components-placeholder{filter:unset;}.wp-duotone-unset-7.wp-block-image img, .wp-duotone-unset-7.wp-block-image .components-placeholder{filter:unset;}.wp-duotone-unset-8.wp-block-image img, .wp-duotone-unset-8.wp-block-image .components-placeholder{filter:unset;}.wp-duotone-unset-9.wp-block-image img, .wp-duotone-unset-9.wp-block-image .components-placeholder{filter:unset;}.wp-duotone-unset-10.wp-block-image img, .wp-duotone-unset-10.wp-block-image .components-placeholder{filter:unset;}.wp-duotone-unset-11.wp-block-image img, .wp-duotone-unset-11.wp-block-image .components-placeholder{filter:unset;}.wp-duotone-unset-12.wp-block-image img, .wp-duotone-unset-12.wp-block-image .components-placeholder{filter:unset;}.wp-duotone-unset-13.wp-block-image img, .wp-duotone-unset-13.wp-block-image .components-placeholder{filter:unset;}.wp-duotone-unset-14.wp-block-image img, .wp-duotone-unset-14.wp-block-image .components-placeholder{filter:unset;}</style>
<script id="ez-toc-scroll-scriptjs-js-extra">var eztoc_smooth_local = {"scroll_offset":"30","add_request_uri":""};</script>
<script src="https://cornerchat543.github.io/wp-content/plugins/easy-table-of-contents/assets/js/smooth_scroll.min.js?ver=2.0.66.1" id="ez-toc-scroll-scriptjs-js"></script>
<script src="https://cornerchat543.github.io/wp-content/plugins/easy-table-of-contents/vendor/js-cookie/js.cookie.min.js?ver=2.2.1" id="ez-toc-js-cookie-js"></script>
<script src="https://cornerchat543.github.io/wp-content/plugins/easy-table-of-contents/vendor/sticky-kit/jquery.sticky-kit.min.js?ver=1.9.2" id="ez-toc-jquery-sticky-kit-js"></script>
<script id="ez-toc-js-js-extra">
var ezTOC = {"smooth_scroll":"1","visibility_hide_by_default":"","scroll_offset":"30","fallbackIcon":"<span class=\"\"><span class=\"eztoc-hide\" style=\"display:none;\">Toggle<\/span><span class=\"ez-toc-icon-toggle-span\"><svg style=\"fill: #ffffff;color:#ffffff\" xmlns=\"http:\/\/www.w3.org\/2000\/svg\" class=\"list-377408\" width=\"20px\" height=\"20px\" viewBox=\"0 0 24 24\" fill=\"none\"><path d=\"M6 6H4v2h2V6zm14 0H8v2h12V6zM4 11h2v2H4v-2zm16 0H8v2h12v-2zM4 16h2v2H4v-2zm16 0H8v2h12v-2z\" fill=\"currentColor\"><\/path><\/svg><svg style=\"fill: #ffffff;color:#ffffff\" class=\"arrow-unsorted-368013\" xmlns=\"http:\/\/www.w3.org\/2000\/svg\" width=\"10px\" height=\"10px\" viewBox=\"0 0 24 24\" version=\"1.2\" baseProfile=\"tiny\"><path d=\"M18.2 9.3l-6.2-6.3-6.2 6.3c-.2.2-.3.4-.3.7s.1.5.3.7c.2.2.4.3.7.3h11c.3 0 .5-.1.7-.3.2-.2.3-.5.3-.7s-.1-.5-.3-.7zM5.8 14.7l6.2 6.3 6.2-6.3c.2-.2.3-.5.3-.7s-.1-.5-.3-.7c-.2-.2-.4-.3-.7-.3h-11c-.3 0-.5.1-.7.3-.2.2-.3.5-.3.7s.1.5.3.7z\"\/><\/svg><\/span><\/span>"};
</script>
<script src="https://cornerchat543.github.io/wp-content/plugins/easy-table-of-contents/assets/js/front.min.js?ver=2.0.66.1-1716219362" id="ez-toc-js-js"></script>
<script id="ct-scripts-js-extra">var ct_localizations = {"ajax_url":"https:\/\/cornerchat543.github.io\/wp-admin\/admin-ajax.php","public_url":"https:\/\/cornerchat543.github.io\/wp-content\/themes\/blocksy\/static\/bundle\/","rest_url":"https:\/\/cornerchat543.github.io\/wp-json\/","search_url":"https:\/\/cornerchat543.github.io\/search\/QUERY_STRING\/","show_more_text":"顯示更多","more_text":"更多","search_live_results":"搜尋結果","search_live_no_result":"找不到符合的","search_live_one_result":"您己找到 %s 個符合的. 請按 Tab 鍵來選擇它.","search_live_many_results":"您己找到 %s 個符合的. 請按 Tab 鍵來選擇它.","expand_submenu":"展開下拉選單","collapse_submenu":"收合下拉選單","dynamic_js_chunks":[{"id":"blocksy_sticky_header","selector":"header [data-sticky]","url":"https:\/\/cornerchat543.github.io\/wp-content\/plugins\/blocksy-companion\/static\/bundle\/sticky.js?ver=2.0.48"}],"dynamic_styles":{"lazy_load":"https:\/\/cornerchat543.github.io\/wp-content\/themes\/blocksy\/static\/bundle\/non-critical-styles.min.css?ver=2.0.48","search_lazy":"https:\/\/cornerchat543.github.io\/wp-content\/themes\/blocksy\/static\/bundle\/non-critical-search-styles.min.css?ver=2.0.48","back_to_top":"https:\/\/cornerchat543.github.io\/wp-content\/themes\/blocksy\/static\/bundle\/back-to-top.min.css?ver=2.0.48"},"dynamic_styles_selectors":[{"selector":".ct-header-cart, #woo-cart-panel","url":"https:\/\/cornerchat543.github.io\/wp-content\/themes\/blocksy\/static\/bundle\/cart-header-element-lazy.min.css?ver=2.0.48"},{"selector":".flexy","url":"https:\/\/cornerchat543.github.io\/wp-content\/themes\/blocksy\/static\/bundle\/flexy.min.css?ver=2.0.48"},{"selector":"#account-modal","url":"https:\/\/cornerchat543.github.io\/wp-content\/plugins\/blocksy-companion\/static\/bundle\/header-account-modal-lazy.min.css?ver=2.0.48"},{"selector":".ct-header-account","url":"https:\/\/cornerchat543.github.io\/wp-content\/plugins\/blocksy-companion\/static\/bundle\/header-account-dropdown-lazy.min.css?ver=2.0.48"}]};</script>
<script src="https://cornerchat543.github.io/wp-content/themes/blocksy/static/bundle/main.js?ver=2.0.48" id="ct-scripts-js"></script>
<script id="fifu-json-ld-js-extra">var fifuJsonLd = {"url":"https:\/\/i2.wp.com\/res.cloudinary.com\/glide\/image\/fetch\/https%3A%2F%2Fi.imgur.com%2FdNjQeay.png?ssl=1"};</script>
<script src="https://cornerchat543.github.io/wp-content/plugins/featured-image-from-url/includes/html/js/json-ld.js?ver=4.7.7" id="fifu-json-ld-js"></script>
<script src="https://cornerchat543.github.io/wp-content/plugins/code-block-pro/build/front/front.js?ver=9e61187462c44495f394" id="kevinbatdorf-code-block-pro-view-script-js" data-wp-strategy="defer"></script>
<script id="kevinbatdorf-code-block-pro-view-script-js-after">window.codeBlockPro = {"pluginUrl":"https:\/\/cornerchat543.github.io\/wp-content\/plugins\/code-block-pro\/"};</script>

</body>
</html>